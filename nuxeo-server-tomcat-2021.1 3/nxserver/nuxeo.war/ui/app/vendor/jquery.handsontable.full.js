/*! For license information please see jquery.handsontable.full.js.LICENSE.txt */
window.Handsontable=Handsontable={plugins:{},helper:{}},function(e,t,o){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,o=Number(arguments[1])||0;for((o=o<0?Math.ceil(o):Math.floor(o))<0&&(o+=t);o<t;o++)if(o in this&&this[o]===e)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e,t){if(null==this)throw new TypeError;if("function"!=typeof e)throw new TypeError;/NodeList/i.test((t=t||this).item)&&(t=function(e){for(var t=[],o=0,n=e.length;o<n;o++)t[o]=e[o];return t}(t));var o,n,i=t.length,r=[];for(o=0;o<i;o+=1)t.hasOwnProperty(o)&&(n=t[o],e.call(t,n,o,t)&&r.push(n));return r}),"undefined"==typeof WeakMap&&function(){var e=Object.defineProperty;try{var o=!0;e((function(){}),"foo",{})}catch(e){o=!1}var n=+new Date%1e9,i=function(){this.name="__st"+(1e9*Math.random()>>>0)+n+++"__",o||(this._wmCache=[])};i.prototype=o?{set:function(t,o){var n=t[this.name];n&&n[0]===t?n[1]=o:e(t,this.name,{value:[t,o],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},delete:function(e){this.set(e,void 0)}}:{set:function(e,t){if(void 0!==e&&void 0!==t){for(var o=0,n=this._wmCache.length;o<n;o++)if(this._wmCache[o].key==e)return void(this._wmCache[o].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if(void 0!==e)for(var t=0,o=this._wmCache.length;t<o;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value},delete:function(e){if(void 0!==e)for(var t=0,o=this._wmCache.length;t<o;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},t.WeakMap=i}(),o.activeGuid=null,o.Core=function(n,i){var r,s,a,c,h,u=this,d=function(){},f=e(document.documentElement),p=e(document.body);function g(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function m(t,n,i){var r=new g;r.onQueueEmpty=function(){var r;t.length&&("function"==typeof(r=o.hooks.execute(u,"beforeChange",t,n))?e.when(result).then((function(){i()})):!1===r&&t.splice(0,t.length)),"function"!=typeof r&&i()};for(var l=t.length-1;l>=0;l--)if(null===t[l])t.splice(l,1);else{var a=t[l][0],c=s.propToCol(t[l][1]),h=u.runHooksAndReturn("modifyCol",c),d=u.getCellMeta(a,h);if("numeric"===d.type&&"string"==typeof t[l][3]&&t[l][3].length>0&&/^-?[\d\s]*(\.|\,)?\d*$/.test(t[l][3])){var f=t[l][3].length;void 0===d.language||t[l][3].indexOf(".")===f-3&&-1===t[l][3].indexOf(",")?numeral.language("en"):numeral.language(d.language),t[l][3]=numeral().unformat(t[l][3]||"0")}u.getCellValidator(d)&&(r.addValidatorToQueue(),u.validateCell(t[l][3],d,function(e,o){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");!1===n&&!1===o.allowInvalid&&(t.splice(e,1),o.valid=!0,--e),r.removeValidatorFormQueue()}}(l,d),n))}r.checkIfQueueIsEmpty()}function w(e,t){var n=e.length-1;if(!(n<0)){for(;0<=n;n--)if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(r.settings.minSpareRows)for(;e[n][0]>u.countRows()-1;)s.createRow();if("array"===u.dataType&&r.settings.minSpareCols)for(;s.propToCol(e[n][1])>u.countCols()-1;)s.createCol();s.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1);u.forceFullRender=!0,a.adjustRowsAndCols(),o.hooks.run(u,"beforeChangeRender",e,t),c.refreshBorders(null,!0),o.hooks.run(u,"afterChange",e,t||"edit")}}function v(t,o,n){return"object"==typeof t?t:e.isPlainObject(n)?n:[[t,o,n]]}function y(e){if(e.hasOwnProperty("type")){var t,n={};if("object"==typeof e.type)t=e.type;else if("string"==typeof e.type&&void 0===(t=o.cellTypes[e.type]))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(n[i]=t[i]);return n}}o.helper.extend(d.prototype,l.prototype),o.helper.extend(d.prototype,i),o.helper.extend(d.prototype,y(i)),this.rootElement=n,this.container=document.createElement("DIV"),this.container.className="htContainer",n.prepend(this.container),this.container=e(this.container),this.guid="ht_"+o.helper.randomString(),this.rootElement[0].id&&"ht_"!==this.rootElement[0].id.substring(0,3)||(this.rootElement[0].id=this.guid),r={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new d,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},a={alter:function(e,t,n,i,l){var h;switch(n=n||1,e){case"insert_row":(h=s.createRow(t,n))&&(c.isSelected()&&r.selRange.from.row>=t?(r.selRange.from.row=r.selRange.from.row+h,c.transformEnd(h,0)):c.refreshBorders());break;case"insert_col":if(h=s.createCol(t,n)){if(o.helper.isArray(u.getSettings().colHeaders)){var d=[t,0];d.length+=h,Array.prototype.splice.apply(u.getSettings().colHeaders,d)}c.isSelected()&&r.selRange.from.col>=t?(r.selRange.from.col=r.selRange.from.col+h,c.transformEnd(0,h)):c.refreshBorders()}break;case"remove_row":s.removeRow(t,n),r.cellSettings.splice(t,n),a.adjustRowsAndCols(),c.refreshBorders();break;case"remove_col":s.removeCol(t,n);for(var f=0,p=s.getAll().length;f<p;f++)f in r.cellSettings&&r.cellSettings[f].splice(t,n);o.helper.isArray(u.getSettings().colHeaders)&&(void 0===t&&(t=-1),u.getSettings().colHeaders.splice(t,n)),r.columnSettings.splice(t,n),a.adjustRowsAndCols(),c.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}l||a.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t,o,n;if((t=u.countRows())<r.settings.minRows)for(e=0;e<r.settings.minRows-t;e++)s.createRow(u.countRows(),1,!0);if((o=u.countEmptyRows(!0))<r.settings.minSpareRows)for(;o<r.settings.minSpareRows&&u.countRows()<r.settings.maxRows;o++)s.createRow(u.countRows(),1,!0);if(n=u.countEmptyCols(!0),!r.settings.columns&&u.countCols()<r.settings.minCols)for(;u.countCols()<r.settings.minCols;n++)s.createCol(u.countCols(),1,!0);if(!r.settings.columns&&"array"===u.dataType&&n<r.settings.minSpareCols)for(;n<r.settings.minSpareCols&&u.countCols()<r.settings.maxCols;n++)s.createCol(u.countCols(),1,!0);var i=u.countRows(),l=u.countCols();if(0!==i&&0!==l||c.deselect(),c.isSelected()){var a,h=r.selRange.from.row,d=r.selRange.from.col,f=r.selRange.to.row,p=r.selRange.to.col;h>i-1?(a=!0,f>(h=i-1)&&(f=h)):f>i-1&&(a=!0,h>(f=i-1)&&(h=f)),d>l-1?(a=!0,p>(d=l-1)&&(p=d)):p>l-1&&(a=!0,d>(p=l-1)&&(d=p)),a&&u.selectCell(h,d,f,p)}},populateFromArray:function(e,t,n,i,s){var l,a,c,h,d,f,p,g,m=[],w={};if(0===(a=t.length))return!1;switch(s){case"shift_down":for(d=n?n.col-e.col+1:0,f=n?n.row-e.row+1:0,c=0,h=(t=o.helper.translateRowsToColumns(t)).length,p=Math.max(h,d);c<p;c++)if(c<h){for(l=0,a=t[c].length;l<f-a;l++)t[c].push(t[c][l%a]);t[c].unshift(e.col+c,e.row,0),u.spliceCol.apply(u,t[c])}else t[c%h][0]=e.col+c,u.spliceCol.apply(u,t[c%h]);break;case"shift_right":for(d=n?n.col-e.col+1:0,f=n?n.row-e.row+1:0,l=0,a=t.length,g=Math.max(a,f);l<g;l++)if(l<a){for(c=0,h=t[l].length;c<d-h;c++)t[l].push(t[l][c%h]);t[l].unshift(e.row+l,e.col,0),u.spliceRow.apply(u,t[l])}else t[l%a][0]=e.row+l,u.spliceRow.apply(u,t[l%a]);break;default:for(w.row=e.row,w.col=e.col,l=0;l<a&&!(n&&w.row>n.row||!r.settings.minSpareRows&&w.row>u.countRows()-1||w.row>=r.settings.maxRows);l++){for(w.col=e.col,h=t[l]?t[l].length:0,c=0;c<h&&!(n&&w.col>n.col||!r.settings.minSpareCols&&w.col>u.countCols()-1||w.col>=r.settings.maxCols);c++)u.getCellMeta(w.row,w.col).readOnly||m.push([w.row,w.col,t[l][c]]),w.col++,n&&c===h-1&&(c=-1);w.row++,n&&l===a-1&&(l=-1)}u.setDataAtCell(m,null,null,i||"populateFromArray")}}},this.selection=c={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(e,t){u.selection.selectedHeader.rows=e,u.selection.selectedHeader.cols=t},begin:function(){u.selection.inProgress=!0},finish:function(){var e=u.getSelected();o.hooks.run(u,"afterSelectionEnd",e[0],e[1],e[2],e[3]),o.hooks.run(u,"afterSelectionEndByProp",e[0],u.colToProp(e[1]),e[2],u.colToProp(e[3])),u.selection.inProgress=!1},isInProgress:function(){return u.selection.inProgress},setRangeStart:function(e){o.hooks.run(u,"beforeSetRangeStart",e),r.selRange=new N(e,e,e),c.setRangeEnd(e)},setRangeEnd:function(e,t){o.hooks.run(u,"beforeSetRangeEnd",e),u.selection.begin(),r.selRange.to=new M(e.row,e.col),r.settings.multiSelect||(r.selRange.from=e),u.view.wt.selections.current.clear(),u.view.wt.selections.current.add(r.selRange.highlight),u.view.wt.selections.area.clear(),c.isMultiple()&&(u.view.wt.selections.area.add(r.selRange.from),u.view.wt.selections.area.add(r.selRange.to)),(r.settings.currentRowClassName||r.settings.currentColClassName)&&(u.view.wt.selections.highlight.clear(),u.view.wt.selections.highlight.add(r.selRange.from),u.view.wt.selections.highlight.add(r.selRange.to)),o.hooks.run(u,"afterSelection",r.selRange.from.row,r.selRange.from.col,r.selRange.to.row,r.selRange.to.col),o.hooks.run(u,"afterSelectionByProp",r.selRange.from.row,s.colToProp(r.selRange.from.col),r.selRange.to.row,s.colToProp(r.selRange.to.col)),!1!==t&&u.view.mainViewIsActive()&&u.view.scrollViewport(e),c.refreshBorders()},refreshBorders:function(e,t){t||h.destroyEditor(e),u.view.render(),c.isSelected()&&!t&&h.prepareEditor()},isMultiple:function(){var e=!(r.selRange.to.col===r.selRange.from.col&&r.selRange.to.row===r.selRange.from.row),t=o.hooks.execute(u,"afterIsMultipleSelection",e);if(e)return t},transformStart:function(e,t,o){var n=new M(e,t);u.runHooks("modifyTransformStart",n),r.selRange.highlight.row+e>u.countRows()-1?o&&r.settings.minSpareRows>0?u.alter("insert_row",u.countRows()):r.settings.autoWrapCol&&(n.row=1-u.countRows(),n.col=r.selRange.highlight.col+n.col==u.countCols()-1?1-u.countCols():1):r.settings.autoWrapCol&&r.selRange.highlight.row+n.row<0&&r.selRange.highlight.col+n.col>=0&&(n.row=u.countRows()-1,n.col=r.selRange.highlight.col+n.col==0?u.countCols()-1:-1),r.selRange.highlight.col+n.col>u.countCols()-1?o&&r.settings.minSpareCols>0?u.alter("insert_col",u.countCols()):r.settings.autoWrapRow&&(n.row=r.selRange.highlight.row+n.row==u.countRows()-1?1-u.countRows():1,n.col=1-u.countCols()):r.settings.autoWrapRow&&r.selRange.highlight.col+n.col<0&&r.selRange.highlight.row+n.row>=0&&(n.row=r.selRange.highlight.row+n.row==0?u.countRows()-1:-1,n.col=u.countCols()-1);var i=u.countRows(),s=u.countCols(),l=new M(r.selRange.highlight.row+n.row,r.selRange.highlight.col+n.col);l.row<0?l.row=0:l.row>0&&l.row>=i&&(l.row=i-1),l.col<0?l.col=0:l.col>0&&l.col>=s&&(l.col=s-1),c.setRangeStart(l)},transformEnd:function(e,t){var o=new M(e,t);u.runHooks("modifyTransformEnd",o);var n=u.countRows(),i=u.countCols(),s=new M(r.selRange.to.row+o.row,r.selRange.to.col+o.col);s.row<0?s.row=0:s.row>0&&s.row>=n&&(s.row=n-1),s.col<0?s.col=0:s.col>0&&s.col>=i&&(s.col=i-1),c.setRangeEnd(s)},isSelected:function(){return null!==r.selRange},inInSelection:function(e){return!!c.isSelected()&&r.selRange.includes(e)},deselect:function(){c.isSelected()&&(u.selection.inProgress=!1,r.selRange=null,u.view.wt.selections.current.clear(),u.view.wt.selections.area.clear(),(r.settings.currentRowClassName||r.settings.currentColClassName)&&u.view.wt.selections.highlight.clear(),h.destroyEditor(),c.refreshBorders(),o.hooks.run(u,"afterDeselect"))},selectAll:function(){r.settings.multiSelect&&(c.setRangeStart(new M(0,0)),c.setRangeEnd(new M(u.countRows()-1,u.countCols()-1),!1))},empty:function(){if(c.isSelected()){var e,t,o=r.selRange.getTopLeftCorner(),n=r.selRange.getBottomRightCorner(),i=[];for(e=o.row;e<=n.row;e++)for(t=o.col;t<=n.col;t++)u.getCellMeta(e,t).readOnly||i.push([e,t,""]);u.setDataAtCell(i)}}},this.init=function(){o.hooks.run(u,"beforeInit"),this.updateSettings(r.settings,!0),this.view=new o.TableView(this),h=new o.EditorManager(u,r,c,s),this.forceFullRender=!0,this.view.render(),"object"==typeof r.firstRun&&(o.hooks.run(u,"afterChange",r.firstRun[0],r.firstRun[1]),r.firstRun=!1),o.hooks.run(u,"afterInit")},this.validateCell=function(e,t,n,i){var r=u.getCellValidator(t);"[object RegExp]"===Object.prototype.toString.call(r)&&(r=function(e){return function(t,o){o(e.test(t))}}(r)),"function"==typeof r?(e=o.hooks.execute(u,"beforeValidate",e,t.row,t.prop,i),u._registerTimeout(setTimeout((function(){return r.call(t,e,(function(r){t.valid=r,r=o.hooks.execute(u,"afterValidate",r,e,t.row,t.prop,i),n(r)})),e}),0))):(t.valid=!0,n(!0))},this.setDataAtCell=function(e,t,o,n){var i,r,l,a=v(e,t,o),c=[];for(i=0,r=a.length;i<r;i++){if("object"!=typeof a[i])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof a[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");l=s.colToProp(a[i][1]),c.push([a[i][0],l,s.get(a[i][0],l),a[i][2]])}n||"object"!=typeof e||(n=t),m(c,n,(function(){w(c,n)}))},this.setDataAtRowProp=function(e,t,o,n){var i,r,l=v(e,t,o),a=[];for(i=0,r=l.length;i<r;i++)a.push([l[i][0],l[i][1],s.get(l[i][0],l[i][1]),l[i][2]]);n||"object"!=typeof e||(n=t),m(a,n,(function(){w(a,n)}))},this.listen=function(){o.activeGuid=u.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){o.activeGuid=null},this.isListening=function(){return o.activeGuid===u.guid},this.destroyEditor=function(e){c.refreshBorders(e)},this.populateFromArray=function(e,t,o,n,i,r,s){if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return a.populateFromArray(new M(e,t),o,"number"==typeof n?new M(n,i):null,r,s)},this.spliceCol=function(e,t,o){return s.spliceCol.apply(s,arguments)},this.spliceRow=function(e,t,o){return s.spliceRow.apply(s,arguments)},this.getSelected=function(){if(c.isSelected())return[r.selRange.from.row,r.selRange.from.col,r.selRange.to.row,r.selRange.to.col]},this.getSelectedRange=function(){if(c.isSelected())return r.selRange},this.render=function(){u.view&&(u.forceFullRender=!0,c.refreshBorders(null,!0))},this.loadData=function(e){if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");var t;e=[];for(var n=0,i=r.settings.startRows;n<i;n++){t=[];for(var l=0,c=r.settings.startCols;l<c;l++)t.push(null);e.push(t)}}r.isPopulated=!1,d.prototype.data=e,r.settings.dataSchema instanceof Array||e[0]instanceof Array?u.dataType="array":"function"==typeof r.settings.dataSchema?u.dataType="function":u.dataType="object",s=new o.DataMap(u,r,d),r.cellSettings.length=0,a.adjustRowsAndCols(),o.hooks.run(u,"afterLoadData"),r.firstRun?r.firstRun=[null,"loadData"]:(o.hooks.run(u,"afterChange",null,"loadData"),u.render()),r.isPopulated=!0},this.getData=function(e,t,o,n){return void 0===e?s.getAll():s.getRange(new M(e,t),new M(o,n),s.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,o,n){return s.getCopyableText(new M(e,t),new M(o,n))},this.updateSettings=function(e,t){var n,i,l,h;if(void 0!==e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if(void 0!==e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(n in e)"data"!==n&&(void 0!==o.hooks.hooks[n]||void 0!==o.hooks.legacy[n]?("function"==typeof e[n]||o.helper.isArray(e[n]))&&u.addHook(n,e[n]):!t&&e.hasOwnProperty(n)&&(d.prototype[n]=e[n]));if(void 0===e.data&&void 0===r.settings.data?u.loadData(null):void 0!==e.data?u.loadData(e.data):void 0!==e.columns&&s.createMap(),i=u.countCols(),r.cellSettings.length=0,i>0)for(n=0;n<i;n++)r.columnSettings[n]=o.helper.columnFactory(d,r.columnsSettingConflicts),l=r.columnSettings[n].prototype,d.prototype.columns&&(h=d.prototype.columns[n],o.helper.extend(l,h),o.helper.extend(l,y(h)));if(void 0!==e.cell)for(n in e.cell){var f=e.cell[n];u.setCellMetaObject(f.row,f.col,f)}if(o.hooks.run(u,"afterCellMetaReset"),void 0!==e.className&&(d.prototype.className&&u.rootElement.removeClass(d.prototype.className),e.className&&u.rootElement.addClass(e.className)),void 0!==e.height){var p=e.height;"function"==typeof p&&(p=p()),u.rootElement[0].style.height=p+"px"}if(void 0!==e.width){var g=e.width;"function"==typeof g&&(g=g()),u.rootElement[0].style.width=g+"px"}p&&(u.rootElement[0].style.overflow="auto"),t||o.hooks.run(u,"afterUpdateSettings"),a.adjustRowsAndCols(),u.view&&!r.firstRun&&(u.forceFullRender=!0,c.refreshBorders(null,!0))},this.getValue=function(){var e=u.getSelected();if(d.prototype.getValue){if("function"==typeof d.prototype.getValue)return d.prototype.getValue.call(u);if(e)return u.getData()[e[0]][d.prototype.getValue]}else if(e)return u.getDataAtCell(e[0],e[1])},this.getSettings=function(){return r.settings},this.clear=function(){c.selectAll(),c.empty()},this.alter=function(e,t,o,n,i){a.alter(e,t,o,n,i)},this.getCell=function(e,t){return u.view.getCellAtCoords(new M(e,t))},this.colToProp=function(e){return s.colToProp(e)},this.propToCol=function(e){return s.propToCol(e)},this.getDataAtCell=function(e,t){return s.get(e,s.colToProp(t))},this.getDataAtRowProp=function(e,t){return s.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,s.getRange(new M(0,e),new M(r.settings.data.length-1,e),s.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t=[];return t.concat.apply(t,s.getRange(new M(0,s.propToCol(e)),new M(r.settings.data.length-1,s.propToCol(e)),s.DESTINATION_RENDERER))},this.getSourceDataAtCol=function(e){for(var t=[],o=r.settings.data,n=0;n<o.length;n++)t.push(o[n][e]);return t},this.getSourceDataAtRow=function(e){return r.settings.data[e]},this.getDataAtRow=function(e){return s.getRange(new M(e,0),new M(e,this.countCols()-1),s.DESTINATION_RENDERER)[0]},this.removeCellMeta=function(e,t,o){null!=u.getCellMeta(e,t)[o]&&delete r.cellSettings[e][t][o]},this.setCellMetaObject=function(e,t,o){if("object"==typeof o)for(var n in o){var i=n,r=o[n];this.setCellMeta(e,t,i,r)}},this.setCellMeta=function(e,t,n,i){r.cellSettings[e]||(r.cellSettings[e]=[]),r.cellSettings[e][t]||(r.cellSettings[e][t]=new r.columnSettings[t]),r.cellSettings[e][t][n]=i,o.hooks.run(u,"afterSetCellMeta",e,t,n,i)},this.getCellMeta=function(e,t){var n,i=s.colToProp(t);if(e=function(e){return o.hooks.execute(u,"modifyRow",e)}(e),t=function(e){return o.hooks.execute(u,"modifyCol",e)}(t),r.columnSettings[t]||(r.columnSettings[t]=o.helper.columnFactory(d,r.columnsSettingConflicts)),r.cellSettings[e]||(r.cellSettings[e]=[]),r.cellSettings[e][t]||(r.cellSettings[e][t]=new r.columnSettings[t]),(n=r.cellSettings[e][t]).row=e,n.col=t,n.prop=i,n.instance=u,o.hooks.run(u,"beforeGetCellMeta",e,t,n),o.helper.extend(n,y(n)),n.cells){var l=n.cells.call(n,e,t,i);l&&(o.helper.extend(n,l),o.helper.extend(n,y(l)))}return o.hooks.run(u,"afterGetCellMeta",e,t,n),n};var C=o.helper.cellMethodLookupFactory("renderer");function b(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}this.getCellRenderer=function(e,t){var n=C.call(this,e,t);return o.renderers.getRenderer(n)},this.getCellEditor=o.helper.cellMethodLookupFactory("editor"),this.getCellValidator=o.helper.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new g;t.onQueueEmpty=e;for(var o=u.countRows()-1;o>=0;){for(var n=u.countCols()-1;n>=0;)t.addValidatorToQueue(),u.validateCell(u.getDataAtCell(o,n),u.getCellMeta(o,n),(function(){t.removeValidatorFormQueue()}),"validateCells"),n--;o--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0===e){for(var t=[],o=0,n=u.countRows();o<n;o++)t.push(u.getRowHeader(o));return t}return"[object Array]"===Object.prototype.toString.call(r.settings.rowHeaders)&&void 0!==r.settings.rowHeaders[e]?r.settings.rowHeaders[e]:"function"==typeof r.settings.rowHeaders?r.settings.rowHeaders(e):r.settings.rowHeaders&&"string"!=typeof r.settings.rowHeaders&&"number"!=typeof r.settings.rowHeaders?e+1:r.settings.rowHeaders},this.hasRowHeaders=function(){return!!r.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==r.settings.colHeaders&&null!==r.settings.colHeaders)return!!r.settings.colHeaders;for(var e=0,t=u.countCols();e<t;e++)if(u.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var t=[],n=0,i=u.countCols();n<i;n++)t.push(u.getColHeader(n));return t}var s=e;return e=o.hooks.execute(u,"modifyCol",e),r.settings.columns&&r.settings.columns[e]&&r.settings.columns[e].title?r.settings.columns[e].title:"[object Array]"===Object.prototype.toString.call(r.settings.colHeaders)&&void 0!==r.settings.colHeaders[e]?r.settings.colHeaders[e]:"function"==typeof r.settings.colHeaders?r.settings.colHeaders(e):r.settings.colHeaders&&"string"!=typeof r.settings.colHeaders&&"number"!=typeof r.settings.colHeaders?o.helper.spreadsheetColumnLabel(s):r.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=u.getCellMeta(0,e),o=t.width;if(void 0!==o&&o!==r.settings.width||(o=t.colWidths),null!=o){switch(typeof o){case"object":o=o[e];break;case"function":o=o(e)}"string"==typeof o&&(o=parseInt(o,10))}return o},this.getColWidth=function(e){var t=u._getColWidthFromSettings(e);return t||(t=50),o.hooks.execute(u,"modifyColWidth",t,e)},this._getRowHeightFromSettings=function(e){var t=r.settings.rowHeights;if(null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=u._getRowHeightFromSettings(e),n=u.checkIfRowIsOversized(e);return t=o.hooks.execute(u,"modifyRowHeight",t,e),n&&(t=t?Math.max(t,n):n),t},this.checkIfRowIsOversized=function(e){if(u.view.wt.wtTable.oversizedRows)return u.view.wt.wtTable.oversizedRows[e]},this.countRows=function(){return r.settings.data.length},this.countCols=function(){return"object"===u.dataType||"function"===u.dataType?r.settings.columns&&r.settings.columns.length?r.settings.columns.length:s.colToPropCache.length:"array"===u.dataType?r.settings.columns&&r.settings.columns.length?r.settings.columns.length:r.settings.data&&r.settings.data[0]&&r.settings.data[0].length?r.settings.data[0].length:0:void 0},this.rowOffset=function(){return u.view.wt.getSetting("offsetRow")},this.colOffset=function(){return 0},this.countVisibleRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.rowStrategy.countVisible():-1},this.countVisibleCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.columnStrategy.countVisible():-1},this.countEmptyRows=function(e){for(var t,n=u.countRows()-1,i=0;n>=0;){if(t=o.hooks.execute(this,"modifyRow",n),u.isEmptyRow(t))i++;else if(e)break;n--}return i},this.countEmptyCols=function(e){if(u.countRows()<1)return 0;for(var t=u.countCols()-1,o=0;t>=0;){if(u.isEmptyCol(t))o++;else if(e)break;t--}return o},this.isEmptyRow=function(e){return r.settings.isEmptyRow.call(u,e)},this.isEmptyCol=function(e){return r.settings.isEmptyCol.call(u,e)},this.selectCell=function(e,t,o,n,i){if("number"!=typeof e||e<0||e>=u.countRows())return!1;if("number"!=typeof t||t<0||t>=u.countCols())return!1;if(void 0!==o){if("number"!=typeof o||o<0||o>=u.countRows())return!1;if("number"!=typeof n||n<0||n>=u.countCols())return!1}var s=new M(e,t);return r.selRange=new N(s,s,s),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),u.listen(),void 0===o?c.setRangeEnd(r.selRange.from,i):c.setRangeEnd(new M(o,n),i),u.selection.finish(),!0},this.selectCellByProp=function(e,t,o,n,i){return arguments[1]=s.propToCol(arguments[1]),void 0!==arguments[3]&&(arguments[3]=s.propToCol(arguments[3])),u.selectCell.apply(u,arguments)},this.deselectCell=function(){c.deselect()},this.destroy=function(){for(var n in u._clearTimeouts(),u.view&&u.view.wt.destroy(),u.rootElement.empty(),u.rootElement.removeData("handsontable"),u.rootElement.off(".handsontable"),e(t).off("."+u.guid),f.off("."+u.guid),p.off("."+u.guid),o.hooks.run(u,"afterDestroy"),o.hooks.destroy(u),u)u.hasOwnProperty(n)&&("function"==typeof u[n]?"runHooks"!==n&&"runHooksAndReturn"!==n&&(u[n]=b):"guid"!==n&&(u[n]=null));r=null,s=null,a=null,c=null,h=null,u=null,d=null,f=null,p=null},this.getActiveEditor=function(){return h.getActiveEditor()},this.getInstance=function(){return u},this.addHook=function(e,t){o.hooks.add(e,t,u)},this.addHookOnce=function(e,t){o.hooks.once(e,t,u)},this.removeHook=function(e,t){o.hooks.remove(e,t,u)},this.runHooks=function(e,t,n,i,r,s,l){o.hooks.run(u,e,t,n,i,r,s,l)},this.runHooksAndReturn=function(e,t,n,i,r,s,l){return o.hooks.execute(u,e,t,n,i,r,s,l)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;e<t;e++)clearTimeout(this.timeouts[e])},this.version="0.11.4"};var n,i,r,s,l=function(){};l.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){for(var t,o=0,n=this.countCols();o<n;o++)if(""!==(t=this.getDataAtCell(e,o))&&null!=t)return!1;return!0},isEmptyCol:function(e){for(var t,o=0,n=this.countRows();o<n;o++)if(""!==(t=this.getDataAtCell(o,e))&&null!=t)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,type:"text",copyable:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,groups:void 0},o.DefaultSettings=l,e.fn.handsontable=function(e){var t,n,i,r,s,l=this.first(),a=l.data("handsontable");if("string"!=typeof e)return s=e||{},a?a.updateSettings(s):(a=new o.Core(l,s),l.data("handsontable",a),a.init()),l;if(i=[],arguments.length>1)for(t=1,n=arguments.length;t<n;t++)i.push(arguments[t]);if(a){if(void 0===a[e])throw new Error("Handsontable do not provide action: "+e);r=a[e].apply(a,i)}return r},function(e){e.MultiMap||(e.MultiMap=function(){var e={arrayMap:[],weakMap:new WeakMap};return{get:function(n){return t(n)?e.arrayMap[n]:o(n)?e.weakMap.get(n):void 0},set:function(n,i){if(t(n))e.arrayMap[n]=i;else{if(!o(n))throw new Error("Invalid key type");e.weakMap.set(n,i)}},delete:function(n){t(n)?delete e.arrayMap[n]:o(n)&&e.weakMap.delete(n)}};function t(e){return null!==e&&!function(e){return e!=e}(e)&&("string"==typeof e||"number"==typeof e)}function o(e){return null!==e&&("object"==typeof e||"function"==typeof e)}})}(t),t.Handsontable||(o={}),o.Dom={},o.Dom.closest=function(e,t,o){for(;null!=e&&e!==o;){if(1===e.nodeType&&t.indexOf(e.nodeName)>-1)return e;e=e.parentNode}return null},o.Dom.isChildOf=function(e,t){for(var o=e.parentNode;null!=o;){if(o==t)return!0;o=o.parentNode}return!1},o.Dom.index=function(e){for(var t=0;e=e.previousSibling;)++t;return t},document.documentElement.classList?(o.Dom.hasClass=function(e,t){return e.classList.contains(t)},o.Dom.addClass=function(e,t){e.classList.add(t)},o.Dom.removeClass=function(e,t){e.classList.remove(t)}):(o.Dom.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},o.Dom.addClass=function(e,t){""==e.className?e.className=t:this.hasClass(e,t)||(e.className+=" "+t)},o.Dom.removeClass=function(e,t){if(this.hasClass(e,t)){var o=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(o," ").trim()}}),o.Dom.removeTextNodes=function(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var o=e.childNodes,n=o.length-1;n>=0;n--)this.removeTextNodes(o[n],e)},o.Dom.empty=function(e){for(var t;t=e.lastChild;)e.removeChild(t)},o.Dom.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,o.Dom.fastInnerHTML=function(e,t){this.HTML_CHARACTERS.test(t)?e.innerHTML=t:this.fastInnerText(e,t)},document.createTextNode("test").textContent?o.Dom.fastInnerText=function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=t:(this.empty(e),e.appendChild(document.createTextNode(t)))}:o.Dom.fastInnerText=function(e,t){var o=e.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.data=t:(this.empty(e),e.appendChild(document.createTextNode(t)))},o.Dom.isVisible=function(e){for(var t=e;t!==document.documentElement;){if(null===t)return!1;if(11===t.nodeType){if(t.host){if(t.host.impl)return o.Dom.isVisible(t.host.impl);if(t.host)return o.Dom.isVisible(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===t.style.display)return!1;t=t.parentNode}return!0},o.Dom.offset=function(e){if(this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName){var o=e.getBoundingClientRect();return{top:o.top+(t.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:o.left+(t.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}for(var n=e.offsetLeft,i=e.offsetTop,r=e;(e=e.offsetParent)&&e!==document.body;)n+=e.offsetLeft,i+=e.offsetTop,r=e;return r&&"fixed"===r.style.position&&(n+=t.pageXOffset||document.documentElement.scrollLeft,i+=t.pageYOffset||document.documentElement.scrollTop),{left:n,top:i}},o.Dom.getWindowScrollTop=function(){var e=t.scrollY;return null==e&&(e=document.documentElement.scrollTop),e},o.Dom.getWindowScrollLeft=function(){var e=t.scrollX;return null==e&&(e=document.documentElement.scrollLeft),e},o.Dom.getScrollTop=function(e){return e===t?o.Dom.getWindowScrollTop(e):e.scrollTop},o.Dom.getScrollLeft=function(e){return e===t?o.Dom.getWindowScrollLeft(e):e.scrollLeft},o.Dom.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)},o.Dom.outerWidth=function(e){return e.offsetWidth},o.Dom.outerHeight=function(e){return this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight},o.Dom.innerHeight=function(e){return e.clientHeight},o.Dom.innerWidth=function(e){return e.innerWidth},o.Dom.hasCaptionProblem=function(){return void 0===n&&function(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var o=document.createElement("CAPTION");o.innerHTML="c<br>c<br>c<br>c",o.style.padding=0,o.style.margin=0,e.insertBefore(o,t),document.body.appendChild(e),n=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}(),n},o.Dom.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var o=e.createTextRange(),n=o.duplicate();return o.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",o),n.text.length}return 0},o.Dom.getSelectionEndPosition=function(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();return null==t?0:e.createTextRange().text.indexOf(t.text)+t.text.length}},o.Dom.setCaretPosition=function(e,t,o){if(void 0===o&&(o=t),e.setSelectionRange)e.focus(),e.setSelectionRange(t,o);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",o),n.moveStart("character",t),n.select()}},o.Dom.getScrollbarWidth=function(){return void 0===i&&(i=function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var o=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;return o==n&&(n=t.clientWidth),(document.body||document.documentElement).removeChild(t),o-n}()),i},o.TableView=function(n){var i=this,r=e(document.documentElement);this.instance=n,this.settings=n.getSettings(),n.rootElement.data("originalStyle",n.rootElement[0].getAttribute("style")),n.rootElement.addClass("handsontable");var s,l=document.createElement("TABLE");l.className="htCore",this.THEAD=document.createElement("THEAD"),l.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),l.appendChild(this.TBODY),n.$table=e(l),n.container.prepend(n.$table),n.rootElement.on("mousedown.handsontable",(function(e){i.isTextSelectionAllowed(e.target)||(a(),e.preventDefault(),t.focus())})),r.on("keyup."+n.guid,(function(e){n.selection.isInProgress()&&!e.shiftKey&&n.selection.finish()})),this.isMouseDown=function(){return s},r.on("mouseup."+n.guid,(function(e){n.selection.isInProgress()&&1===e.which&&n.selection.finish(),s=!1,o.helper.isOutsideInput(document.activeElement)&&n.unlisten()})),r.on("mousedown."+n.guid,(function(e){var t=e.target;if(!s){if(t!==i.wt.wtTable.spreader)for(;t!==document.documentElement;){if(null===t)return;if(t===n.rootElement[0])return;t=t.parentNode}i.settings.outsideClickDeselects?n.deselectCell():n.destroyEditor()}})),n.$table.on("selectstart",(function(e){i.settings.fragmentSelection||e.preventDefault()}));var a=function(){t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():document.selection&&document.selection.empty()},c=[new q({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&!n.selection.isMultiple()}}}),new q({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&n.selection.isMultiple()}}}),new q({className:"highlight",highlightRowClassName:i.settings.currentRowClassName,highlightColumnClassName:i.settings.currentColClassName}),new q({className:"fill",border:{width:1,color:"red"}})];c.current=c[0],c.area=c[1],c.highlight=c[2],c.fill=c[3];var h={debug:function(){return i.settings.debug},table:l,stretchH:this.settings.stretchH,data:n.getDataAtCell,totalRows:n.countRows,totalColumns:n.countCols,offsetRow:0,fixedColumnsLeft:function(){return i.settings.fixedColumnsLeft},fixedRowsTop:function(){return i.settings.fixedRowsTop},renderAllRows:i.settings.renderAllRows,rowHeaders:function(){var e=[];return n.hasRowHeaders()&&e.push((function(e,t){i.appendRowHeader(e,t)})),o.hooks.run(n,"afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return n.hasColHeaders()&&e.push((function(e,t){i.appendColHeader(e,t)})),o.hooks.run(n,"afterGetColumnHeaderRenderers",e),e},columnWidth:n.getColWidth,rowHeight:n.getRowHeight,cellRenderer:function(e,t,n){var r=i.instance.colToProp(t),s=i.instance.getCellMeta(e,t),l=i.instance.getCellRenderer(s),a=i.instance.getDataAtRowProp(e,r);l(i.instance,n,e,t,r,a,s),o.hooks.run(i.instance,"afterRenderer",n,e,t,r,a,s)},selections:c,hideBorderOnMouseDownOver:function(){return i.settings.fragmentSelection},onCellMouseDown:function(e,t,r,l){n.listen(),i.activeWt=l,s=!0,o.hooks.run(n,"beforeOnCellMouseDown",e,t,r),e.isImmediatePropagationStopped()||(2===e.button&&n.selection.inInSelection(t)||(e.shiftKey?t.row>=0&&t.col>=0&&n.selection.setRangeEnd(t):t.row<0||t.col<0?(t.row<0&&(n.selectCell(0,t.col,n.countRows()-1,t.col),n.selection.setSelectedHeaders(!1,!0)),t.col<0&&(n.selectCell(t.row,0,t.row,n.countCols()-1),n.selection.setSelectedHeaders(!0,!1))):n.selection.setRangeStart(t)),o.hooks.run(n,"afterOnCellMouseDown",e,t,r),i.activeWt=i.wt)},onCellMouseOver:function(e,t,r,l){i.activeWt=l,t.row>=0&&t.col>=0?s&&n.selection.setRangeEnd(t):s&&(t.row<0&&(n.selection.setRangeEnd(new M(n.countRows()-1,t.col)),n.selection.setSelectedHeaders(!1,!0)),t.col<0&&(n.selection.setRangeEnd(new M(t.row,n.countCols()-1)),n.selection.setSelectedHeaders(!0,!1))),o.hooks.run(n,"afterOnCellMouseOver",e,t,r),i.activeWt=i.wt},onCellCornerMouseDown:function(e){e.preventDefault(),o.hooks.run(n,"afterOnCellCornerMouseDown",e)},beforeDraw:function(e){i.beforeRender(e)},onDraw:function(e){i.onDraw(e)},onScrollVertically:function(){n.runHooks("afterScrollVertically")},onScrollHorizontally:function(){n.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,t){n.runHooks("beforeDrawBorders",e,t)}};o.hooks.run(n,"beforeInitWalkontable",h),this.wt=new B(h),this.activeWt=this.wt,e(i.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",(function(e){e.target===i.wt.wtTable.spreader&&3===e.which&&e.stopPropagation()})),r.on("click."+n.guid,(function(){i.settings.observeDOMVisibility&&i.wt.drawInterrupted&&(i.instance.forceFullRender=!0,i.render())}))},o.TableView.prototype.isTextSelectionAllowed=function(e){return!!o.helper.isInput(e)||!(!this.settings.fragmentSelection||!o.Dom.isChildOf(e,this.TBODY))},o.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},o.TableView.prototype.beforeRender=function(e){e&&o.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},o.TableView.prototype.onDraw=function(e){e&&o.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},o.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.rootElement.triggerHandler("render.handsontable")},o.TableView.prototype.getCellAtCoords=function(e){var t=this.wt.wtTable.getCell(e);return t<0?null:t},o.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},o.TableView.prototype.appendRowHeader=function(e,t){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="rowHeader",e>-1?o.Dom.fastInnerHTML(i,this.instance.getRowHeader(e)):o.Dom.fastInnerText(i," "),n.appendChild(i),o.Dom.empty(t),t.appendChild(n),o.hooks.run(this.instance,"afterGetRowHeader",e,t)},o.TableView.prototype.appendColHeader=function(e,t){var n=document.createElement("DIV"),i=document.createElement("SPAN");n.className="relative",i.className="colHeader",e>-1?o.Dom.fastInnerHTML(i,this.instance.getColHeader(e)):o.Dom.fastInnerText(i," "),n.appendChild(i),o.Dom.empty(t),t.appendChild(n),o.hooks.run(this.instance,"afterGetColHeader",e,t)},o.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0},o.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0},o.TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},function(e){function t(e){var t,o;o={},t=e,this.getInstance=function(e){return e.guid in o||(o[e.guid]=new t(e)),o[e.guid]}}var o={},n=new WeakMap;e.editors={registerEditor:function(e,i){var r=new t(i);"string"==typeof e&&(o[e]=r),n.set(i,r)},getEditor:function(e,t){var i;if("function"==typeof e)n.get(e)||this.registerEditor(null,e),i=n.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');i=o[e]}if(!i)throw Error('No editor registered under name "'+e+'"');return i.getInstance(t)}}}(o),function(t){t.EditorManager=function(o,n,i){var r,s=this,l=e(document),a=t.helper.keyCode,c=!1;this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return r},this.prepareEditor=function(){if(r&&r.isWaiting())this.closeEditor(!1,!1,(function(e){e&&s.prepareEditor()}));else{var e=n.selRange.highlight.row,i=n.selRange.highlight.col,l=o.colToProp(i),a=o.getCell(e,i),c=o.getDataAtCell(e,i),h=o.getCellMeta(e,i),u=o.getCellEditor(h);(r=t.editors.getEditor(u,o)).prepare(e,i,l,a,c,h)}},this.isEditorOpened=function(){return r.isOpened()},this.openEditor=function(e){r.cellProperties.readOnly||r.beginEditing(e)},this.closeEditor=function(e,t,o){r?r.finishEditing(e,t,o):o&&o(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},function(){function e(e){var t="function"==typeof n.settings.enterMoves?n.settings.enterMoves(event):n.settings.enterMoves;e?i.transformStart(-t.row,-t.col):i.transformStart(t.row,t.col,!0)}o.addHook("afterDocumentKeyDown",(function(l){!function(l){if(o.isListening()&&(t.hooks.run(o,"beforeKeyDown",l),!c&&!l.isImmediatePropagationStopped()&&(n.lastKeyCode=l.keyCode,i.isSelected()))){var h=(l.ctrlKey||l.metaKey)&&!l.altKey;if(!(r.isWaiting()||t.helper.isMetaKey(l.keyCode)||h||s.isEditorOpened()))return void s.openEditor("");var u=l.shiftKey?i.setRangeEnd:i.setRangeStart;switch(l.keyCode){case a.A:h&&(i.selectAll(),l.preventDefault(),l.stopPropagation());break;case a.ARROW_UP:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(h),l.shiftKey?i.transformEnd(-1,0):i.transformStart(-1,0),l.preventDefault(),l.stopPropagation();break;case a.ARROW_DOWN:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(h),l.shiftKey?i.transformEnd(1,0):i.transformStart(1,0),l.preventDefault(),l.stopPropagation();break;case a.ARROW_RIGHT:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(h),l.shiftKey?i.transformEnd(0,1):i.transformStart(0,1),l.preventDefault(),l.stopPropagation();break;case a.ARROW_LEFT:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(h),function(e){e?i.transformEnd(0,-1):i.transformStart(0,-1)}(l.shiftKey),l.preventDefault(),l.stopPropagation();break;case a.TAB:var d="function"==typeof n.settings.tabMoves?n.settings.tabMoves(l):n.settings.tabMoves;l.shiftKey?i.transformStart(-d.row,-d.col):i.transformStart(d.row,d.col,!0),l.preventDefault(),l.stopPropagation();break;case a.BACKSPACE:case a.DELETE:i.empty(l),s.prepareEditor(),l.preventDefault();break;case a.F2:s.openEditor(),l.preventDefault();break;case a.ENTER:s.isEditorOpened()?(r.state!==t.EditorState.WAITING&&s.closeEditorAndSaveChanges(h),e(l.shiftKey)):o.getSettings().enterBeginsEditing?s.openEditor():e(l.shiftKey),l.preventDefault(),l.stopImmediatePropagation();break;case a.ESCAPE:s.isEditorOpened()&&s.closeEditorAndRestoreOriginalValue(h),l.preventDefault();break;case a.HOME:l.ctrlKey||l.metaKey?u(new M(0,n.selRange.from.col)):u(new M(n.selRange.from.row,0)),l.preventDefault(),l.stopPropagation();break;case a.END:l.ctrlKey||l.metaKey?u(new M(o.countRows()-1,n.selRange.from.col)):u(new M(n.selRange.from.row,o.countCols()-1)),l.preventDefault(),l.stopPropagation();break;case a.PAGE_UP:i.transformStart(-o.countVisibleRows(),0),o.view.wt.scrollVertical(-o.countVisibleRows()),o.view.render(),l.preventDefault(),l.stopPropagation();break;case a.PAGE_DOWN:i.transformStart(o.countVisibleRows(),0),o.view.wt.scrollVertical(o.countVisibleRows()),o.view.render(),l.preventDefault(),l.stopPropagation()}}}(l)})),l.on("keydown."+o.guid,(function(e){o.runHooks("afterDocumentKeyDown",e)})),o.view.wt.update("onCellDblClick",(function(e,t,o){"TD"==o.nodeName&&s.openEditor()})),o.addHook("afterDestroy",(function(){c=!0}))}()}}(o),function(e){var t={};e.renderers={registerRenderer:function(e,o){t[e]=o},getRenderer:function(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(e in t))throw Error('No editor registered under name "'+e+'"');return t[e]}}}(o),o.helper.isPrintableChar=function(e){return 32==e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90},o.helper.isMetaKey=function(e){var t=o.helper.keyCode;return-1!=[t.ARROW_DOWN,t.ARROW_UP,t.ARROW_LEFT,t.ARROW_RIGHT,t.HOME,t.END,t.DELETE,t.BACKSPACE,t.F1,t.F2,t.F3,t.F4,t.F5,t.F6,t.F7,t.F8,t.F9,t.F10,t.F11,t.F12,t.TAB,t.PAGE_DOWN,t.PAGE_UP,t.ENTER,t.ESCAPE,t.SHIFT,t.CAPS_LOCK,t.ALT].indexOf(e)},o.helper.isCtrlKey=function(e){var t=o.helper.keyCode;return-1!=[t.CONTROL_LEFT,224,t.COMMAND_LEFT,t.COMMAND_RIGHT].indexOf(e)},o.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}},o.helper.spreadsheetColumnLabel=function(e){for(var t,o=e+1,n="";o>0;)t=(o-1)%26,n=String.fromCharCode(65+t)+n,o=parseInt((o-t)/26,10);return n},o.helper.isNumeric=function(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)},o.helper.isDescendant=function(e,t){for(var o=t.parentNode;null!=o;){if(o==e)return!0;o=o.parentNode}return!1},o.helper.randomString=function(){return _()},o.helper.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e},o.helper.extend=function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},o.helper.getPrototypeOf=function(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var o,n=e.constructor;"function"==typeof e.constructor&&(o=n,delete e.constructor&&(n=e.constructor,e.constructor=o)),t=n?n.prototype:null}return t},o.helper.columnFactory=function(e,t){function n(){}o.helper.inherit(n,e);for(var i=0,r=t.length;i<r;i++)n.prototype[t[i]]=void 0;return n},o.helper.translateRowsToColumns=function(e){var t,o,n,i,r=[],s=0;for(t=0,o=e.length;t<o;t++)for(n=0,i=e[t].length;n<i;n++)n==s&&(r.push([]),s++),r[n].push(e[t][n]);return r},o.helper.to2dArray=function(e){for(var t=0,o=e.length;t<o;)e[t]=[e[t]],t++},o.helper.extendArray=function(e,t){for(var o=0,n=t.length;o<n;)e.push(t[o]),o++},o.helper.isInput=function(e){return["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1},o.helper.isOutsideInput=function(e){return o.helper.isInput(e)&&-1==e.className.indexOf("handsontableInput")},o.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},o.helper.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)},o.helper.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"==Object.prototype.toString.call(e)},o.helper.pivot=function(e){var t=[];if(!e||0==e.length||!e[0]||0==e[0].length)return t;for(var o=e.length,n=e[0].length,i=0;i<o;i++)for(var r=0;r<n;r++)t[r]||(t[r]=[]),t[r][i]=e[i][r];return t},o.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}},o.helper.cellMethodLookupFactory=function(e,t){return t=void 0===t||t,function(n,i){return function n(i){if(i){if(i.hasOwnProperty(e)&&void 0!==i[e])return i[e];if(i.hasOwnProperty("type")&&i.type){var r;if("string"!=typeof i.type)throw new Error("Cell type must be a string ");if((r=function(e){var t=o.cellTypes[e];if(void 0===t)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return t}(i.type)).hasOwnProperty(e))return r[e];if(t)return}return n(o.helper.getPrototypeOf(i))}}("number"==typeof n?this.getCellMeta(n,i):n)}},o.helper.toString=function(e){return""+e},function(t){t.DataMap=function(e,t,o){this.instance=e,this.priv=t,this.GridSettings=o,this.dataSource=this.instance.getSettings().data,this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap()},t.DataMap.prototype.DESTINATION_RENDERER=1,t.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,t.DataMap.prototype.recursiveDuckSchema=function(t){var o;if(e.isPlainObject(t))for(var n in o={},t)t.hasOwnProperty(n)&&(e.isPlainObject(t[n])?o[n]=this.recursiveDuckSchema(t[n]):o[n]=null);else o=[];return o},t.DataMap.prototype.recursiveDuckColumns=function(t,o,n){var i,r;if(void 0===o&&(o=0,n=""),e.isPlainObject(t))for(r in t)t.hasOwnProperty(r)&&(null===t[r]?(i=n+r,this.colToPropCache.push(i),this.propToColCache.set(i,o),o++):o=this.recursiveDuckColumns(t[r],o,r+"."));return o},t.DataMap.prototype.createMap=function(){if(void 0===this.getSchema())throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");var e,t,o=this.getSchema();this.colToPropCache=[],this.propToColCache=new MultiMap;var n=this.instance.getSettings().columns;if(n)for(e=0,t=n.length;e<t;e++)void 0!==n[e].data&&(this.colToPropCache[e]=n[e].data,this.propToColCache.set(n[e].data,e));else this.recursiveDuckColumns(o)},t.DataMap.prototype.colToProp=function(e){return e=t.hooks.execute(this.instance,"modifyCol",e),this.colToPropCache&&void 0!==this.colToPropCache[e]?this.colToPropCache[e]:e},t.DataMap.prototype.propToCol=function(e){var o;return o=void 0!==this.propToColCache.get(e)?this.propToColCache.get(e):e,t.hooks.execute(this.instance,"modifyCol",o)},t.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},t.DataMap.prototype.createRow=function(o,n,i){var r,s=this.instance.countCols(),l=0;n||(n=1),("number"!=typeof o||o>=this.instance.countRows())&&(o=this.instance.countRows());for(var a=this.instance.getSettings().maxRows;l<n&&this.instance.countRows()<a;){if("array"===this.instance.dataType){r=[];for(var c=0;c<s;c++)r.push(null)}else r="function"===this.instance.dataType?this.instance.getSettings().dataSchema(o):e.extend(!0,{},this.getSchema());o===this.instance.countRows()?this.dataSource.push(r):this.dataSource.splice(o,0,r),l++}return t.hooks.run(this.instance,"afterCreateRow",o,l,i),this.instance.forceFullRender=!0,l},t.DataMap.prototype.createCol=function(e,o,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i,r,s=this.instance.countRows(),l=this.dataSource,a=0;o||(o=1),r=e;for(var c=this.instance.getSettings().maxCols;a<o&&this.instance.countCols()<c;){if(i=t.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof e||e>=this.instance.countCols()){for(var h=0;h<s;h++)void 0===l[h]&&(l[h]=[]),l[h].push(null);this.priv.columnSettings.push(i)}else{for(h=0;h<s;h++)l[h].splice(r,0,null);this.priv.columnSettings.splice(r,0,i)}a++,r++}return t.hooks.run(this.instance,"afterCreateCol",e,a,n),this.instance.forceFullRender=!0,a},t.DataMap.prototype.removeRow=function(e,o){o||(o=1),"number"!=typeof e&&(e=-o),e=(this.instance.countRows()+e)%this.instance.countRows();var n=this.physicalRowsToLogical(e,o);if(!1!==t.hooks.execute(this.instance,"beforeRemoveRow",e,o)){var i=this.dataSource,r=i.filter((function(e,t){return-1==n.indexOf(t)}));i.length=0,Array.prototype.push.apply(i,r),t.hooks.run(this.instance,"afterRemoveRow",e,o),this.instance.forceFullRender=!0}},t.DataMap.prototype.removeCol=function(e,o){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");if(o||(o=1),"number"!=typeof e&&(e=-o),e=(this.instance.countCols()+e)%this.instance.countCols(),!1!==t.hooks.execute(this.instance,"beforeRemoveCol",e,o)){for(var n=this.dataSource,i=0,r=this.instance.countRows();i<r;i++)n[i].splice(e,o);this.priv.columnSettings.splice(e,o),t.hooks.run(this.instance,"afterRemoveCol",e,o),this.instance.forceFullRender=!0}},t.DataMap.prototype.spliceCol=function(e,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(e),s=r.slice(o,o+n),l=r.slice(o+n);t.helper.extendArray(i,l);for(var a=0;a<n;)i.push(null),a++;return t.helper.to2dArray(i),this.instance.populateFromArray(o,e,i,null,null,"spliceCol"),s},t.DataMap.prototype.spliceRow=function(e,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getSourceDataAtRow(e),s=r.slice(o,o+n),l=r.slice(o+n);t.helper.extendArray(i,l);for(var a=0;a<n;)i.push(null),a++;return this.instance.populateFromArray(e,o,[i],null,null,"spliceRow"),s},t.DataMap.prototype.get=function(e,o){if(e=t.hooks.execute(this.instance,"modifyRow",e),"string"==typeof o&&o.indexOf(".")>-1){var n=o.split("."),i=this.dataSource[e];if(!i)return null;for(var r=0,s=n.length;r<s;r++)if(void 0===(i=i[n[r]]))return null;return i}return"function"==typeof o?o(this.dataSource.slice(e,e+1)[0]):this.dataSource[e]?this.dataSource[e][o]:null};var o=t.helper.cellMethodLookupFactory("copyable",!1);t.DataMap.prototype.getCopyable=function(e,n){if(o.call(this.instance,e,this.propToCol(n))){var i=this.get(e,n);return t.hooks.execute(this.instance,"beforeCopy",i,e,n)}return""},t.DataMap.prototype.set=function(e,o,n,i){if(e=t.hooks.execute(this.instance,"modifyRow",e,i||"datamapGet"),"string"==typeof o&&o.indexOf(".")>-1){for(var r=o.split("."),s=this.dataSource[e],l=0,a=r.length-1;l<a;l++)void 0===s[r[l]]&&(s[r[l]]={}),s=s[r[l]];s[r[l]]=n}else"function"==typeof o?o(this.dataSource.slice(e,e+1)[0],n):this.dataSource[e][o]=n},t.DataMap.prototype.physicalRowsToLogical=function(e,o){for(var n,i=this.instance.countRows(),r=(i+e)%i,s=[],l=o;r<i&&l;)n=t.hooks.execute(this.instance,"modifyRow",r),s.push(n),l--,r++;return s},t.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},t.DataMap.prototype.getAll=function(){return this.dataSource},t.DataMap.prototype.getRange=function(e,t,o){var n,i,r,s,l,a=[],c=o===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(i=Math.max(e.row,t.row),s=Math.max(e.col,t.col),n=Math.min(e.row,t.row);n<=i;n++){for(l=[],r=Math.min(e.col,t.col);r<=s;r++)l.push(c.call(this,n,this.colToProp(r)));a.push(l)}return a},t.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},t.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}}(o),function(e){e.renderers.cellDecorator=function(t,o,n,i,r,s,l){l.className&&(o.className?o.className=o.className+" "+l.className:o.className=l.className),l.readOnly&&e.Dom.addClass(o,l.readOnlyCellClassName),!1===l.valid&&l.invalidCellClassName&&e.Dom.addClass(o,l.invalidCellClassName),!1===l.wordWrap&&l.noWordWrapClassName&&e.Dom.addClass(o,l.noWordWrapClassName),!s&&l.placeholder&&e.Dom.addClass(o,l.placeholderCellClassName)}}(o),function(e){var t=function(t,o,n,i,r,s,l){e.renderers.cellDecorator.apply(this,arguments),!s&&l.placeholder&&(s=l.placeholder);var a=e.helper.stringify(s);if(l.rendererTemplate){e.Dom.empty(o);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=l.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getSourceDataAtRow(n),o.appendChild(c)}else e.Dom.fastInnerText(o,a)};e.renderers.TextRenderer=t,e.renderers.registerRenderer("text",t)}(o),function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var o=document.createElement("DIV");o.className="htAutocompleteArrow",o.appendChild(document.createTextNode("▼"));var n=function(n,i,r,s,l,a,c){t.cloneNode(!0);var h=o.cloneNode(!0);e.renderers.TextRenderer(n,i,r,s,l,a,c),i.appendChild(h),e.Dom.addClass(i,"htAutocomplete"),i.firstChild||i.appendChild(document.createTextNode(" ")),n.acArrowListener||(n.acArrowListener=function(){n.view.wt.getSetting("onCellDblClick",null,new M(r,s),i)},n.rootElement.on("mousedown.htAutocompleteArrow",".htAutocompleteArrow",n.acArrowListener),n.addHookOnce("afterDestroy",(function(){this.rootElement.off("mousedown.htAutocompleteArrow")})))};e.AutocompleteRenderer=n,e.renderers.AutocompleteRenderer=n,e.renderers.registerRenderer("autocomplete",n)}(o),function(t){var o=document.createElement("INPUT");o.className="htCheckboxRendererInput",o.type="checkbox",o.setAttribute("autocomplete","off");var n=function(n,i,r,s,l,a,c){void 0===c.checkedTemplate&&(c.checkedTemplate=!0),void 0===c.uncheckedTemplate&&(c.uncheckedTemplate=!1),t.Dom.empty(i);var h=o.cloneNode(!1);a===c.checkedTemplate||a===t.helper.stringify(c.checkedTemplate)?(h.checked=!0,i.appendChild(h)):a===c.uncheckedTemplate||a===t.helper.stringify(c.uncheckedTemplate)?i.appendChild(h):null===a?(h.className+=" noValue",i.appendChild(h)):t.Dom.fastInnerText(i,"#bad value#");var u=e(h);c.readOnly?u.on("click",(function(e){e.preventDefault()})):(u.on("mousedown",(function(e){e.stopPropagation()})),u.on("mouseup",(function(e){e.stopPropagation()})),u.on("change",(function(){this.checked?n.setDataAtRowProp(r,l,c.checkedTemplate):n.setDataAtRowProp(r,l,c.uncheckedTemplate)}))),n.CheckboxRenderer&&n.CheckboxRenderer.beforeKeyDownHookBound||(n.CheckboxRenderer={beforeKeyDownHookBound:!0},n.addHook("beforeKeyDown",(function(o){if(o.keyCode==t.helper.keyCode.SPACE)for(var i,r,s,l=n.getSelectedRange(),a=l.getTopLeftCorner(),c=l.getBottomRightCorner(),h=a.row;h<=c.row;h++)for(var u=a.col;u<=c.col;u++)if(i=n.getCell(h,u),s=n.getCellMeta(h,u),(r=i.querySelectorAll("input[type=checkbox]")).length>0&&!s.readOnly){o.isImmediatePropagationStopped()||(o.stopImmediatePropagation(),o.preventDefault());for(var d=0,f=r.length;d<f;d++)r[d].checked=!r[d].checked,e(r[d]).trigger("change")}})))};t.CheckboxRenderer=n,t.renderers.CheckboxRenderer=n,t.renderers.registerRenderer("checkbox",n)}(o),function(e){var t=function(t,o,n,i,r,s,l){e.helper.isNumeric(s)&&(void 0!==l.language&&numeral.language(l.language),s=numeral(s).format(l.format||"0"),e.Dom.addClass(o,"htNumeric")),e.renderers.TextRenderer(t,o,n,i,r,s,l)};e.NumericRenderer=t,e.renderers.NumericRenderer=t,e.renderers.registerRenderer("numeric",t)}(o),s=function(e,t,n,i,r,s,l){var a;o.renderers.TextRenderer.apply(this,arguments),s=t.innerHTML;var c=l.hashLength||s.length,h=l.hashSymbol||"*";for(a="";a.split(h).length-1<c;a+=h);o.Dom.fastInnerHTML(t,a)},(r=o).PasswordRenderer=s,r.renderers.PasswordRenderer=s,r.renderers.registerRenderer("password",s),function(e){function t(t,o,n,i,r,s,l){e.renderers.cellDecorator.apply(this,arguments),e.Dom.fastInnerHTML(o,s)}e.renderers.registerRenderer("html",t),e.renderers.HtmlRenderer=t}(o),function(e){function t(t){this.instance=t,this.state=e.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},t.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},t.prototype.init=function(){},t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},t.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")},t.prototype.open=function(){throw Error("Editor open() method unimplemented")},t.prototype.close=function(){throw Error("Editor close() method unimplemented")},t.prototype.prepare=function(t,o,n,i,r,s){this.TD=i,this.row=t,this.col=o,this.prop=n,this.originalValue=r,this.cellProperties=s,this.state=e.EditorState.VIRGIN},t.prototype.extend=function(){var e=this.constructor;return function(e,t){function o(){}return o.prototype=t.prototype,(e.prototype=new o).constructor=e,e}((function(){e.apply(this,arguments)}),e)},t.prototype.saveValue=function(e,t){if(t){var o,n=this.instance.getSelected();n[0]>n[2]&&(o=n[0],n[0]=n[2],n[2]=o),n[1]>n[3]&&(o=n[1],n[1]=n[3],n[3]=o),this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")}else this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},t.prototype.beginEditing=function(t){this.state==e.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new M(this.row,this.col)),this.instance.view.render(),this.state=e.EditorState.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue(e.helper.stringify(t)),this.open(),this._opened=!0,this.focus(),this.instance.view.render())},t.prototype.finishEditing=function(t,o,n){if(n){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),n(e)}}if(!this.isWaiting())if(this.state!=e.EditorState.VIRGIN){if(this.state==e.EditorState.EDITING){if(t)return void this.cancelChanges();var r=[[String.prototype.trim.call(this.getValue())]];this.state=e.EditorState.WAITING,this.saveValue(r,o),this.instance.getCellValidator(this.cellProperties)?(s=this,this.instance.addHookOnce("afterValidate",(function(t){s.state=e.EditorState.FINISHED,s.discardEditor(t)}))):(this.state=e.EditorState.FINISHED,this.discardEditor(!0))}}else{var s=this;this.instance._registerTimeout(setTimeout((function(){s._fireCallbacks(!0)}),0))}},t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED,this.discardEditor()},t.prototype.discardEditor=function(t){this.state===e.EditorState.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=e.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=e.EditorState.VIRGIN,this._fireCallbacks(!0)))},t.prototype.isOpened=function(){return this._opened},t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING},e.editors.BaseEditor=t}(o),function(t){var o=t.editors.BaseEditor.prototype.extend();o.prototype.init=function(){this.createElements(),this.bindEvents(),this.autoResize=c()},o.prototype.getValue=function(){return this.TEXTAREA.value},o.prototype.setValue=function(e){this.TEXTAREA.value=e};var n=function(e){var o=this.getActiveEditor(),n=t.helper.keyCode,i=(e.ctrlKey||e.metaKey)&&!e.altKey;if(e.target===o.TEXTAREA&&!e.isImmediatePropagationStopped())if(17!==e.keyCode&&224!==e.keyCode&&91!==e.keyCode&&93!==e.keyCode)switch(e.keyCode){case n.ARROW_RIGHT:t.Dom.getCaretPosition(o.TEXTAREA)!==o.TEXTAREA.value.length&&e.stopImmediatePropagation();break;case n.ARROW_LEFT:0!==t.Dom.getCaretPosition(o.TEXTAREA)&&e.stopImmediatePropagation();break;case n.ENTER:var r=o.instance.getSelected(),s=!(r[0]===r[2]&&r[1]===r[3]);(i&&!s||e.altKey)&&(o.isOpened()?(o.setValue(o.getValue()+"\n"),o.focus()):o.beginEditing(o.originalValue+"\n"),e.stopImmediatePropagation()),e.preventDefault();break;case n.A:case n.X:case n.C:case n.V:i&&e.stopImmediatePropagation();break;case n.BACKSPACE:case n.DELETE:case n.HOME:case n.END:e.stopImmediatePropagation()}else e.stopImmediatePropagation()};o.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",n)},o.prototype.close=function(){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",n)},o.prototype.focus=function(){this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},o.prototype.createElements=function(){this.$body=e(document.body),this.TEXTAREA=document.createElement("TEXTAREA"),this.$textarea=e(this.TEXTAREA),t.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),t.Dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var o=this;this.instance._registerTimeout(setTimeout((function(){o.refreshDimensions()}),0))},o.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},o.prototype.getEditedCell=function(){var e;switch(this.checkEditorSection()){case"top":e=this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"corner":e=this.instance.view.wt.wtScrollbars.corner.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},o.prototype.refreshDimensions=function(){if(this.state===t.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){var o=e(this.TD),n=t.Dom.offset(this.TD),i=t.Dom.offset(this.instance.rootElement[0]),r=n.top-i.top-1,s=n.left-i.left-1,l=this.instance.getSettings(),a=!1===l.rowHeaders?0:1,c=!1===l.colHeaders?0:1;this.checkEditorSection(),r<0&&(r=0),s<0&&(s=0),a>0&&parseInt(o.css("border-top-width"),10)>0&&(r+=1),c>0&&parseInt(o.css("border-left-width"),10)>0&&(s+=1),this.textareaParentStyle.top=r+"px",this.textareaParentStyle.left=s+"px";var h=this.TD.offsetTop-this.instance.view.wt.wtScrollbars.vertical.getScrollPosition(),u=this.TD.offsetLeft-this.instance.view.wt.wtScrollbars.horizontal.getScrollPosition(),d=o.width(),f=this.instance.view.maximumVisibleElementWidth(u)-10,p=o.outerHeight()-4,g=this.instance.view.maximumVisibleElementHeight(h)-2;parseInt(o.css("border-top-width"),10)>0&&(p-=1),parseInt(o.css("border-left-width"),10)>0&&a>0&&(d-=1),this.TEXTAREA.style.fontSize=t.Dom.getComputedStyle(this.TD).fontSize,this.TEXTAREA.style.fontFamily=t.Dom.getComputedStyle(this.TD).fontFamily,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(p,g),maxHeight:g,minWidth:Math.min(d,f),maxWidth:f}),this.textareaParentStyle.display="block"}},o.prototype.bindEvents=function(){var e=this;this.$textarea.on("cut.editor",(function(e){e.stopPropagation()})),this.$textarea.on("paste.editor",(function(e){e.stopPropagation()})),this.instance.addHook("afterScrollVertically",(function(){e.refreshDimensions()}))},t.editors.TextEditor=o,t.editors.registerEditor("text",t.editors.TextEditor)}(o),function(t){var o=t.editors.BaseEditor.prototype.extend();o.prototype.beginEditing=function(){var t=this.TD.querySelector('input[type="checkbox"]');t&&e(t).trigger("click")},o.prototype.finishEditing=function(){},o.prototype.init=function(){},o.prototype.open=function(){},o.prototype.close=function(){},o.prototype.getValue=function(){},o.prototype.setValue=function(){},o.prototype.focus=function(){},t.editors.CheckboxEditor=o,t.editors.registerEditor("checkbox",o)}(o),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.init=function(){if(!e.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");t.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var o=this;this.instance.addHook("afterDestroy",(function(){o.destroyElements()}))},o.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),t.Dom.addClass(this.datePicker,"htDatepickerHolder"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,document.body.appendChild(this.datePicker),this.$datePicker=e(this.datePicker);var o=this,n={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,onSelect:function(e){o.setValue(e),o.finishEditing(!1)}};this.$datePicker.datepicker(n),this.$datePicker.on("mousedown",(function(e){e.stopPropagation()})),this.hideDatepicker()},o.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy"),this.$datePicker.remove()},o.prototype.open=function(){t.editors.TextEditor.prototype.open.call(this),this.showDatepicker()},o.prototype.finishEditing=function(e,o){this.hideDatepicker(),t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.showDatepicker=function(){var t=e(this.TD),o=t.offset();this.datePickerStyle.top=o.top+t.height()+"px",this.datePickerStyle.left=o.left+"px";var n={defaultDate:this.originalValue||void 0};e.extend(n,this.cellProperties),this.$datePicker.datepicker("option",n),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},o.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},t.editors.DateEditor=o,t.editors.registerEditor("date",o)}(o),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments);var o=document.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.$htContainer=e(o),this.$htContainer.handsontable()},o.prototype.prepare=function(o,n,i,r,s,l){t.editors.TextEditor.prototype.prepare.apply(this,arguments);var a=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&a.setValue(e),a.instance.destroyEditor()}};this.cellProperties.handsontable&&(c=e.extend(c,l.handsontable)),this.$htContainer.handsontable("destroy"),this.$htContainer.handsontable(c)};var n=function(e){if(!e.isImmediatePropagationStopped()){var o,n=this.getActiveEditor(),i=n.$htContainer.handsontable("getInstance");if(e.keyCode==t.helper.keyCode.ARROW_DOWN)if(i.getSelected()){var r=i.getSelected()[0],s=i.countRows()-1;o=Math.min(s,r+1)}else o=0;else e.keyCode==t.helper.keyCode.ARROW_UP&&i.getSelected()&&(o=(r=i.getSelected()[0])-1);void 0!==o&&(o<0?i.deselectCell():i.selectCell(o,0),e.preventDefault(),e.stopImmediatePropagation(),n.instance.listen(),n.TEXTAREA.focus())}};o.prototype.open=function(){this.instance.addHook("beforeKeyDown",n),t.editors.TextEditor.prototype.open.apply(this,arguments),this.$htContainer.handsontable("render"),this.cellProperties.strict?(this.$htContainer.handsontable("selectCell",0,0),this.TEXTAREA.style.visibility="hidden"):(this.$htContainer.handsontable("deselectCell"),this.TEXTAREA.style.visibility="visible"),t.Dom.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)},o.prototype.close=function(){this.instance.removeHook("beforeKeyDown",n),this.instance.listen(),t.editors.TextEditor.prototype.close.apply(this,arguments)},o.prototype.focus=function(){this.instance.listen(),t.editors.TextEditor.prototype.focus.apply(this,arguments)},o.prototype.beginEditing=function(e){var o=this.instance.getSettings().onBeginEditing;o&&!1===o()||t.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},o.prototype.finishEditing=function(e,o){if(this.$htContainer.handsontable("isListening")&&this.instance.listen(),this.$htContainer.handsontable("getSelected")){var n=this.$htContainer.handsontable("getInstance").getValue();void 0!==n&&this.setValue(n)}return t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},t.editors.HandsontableEditor=o,t.editors.registerEditor("handsontable",o)}(o),function(e){var o=e.editors.HandsontableEditor.prototype.extend();o.prototype.init=function(){e.editors.HandsontableEditor.prototype.init.apply(this,arguments),this.$htContainer.handsontable("getInstance").updateSettings({height:1}),this.query=null,this.choices=[]},o.prototype.createElements=function(){e.editors.HandsontableEditor.prototype.createElements.apply(this,arguments),this.$htContainer.addClass("autocompleteEditor"),this.$htContainer.addClass(-1!=t.navigator.platform.indexOf("Mac")?"htMacScroll":"")};var n=!1,i=function(t){n=!1;var o=this.getActiveEditor(),i=e.helper.keyCode;(e.helper.isPrintableChar(t.keyCode)||t.keyCode===i.BACKSPACE||t.keyCode===i.DELETE||t.keyCode===i.INSERT)&&o.instance._registerTimeout(setTimeout((function(){o.queryChoices(o.TEXTAREA.value),n=!0}),0))};o.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",i),e.editors.HandsontableEditor.prototype.prepare.apply(this,arguments)},o.prototype.open=function(){e.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.TEXTAREA.style.visibility="visible",this.focus();var t=this.$htContainer.handsontable("getInstance"),o=this;t.updateSettings({colWidths:[e.Dom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,t,n,i,r){var s=!0===this.getCellMeta(t,n).filteringCaseSensitive?r.indexOf(this.query):r.toLowerCase().indexOf(o.query.toLowerCase());if(-1!=s){var l=r.substr(s,o.query.length);e.innerHTML=r.replace(l,"<strong>"+l+"</strong>")}}}),n&&(n=!1),o.instance._registerTimeout(setTimeout((function(){o.queryChoices(o.TEXTAREA.value)}),0))},o.prototype.close=function(){e.editors.HandsontableEditor.prototype.close.apply(this,arguments)},o.prototype.queryChoices=function(t){if(this.query=t,"function"==typeof this.cellProperties.source){var o=this;this.cellProperties.source(t,(function(e){o.updateChoicesList(e)}))}else if(e.helper.isArray(this.cellProperties.source)){var n;if(t&&!1!==this.cellProperties.filter){var i=!0===this.cellProperties.filteringCaseSensitive,r=t.toLowerCase();n=this.cellProperties.source.filter((function(e){return i?-1!=e.indexOf(t):-1!=e.toLowerCase().indexOf(r)}))}else n=this.cellProperties.source;this.updateChoicesList(n)}else this.updateChoicesList([])},o.prototype.updateChoicesList=function(t){var n,i=e.Dom.getCaretPosition(this.TEXTAREA),r=e.Dom.getSelectionEndPosition(this.TEXTAREA),s=o.sortByRelevance(this.getValue(),t,this.cellProperties.filteringCaseSensitive);if(0!=this.cellProperties.filter){for(var l=[],a=0,c=s.length;a<c;a++)l.push(t[s[a]]);n=0,t=l}else n=s[0];this.choices=t,this.$htContainer.handsontable("loadData",e.helper.pivot([t])),this.$htContainer.handsontable("updateSettings",{height:this.getDropdownHeight()}),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(n),this.instance.listen(),this.TEXTAREA.focus(),e.Dom.setCaretPosition(this.TEXTAREA,i,i!=r?r:void 0)},o.prototype.finishEditing=function(t){t||this.instance.removeHook("beforeKeyDown",i),e.editors.HandsontableEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.$htContainer.handsontable("selectCell",e,0):this.$htContainer.handsontable("deselectCell")},o.sortByRelevance=function(e,t,o){var n,i,r,s,l,a=[],c=e.length,h=[];if(0===c){for(s=0,l=t.length;s<l;s++)h.push(s);return h}for(s=0,l=t.length;s<l;s++)n=t[s],-1!=(i=o?n.indexOf(e):n.toLowerCase().indexOf(e.toLowerCase()))&&(r=n.length-i-c,a.push({baseIndex:s,index:i,charsLeft:r,value:n}));for(a.sort((function(e,t){return-1===t.index?-1:-1===e.index?1:e.index<t.index?-1:t.index<e.index?1:e.index===t.index?e.charsLeft<t.charsLeft?-1:e.charsLeft>t.charsLeft?1:0:void 0})),s=0,l=a.length;s<l;s++)h.push(a[s].baseIndex);return h},o.prototype.getDropdownHeight=function(){var e=this.$htContainer.handsontable("getInstance").getRowHeight(0)||23;return this.choices.length>=10?10*e:this.choices.length*e+8},e.editors.AutocompleteEditor=o,e.editors.registerEditor("autocomplete",o)}(o),function(t){var o=t.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.$textarea=e(this.TEXTAREA),t.Dom.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},t.editors.PasswordEditor=o,t.editors.registerEditor("password",o)}(o),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT"),e.Dom.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement[0].appendChild(this.select)},t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t,o=this.cellProperties.selectOptions;for(var n in t="function"==typeof o?this.prepareOptions(o(this.row,this.col,this.prop)):this.prepareOptions(o),e.Dom.empty(this.select),t)if(t.hasOwnProperty(n)){var i=document.createElement("OPTION");i.value=n,e.Dom.fastInnerHTML(i,t[n]),this.select.appendChild(i)}},t.prototype.prepareOptions=function(t){var o={};if(e.helper.isArray(t))for(var n=0,i=t.length;n<i;n++)o[t[n]]=t[n];else"object"==typeof t&&(o=t);return o},t.prototype.getValue=function(){return this.select.value},t.prototype.setValue=function(e){this.select.value=e};var o=function(t){var o=this.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var n=o.select.find("option:selected").prev();1==n.length&&n.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var i=o.select.find("option:selected").next();1==i.length&&i.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};t.prototype.open=function(){var t=e.Dom.outerWidth(this.TD),n=e.Dom.outerHeight(this.TD),i=e.Dom.offset(this.instance.rootElement[0]),r=e.Dom.offset(this.TD);this.select.style.height=n+"px",this.select.style.minWidth=t+"px",this.select.style.top=r.top-i.top+"px",this.select.style.left=r.left-i.left+"px",this.select.style.margin="0px",this.select.style.display="",this.instance.addHook("beforeKeyDown",o)},t.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",o)},t.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=t,e.editors.registerEditor("select",t)}(o),function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},e.editors.DropdownEditor=t,e.editors.registerEditor("dropdown",t)}(o),o.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*(\.|\,)?\d*$/.test(e))};var a=function(e,t){var o=e,n="string"==typeof o?o.toLowerCase():null;return function(e){for(var i=!1,r=0,s=e.length;r<s;r++){if(o===e[r]){i=!0;break}if(n===e[r].toLowerCase()){i=!0;break}}t(i)}};o.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,a(e,t)):a(e,t)(this.source):t(!0)},o.AutocompleteCell={editor:o.editors.AutocompleteEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.CheckboxCell={editor:o.editors.CheckboxEditor,renderer:o.renderers.CheckboxRenderer},o.TextCell={editor:o.editors.TextEditor,renderer:o.renderers.TextRenderer},o.NumericCell={editor:o.editors.TextEditor,renderer:o.renderers.NumericRenderer,validator:o.NumericValidator,dataType:"number"},o.DateCell={editor:o.editors.DateEditor,renderer:o.renderers.AutocompleteRenderer},o.HandsontableCell={editor:o.editors.HandsontableEditor,renderer:o.renderers.AutocompleteRenderer},o.PasswordCell={editor:o.editors.PasswordEditor,renderer:o.renderers.PasswordRenderer,copyable:!1},o.DropdownCell={editor:o.editors.DropdownEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.cellTypes={text:o.TextCell,date:o.DateCell,numeric:o.NumericCell,checkbox:o.CheckboxCell,autocomplete:o.AutocompleteCell,handsontable:o.HandsontableCell,password:o.PasswordCell,dropdown:o.DropdownCell},o.cellLookup={validator:{numeric:o.NumericValidator,autocomplete:o.AutocompleteValidator}};var c=function(){var e,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},i=document.body,r=document.createTextNode(""),s=document.createElement("SPAN"),l=function(e,o,n){t.attachEvent?e.attachEvent("on"+o,n):e.addEventListener(o,n,!1)},a=function(e,o,n){t.detachEvent?e.detachEvent("on"+o,n):e.removeEventListener(o,n,!1)},c=function(){void 0!==r.textContent?r.textContent=e.value:r.data=e.value,s.style.fontSize=o.Dom.getComputedStyle(e).fontSize,s.style.fontFamily=o.Dom.getComputedStyle(e).fontFamily,i.appendChild(s);var t=s.clientWidth;i.removeChild(s),e.style.height=n.minHeight+"px",n.minWidth>t?e.style.width=n.minWidth+"px":t>n.maxWidth?e.style.width=n.maxWidth+"px":e.style.width=t+"px";var l=e.scrollHeight;n.minHeight>l?e.style.height=n.minHeight+"px":n.maxHeight<l?(e.style.height=n.maxHeight+"px",e.style.overflowY="visible"):e.style.height=l+"px"},h=function(){t.setTimeout(c,0)};return{init:function(t,o){!function(t,o){e=t,function(t){if(t&&t.minHeight)if("inherit"==t.minHeight)n.minHeight=e.clientHeight;else{var o=parseInt(t.minHeight);isNaN(o)||(n.minHeight=o)}if(t&&t.maxHeight)if("inherit"==t.maxHeight)n.maxHeight=e.clientHeight;else{var i=parseInt(t.maxHeight);isNaN(i)||(n.maxHeight=i)}if(t&&t.minWidth)if("inherit"==t.minWidth)n.minWidth=e.clientWidth;else{var l=parseInt(t.minWidth);isNaN(l)||(n.minWidth=l)}if(t&&t.maxWidth)if("inherit"==t.maxWidth)n.maxWidth=e.clientWidth;else{var a=parseInt(t.maxWidth);isNaN(a)||(n.maxWidth=a)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(r))}(o),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=n.minHeight+"px",e.style.minWidth=n.minWidth+"px",e.style.maxWidth=n.maxWidth+"px",e.style.overflowY="hidden"),l(e,"change",c),l(e,"cut",h),l(e,"paste",h),l(e,"drop",h),l(e,"keydown",h),c()}(t,o)},unObserve:function(){a(e,"change",c),a(e,"cut",h),a(e,"paste",h),a(e,"drop",h),a(e,"keydown",h)}}};!function(e){function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var o,n,i,r,s,l,a,c=[],h=0;for((i=e.split("\n")).length>1&&""===i[i.length-1]&&i.pop(),o=0,n=i.length;o<n;o+=1){for(i[o]=i[o].split("\t"),r=0,s=i[o].length;r<s;r+=1)c[h]||(c[h]=[]),l&&0===r?(a=c[h].length-1,c[h][a]=c[h][a]+"\n"+i[o][0],l&&1&t(i[o][0])&&(l=!1,c[h][a]=c[h][a].substring(0,c[h][a].length-1).replace(/""/g,'"'))):r===s-1&&0===i[o][r].indexOf('"')?(c[h].push(i[o][r].substring(1).replace(/""/g,'"')),l=!0):(c[h].push(i[o][r].replace(/""/g,'"')),l=!1);l||(h+=1)}return c},stringify:function(e){var t,o,n,i,r,s="";for(t=0,o=e.length;t<o;t+=1){for(n=0,i=e[t].length;n<i;n+=1)n>0&&(s+="\t"),"string"==typeof(r=e[t][n])?r.indexOf("\n")>-1?s+='"'+r.replace(/"/g,'""')+'"':s+=r:s+=null==r?"":r;t<o-1&&(s+="\n")}return s}}}(t);var h,u=function(){var e;return{getInstance:function(){return e?e.hasBeenDestroyed()&&e.init():e=new d,e.refCounter++,e}}}();function d(){this.refCounter=0,this.init()}d.prototype.init=function(){var e,t,o=this;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this.listenerElement=document.documentElement,t=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",(e=this.elDiv.style).position="fixed",e.top="-10000px",e.left="-10000px",t.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",(e=this.elTextarea.style).width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),void 0!==e.opacity&&(e.opacity=0)),this.keydownListener=function(e){var t=!1;if((e.metaKey||e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac"))&&(t=!0),t){if(document.activeElement!==o.elTextarea&&(""!=o.getSelectionText()||-1!=["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;o.selectNodeText(o.elTextarea),setTimeout((function(){o.selectNodeText(o.elTextarea)}),0)}!t||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout((function(){o.triggerCut(e)}),0):86===e.keyCode&&setTimeout((function(){o.triggerPaste(e)}),0))},this._bindEvent(this.listenerElement,"keydown",this.keydownListener)},d.prototype.selectNodeText=function(e){e.select()},d.prototype.getSelectionText=function(){var e="";return t.getSelection?e=t.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),e},d.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e},d.prototype.onCut=function(e){this.cutCallbacks.push(e)},d.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},d.prototype.removeCallback=function(e){var t,o;for(t=0,o=this.copyCallbacks.length;t<o;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,o=this.cutCallbacks.length;t<o;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,o=this.pasteCallbacks.length;t<o;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},d.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout((function(){for(var o=0,n=t.cutCallbacks.length;o<n;o++)t.cutCallbacks[o](e)}),50)},d.prototype.triggerPaste=function(e,t){var o=this;o.pasteCallbacks&&setTimeout((function(){for(var n=(t||o.elTextarea.value).replace(/\n$/,""),i=0,r=o.pasteCallbacks.length;i<r;i++)o.pasteCallbacks[i](n,e)}),50)},d.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),this._unbindEvent(this.listenerElement,"keydown",this.keydownListener))},d.prototype.hasBeenDestroyed=function(){return!this.refCounter},d.prototype._bindEvent=t.jQuery?function(t,o,n){e(t).on(o+".copypaste",n)}:function(e,t,o){e.addEventListener(t,o,!1)},d.prototype._unbindEvent=t.jQuery?function(t,o,n){e(t).off(o+".copypaste",n)}:function(e,t,o){e.removeEventListener(t,o,!1)},function(e){var o={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,o){var n={op:"_get",path:this.from};return v(o,[n]),v(o,[{op:"remove",path:this.from}]),v(o,[{op:"add",path:this.path,value:n.value}]),!0},copy:function(e,t,o){var n={op:"_get",path:this.from};return v(o,[n]),v(o,[{op:"add",path:this.path,value:n.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},n={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:o.move,copy:o.copy,test:o.test,_get:o._get},i={add:function(e,t){var o={op:"add",path:t+r(this.name),value:this.object[this.name]};e.push(o)},delete:function(e,t){var o={op:"remove",path:t+r(this.name)};e.push(o)},update:function(e,t){var o={op:"replace",path:t+r(this.name),value:this.object[this.name]};e.push(o)}};function r(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function s(e,t){var o;for(var n in e)if(e.hasOwnProperty(n)){if(e[n]===t)return r(n)+"/";if("object"==typeof e[n]&&""!=(o=s(e[n],t)))return r(n)+"/"+o}return""}function l(e,t){if(e===t)return"/";var o=s(e,t);if(""===o)throw new Error("Object not found in root");return"/"+o}var a=[];e.intervals;var c,h,u=function(e){this.observers=[],this.obj=e},d=function(e,t){this.callback=e,this.observer=t};function f(e){for(var t=0,o=a.length;t<o;t++)if(a[t].obj===e)return a[t]}function p(e,t){if(Object.observe)for(var o in Object.observe(t,e),t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&p(e,n)}return e}function g(e,t){if(Object.observe)for(var o in Object.unobserve(t,e),t)if(t.hasOwnProperty(o)){var n=t[o];n&&"object"==typeof n&&g(e,n)}return e}function m(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,o=0,n=a.length;o<n;o++)if(a[o].obj===e.object){t=a[o];break}w(t.value,e.object,e.patches,"")}var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function w(e,t,o,n){for(var i=c(t),s=c(e),l=!1,a=s.length-1;a>=0;a--){var h=e[d=s[a]];if(t.hasOwnProperty(d)){var u=t[d];h instanceof Object?w(h,u,o,n+"/"+r(d)):h!=u&&(o.push({op:"replace",path:n+"/"+r(d),value:u}),e[d]=u)}else o.push({op:"remove",path:n+"/"+r(d)}),delete e[d],l=!0}if(l||i.length!=s.length)for(a=0;a<i.length;a++){var d=i[a];e.hasOwnProperty(d)||(o.push({op:"add",path:n+"/"+r(d),value:t[d]}),e[d]=JSON.parse(JSON.stringify(t[d])))}}function v(e,t){for(var i,r=!1,s=0,l=t.length;s<l;){for(var a=(i=t[s]).path.split("/"),c=e,u=1,d=a.length;;)if(h(c)){var f=parseInt(a[u],10);if(++u>=d){r=n[i.op].call(i,c,f,e);break}c=c[f]}else{var p=a[u];if(-1!=p.indexOf("~")&&(p=p.replace(/~1/g,"/").replace(/~0/g,"~")),++u>=d){r=o[i.op].call(i,c,p,e);break}c=c[p]}s++}return r}e.unobserve=function(e,t){m(t),Object.observe?g(t,e):clearTimeout(t.next),function(e,t){for(var o=0,n=e.observers.length;o<n;o++)if(e.observers[o].observer===t)return void e.observers.splice(o,1)}(f(e),t)},e.observe=function(e,o){var n,r=[],s=e,c=f(e);if(c?n=function(e,t){for(var o=0,n=e.observers.length;o<n;o++)if(e.observers[o].callback===t)return e.observers[o].observer}(c,o):(c=new u(e),a.push(c)),n)return n;if(Object.observe)n=function(t){g(n,e),p(n,e);for(var a=0,c=t.length;a<c;){if(("length"!==t[a].name||!h(t[a].object))&&"__Jasmine_been_here_before__"!==t[a].name){var u=t[a].type;switch(u){case"new":u="add";break;case"deleted":u="delete";break;case"updated":u="update"}i[u].call(t[a],r,l(s,t[a].object))}a++}r&&o&&o(r),n.patches=r,r=[]};else if(n={},c.value=JSON.parse(JSON.stringify(e)),o){n.callback=o,n.next=null;var w=this.intervals||[100,1e3,1e4,6e4],v=0,y=function(){m(n)},C=function(){clearTimeout(n.next),n.next=setTimeout((function(){y(),v=0,n.next=setTimeout(b,w[v++])}),0)},b=function(){y(),v==w.length&&(v=w.length-1),n.next=setTimeout(b,w[v++])};void 0!==t&&(t.addEventListener?(t.addEventListener("mousedown",C),t.addEventListener("mouseup",C),t.addEventListener("keydown",C)):(t.attachEvent("onmousedown",C),t.attachEvent("onmouseup",C),t.attachEvent("onkeydown",C))),n.next=setTimeout(b,w[v++])}return n.patches=r,n.object=e,c.observers.push(new d(o,n)),p(n,e)},e.generate=m,c=Object.keys?Object.keys:function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t},h=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=v}(h||(h={})),"undefined"!=typeof exports&&(exports.apply=h.apply,exports.observe=h.observe,exports.unobserve=h.unobserve,exports.generate=h.generate),o.PluginHookClass=function(){var e=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeCopy:[],beforeRender:[],beforeSetRangeEnd:[],beforeDrawBorders:[],beforeChange:[],beforeChangeRender:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeOnCellMouseDown:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterSetCellMeta:[],afterGetColHeader:[],afterGetRowHeader:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],afterCellMetaReset:[],afterIsMultipleSelectionCheck:[],afterDocumentKeyDown:[],modifyColWidth:[],modifyRowHeight:[],modifyRow:[],modifyCol:[]}},t={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};function n(){this.hooks=e(),this.globalBucket={},this.legacy=t}return n.prototype.getBucket=function(e){return e?(e.pluginHookBucket||(e.pluginHookBucket={}),e.pluginHookBucket):this.globalBucket},n.prototype.add=function(e,n,i){if(o.helper.isArray(n))for(var r=0,s=n.length;r<s;r++)this.add(e,n[r]);else{e in t&&(e=t[e]);var l=this.getBucket(i);void 0===l[e]&&(l[e]=[]),n.skip=!1,-1==l[e].indexOf(n)&&l[e].push(n)}return this},n.prototype.once=function(e,t,n){if(o.helper.isArray(t))for(var i=0,r=t.length;i<r;i++)t[i].runOnce=!0,this.add(e,t[i],n);else t.runOnce=!0,this.add(e,t,n)},n.prototype.remove=function(e,o,n){var i=!1;e in t&&(e=t[e]);var r=this.getBucket(n);if(void 0!==r[e])for(var s=0,l=r[e].length;s<l;s++)if(r[e][s]==o){r[e][s].skip=!0,i=!0;break}return i},n.prototype.run=function(e,o,n,i,r,s,l,a){o in t&&(o=t[o]),this._runBucket(this.globalBucket,e,o,n,i,r,s,l,a),this._runBucket(this.getBucket(e),e,o,n,i,r,s,l,a)},n.prototype._runBucket=function(e,t,o,n,i,r,s,l,a){var c=e[o];if(c)for(var h=0,u=c.length;h<u;h++)c[h].skip||(c[h].call(t,n,i,r,s,l,a),c[h].runOnce&&this.remove(o,c[h],e===this.globalBucket?null:t))},n.prototype.destroy=function(e){var t=this.getBucket(e);for(var o in t)if(t.hasOwnProperty(o))for(var n=0,i=t[o].length;n<i;n++)this.remove(o,t[o],e)},n.prototype.execute=function(e,o,n,i,r,s,l,a){return o in t&&(o=t[o]),n=this._executeBucket(this.globalBucket,e,o,n,i,r,s,l,a),this._executeBucket(this.getBucket(e),e,o,n,i,r,s,l,a)},n.prototype._executeBucket=function(e,t,o,n,i,r,s,l,a){var c,h=e[o];if(h)for(var u=0,d=h.length;u<d;u++)if(!h[u].skip&&(void 0!==(c=h[u].call(t,n,i,r,s,l,a))&&(n=c),h[u].runOnce&&this.remove(o,h[u],e===this.globalBucket?null:t),!1===c))return!1;return n},n.prototype.register=function(e){this.isRegistered(e)||(this.hooks[e]=[])},n.prototype.deregister=function(e){delete this.hooks[e]},n.prototype.isRegistered=function(e){return void 0!==this.hooks[e]},n.prototype.getRegistered=function(){return Object.keys(this.hooks)},n}(),o.hooks=new o.PluginHookClass,o.PluginHooks=o.hooks,function(e){var t=new function(){var o=this;function n(e){var t=document,o=this;o.table=t.createElement("table"),o.theadTh=t.createElement("th"),o.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(o.theadTh),o.tableStyle=o.table.style,o.tableStyle.tableLayout="auto",o.tableStyle.width="auto",o.tbody=t.createElement("tbody"),o.table.appendChild(o.tbody),o.container=t.createElement("div"),o.container.className=e.rootElement[0].className+" hidden",o.containerStyle=o.container.style,o.container.appendChild(o.table)}this.beforeInit=function(){var e=this;e.autoColumnWidths=[],!1!==e.getSettings().autoColumnSize?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",t.determineIfChanged),e.addHook("modifyColWidth",t.modifyColWidth),e.addHook("afterDestroy",t.afterDestroy),e.determineColumnWidth=o.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",t.determineIfChanged),e.removeHook("modifyColWidth",t.modifyColWidth),e.removeHook("afterDestroy",t.afterDestroy),delete e.determineColumnWidth,o.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&t.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(t){var o=this,i=o.autoColumnSizeTmp;i.container||n.call(i,o),i.container.className=o.rootElement[0].className+" htAutoColumnSize",i.table.className=o.$table[0].className;for(var r=o.countRows(),s={},l=0,a=0;a<r;a++){var c=e.helper.stringify(o.getDataAtCell(a,t)),h=c.length;h>l&&(l=h),s[h]||(s[h]={needed:5,strings:[]}),s[h].needed&&(s[h].strings.push({value:c,row:a}),s[h].needed--)}var u=o.getSettings();for(var d in u.colHeaders&&o.view.appendColHeader(t,i.theadTh),e.Dom.empty(i.tbody),s)if(s.hasOwnProperty(d))for(var f=0,p=s[d].strings.length;f<p;f++){var g=s[d].strings[f].row,m=o.getCellMeta(g,t);m.col=t,m.row=g;var w=o.getCellRenderer(m),v=document.createElement("tr"),y=document.createElement("td");w(o,y,g,t,o.colToProp(t),s[d].strings[f].value,m),a++,v.appendChild(y),i.tbody.appendChild(v)}var C=o.rootElement[0].parentNode;C.appendChild(i.container);var b=e.Dom.outerWidth(i.table);return C.removeChild(i.container),b},this.determineColumnsWidth=function(){var e=this.getSettings();if(e.autoColumnSize||!e.colWidths)for(var t=this.countCols(),n=0;n<t;n++)this._getColWidthFromSettings(n)||(this.autoColumnWidths[n]=o.determineColumnWidth.call(this,n))},this.modifyColWidth=function(e,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e?this.autoColumnWidths[t]:e},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}};e.hooks.add("beforeInit",t.beforeInit),e.hooks.add("afterUpdateSettings",t.beforeInit)}(o);var f=new function(){var e=this;this.init=function(t){var o,s,l=this,a=l.getSettings().columnSorting;if(l.sortingEnabled=!!a,l.sortingEnabled){l.sortIndex=[];var c=n.call(l);void 0!==c?(o=c.sortColumn,s=c.sortOrder):(o=a.column,s=a.sortOrder),e.sortByColumn.call(l,o,s),l.sort=function(){var t=Array.prototype.slice.call(arguments);return e.sortByColumn.apply(l,t)},void 0===l.getSettings().observeChanges&&r.call(l),"afterInit"==t&&(i.call(l),l.addHook("afterCreateRow",e.afterCreateRow),l.addHook("afterRemoveRow",e.afterRemoveRow),l.addHook("afterLoadData",e.init))}else delete l.sort,l.removeHook("afterCreateRow",e.afterCreateRow),l.removeHook("afterRemoveRow",e.afterRemoveRow),l.removeHook("afterLoadData",e.init)},this.setSortingColumn=function(e,t){var o=this;if(void 0===e)return delete o.sortColumn,void delete o.sortOrder;o.sortColumn===e&&void 0===t?o.sortOrder=!o.sortOrder:o.sortOrder=void 0===t||t,o.sortColumn=e},this.sortByColumn=function(n,i){var r=this;e.setSortingColumn.call(r,n,i),void 0!==r.sortColumn&&(o.hooks.run(r,"beforeColumnSort",r.sortColumn,r.sortOrder),e.sort.call(r),r.render(),t.call(r),o.hooks.run(r,"afterColumnSort",r.sortColumn,r.sortOrder))};var t=function(){var e=this,t={};void 0!==e.sortColumn&&(t.sortColumn=e.sortColumn),void 0!==e.sortOrder&&(t.sortOrder=e.sortOrder),(t.hasOwnProperty("sortColumn")||t.hasOwnProperty("sortOrder"))&&o.hooks.run(e,"persistentStateSave","columnSorting",t)},n=function(){var e={};return o.hooks.run(this,"persistentStateLoad","columnSorting",e),e.value},i=function(){var t=this;t.rootElement.on("click.handsontable",".columnSorting",(function(n){var i,r,s=(i=n.target,r=o.Dom.closest(i,"TH"),o.Dom.index(r)-t.view.TBODY.querySelector("tr").querySelectorAll("th").length);e.sortByColumn.call(t,s)}))};function r(){var e=this;e._registerTimeout(setTimeout((function(){e.updateSettings({observeChanges:!0})}),0))}function s(e){return function(t,o){return"string"==typeof t[1]&&(t[1]=t[1].toLowerCase()),"string"==typeof o[1]&&(o[1]=o[1].toLowerCase()),t[1]===o[1]?0:null===t[1]||""===t[1]?1:null===o[1]||""===o[1]?-1:t[1]<o[1]?e?-1:1:t[1]>o[1]?e?1:-1:0}}function l(e){return function(t,o){if(t[1]===o[1])return 0;if(null===t[1])return 1;if(null===o[1])return-1;var n=new Date(t[1]),i=new Date(o[1]);return n<i?e?-1:1:n>i?e?1:-1:0}}function a(e){return void 0!==e.sortColumn}this.sort=function(){var e=this;if(void 0!==e.sortOrder){e.sortingEnabled=!1,e.sortIndex.length=0;for(var t=this.colOffset(),o=0,n=this.countRows()-e.getSettings().minSpareRows;o<n;o++)this.sortIndex.push([o,e.getDataAtCell(o,this.sortColumn+t)]);var i;for(i="date"===e.getCellMeta(0,e.sortColumn).type?l:s,this.sortIndex.sort(i(e.sortOrder)),o=this.sortIndex.length;o<e.countRows();o++)this.sortIndex.push([o,e.getDataAtCell(o,this.sortColumn+t)]);e.sortingEnabled=!0}},this.translateRow=function(e){var t=this;return t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]?t.sortIndex[e][0]:e},this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length)for(var o=0;o<t.sortIndex.length;o++)if(t.sortIndex[o][0]==e)return o},this.getColHeader=function(e,t){this.getSettings().columnSorting&&e>=0&&o.Dom.addClass(t.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(e,o){var n=this;if(a(n)){for(var i=0;i<n.sortIndex.length;i++)n.sortIndex[i][0]>=e&&(n.sortIndex[i][0]+=o);for(i=0;i<o;i++)n.sortIndex.splice(e+i,0,[e+i,n.getData()[e+i][n.sortColumn+n.colOffset()]]);t.call(n)}},this.afterRemoveRow=function(o,n){var i=this;if(a(i)){var r=e.translateRow.call(i,o);i.sortIndex.splice(o,n);for(var s=0;s<i.sortIndex.length;s++)i.sortIndex[s][0]>r&&(i.sortIndex[s][0]-=n);t.call(i)}},this.afterChangeSort=function(t){var o=this,n=!1,i={};if(t){for(var r=0;r<t.length;r++)if(t[r][1]==o.sortColumn){n=!0,i.row=e.translateRow.call(o,t[r][0]),i.col=t[r][1];break}n&&o._registerTimeout(setTimeout((function(){e.sort.call(o),o.render(),o.selectCell(e.untranslateRow.call(o,i.row),i.col)}),0))}}};function p(t){var n=function(){var e=r();e.style.display="none",e.value=""},i=function(){e(document).off("mousedown.htCommment"),e(document).on("mouseover.htCommment",o.helper.proxy(s))},r=function(e){var t=document.getElementsByClassName("htComments")[0];if(!t){t=document.createElement("DIV");var n=document.createElement("TEXTAREA");o.Dom.addClass(n,"htCommentTextArea"),t.appendChild(n),o.Dom.addClass(t,"htComments"),document.getElementsByTagName("body")[0].appendChild(t)}return e=e||"",document.getElementsByClassName("htCommentTextArea")[0].value=e,t},s=function(e){if(-1!=e.target.className.indexOf("htCommentCell")){i();var r=t.view.wt.wtTable.getCoords(e.target),s={from:new M(r.row,r.col)};o.Comments.showComment(s)}else"htCommentTextArea"!=e.target.className&&n()};return{init:function(){e(document).on("mouseover.htCommment",o.helper.proxy(s))},showComment:function(s){var l=t.getCellMeta(s.from.row,s.from.col),a="";l.comment&&(a=l.comment);var c=r(a);c.style.display="block",function(r,s){var l=t.view.wt.wtTable.getCell(r.from),a=o.Dom.offset(l),c=t.getColWidth(r.from.col);s.style.position="absolute",s.style.left=a.left+c+"px",s.style.top=a.top+"px",s.style.zIndex=2,function(r){e(document).on("mousedown.htCommment",o.helper.proxy((function(o){if(e(document).off("mouseover.htCommment"),"htCommentTextArea"!=o.target.className&&-1==o.target.innerHTML.indexOf("Comment")){var s=document.getElementsByClassName("htCommentTextArea")[0].value;s.trim().length>1&&function(e,t,o){!function(e,t,o,n){n.setCellMeta(e,t,"comment",o),n.render()}(e.from.row,e.from.col,t,o)}(r,s,t),i(),n()}})))}(r)}(s,c)},removeComment:function(e,o){t.removeCellMeta(e,o,"comment"),t.render()},checkSelectionCommentsConsistency:function(){var e=!1,o=t.getSelectedRange().from;return t.getCellMeta(o.row,o.col).comment&&(e=!0),e}}}o.hooks.add("afterInit",(function(){f.init.call(this,"afterInit")})),o.hooks.add("afterUpdateSettings",(function(){f.init.call(this,"afterUpdateSettings")})),o.hooks.add("modifyRow",f.translateRow),o.hooks.add("afterGetColHeader",f.getColHeader),o.hooks.register("beforeColumnSort"),o.hooks.register("afterColumnSort"),function(t){function o(e,t,o,n){var i=this.getCellMeta(e,t),r=n;i.className&&(r="vertical"===o?function(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+t)}(i.className,n):function(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+t)}(i.className,n)),this.setCellMeta(e,t,"className",r),this.render()}function n(e,t,n){if(e.from.row==e.to.row&&e.from.col==e.to.col)o.call(this,e.from.row,e.from.col,t,n);else for(var i=e.from.row;i<=e.to.row;i++)for(var r=e.from.col;r<=e.to.col;r++)o.call(this,i,r,t,n)}function i(e,o){this.instance=e;var r=this;r.menus=[],r.triggerRows=[],this.enabled=!0,this.instance.addHook("afterDestroy",(function(){r.destroy()})),this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]].join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||t}},{key:"row_below",name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]].join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||t}},i.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1].join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||t}},{key:"col_right",name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1].join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||t}},i.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(e,t){var o=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,o)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.view.wt.wtTable.getRowStrategy().cellCount-1,e[1]].join(",")==e.join(",");return e[0]<0||t}},{key:"remove_col",name:"Remove column",callback:function(e,t){var o=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,o)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.view.wt.wtTable.getColumnStrategy().cellCount-1].join(",")==e.join(",");return e[1]<0||t}},i.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},i.SEPARATOR,{key:"make_read_only",name:function(){var e="Read only";return r.checkSelectionReadOnlyConsistency(this)&&(e=r.markSelected(e)),e},callback:function(){var e=r.checkSelectionReadOnlyConsistency(this),t=this;this.getSelectedRange().forAll((function(o,n){t.getCellMeta(o,n).readOnly=!e})),this.render()}},i.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var e="Left";return r.checkSelectionAlignment(this,"htLeft")&&(e=r.markSelected(e)),e},callback:function(){n.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},{name:function(){var e="Center";return r.checkSelectionAlignment(this,"htCenter")&&(e=r.markSelected(e)),e},callback:function(){n.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},{name:function(){var e="Right";return r.checkSelectionAlignment(this,"htRight")&&(e=r.markSelected(e)),e},callback:function(){n.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},{name:function(){var e="Justify";return r.checkSelectionAlignment(this,"htJustify")&&(e=r.markSelected(e)),e},callback:function(){n.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},i.SEPARATOR,{name:function(){var e="Top";return r.checkSelectionAlignment(this,"htTop")&&(e=r.markSelected(e)),e},callback:function(){n.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},{name:function(){var e="Middle";return r.checkSelectionAlignment(this,"htMiddle")&&(e=r.markSelected(e)),e},callback:function(){n.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:!1},{name:function(){var e="Bottom";return r.checkSelectionAlignment(this,"htBottom")&&(e=r.markSelected(e)),e},callback:function(){n.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}]}}]},r.options={},t.helper.extend(r.options,this.options),this.bindMouseEvents(),this.markSelected=function(e){return"<span class='selected'>✓</span>"+e},this.checkSelectionAlignment=function(e,t){var o=!1;return e.getSelectedRange().forAll((function(n,i){var r=e.getCellMeta(n,i).className;if(r&&-1!=r.indexOf(t))return o=!0,!1})),o},this.checkSelectionReadOnlyConsistency=function(e){var t=!1;return e.getSelectedRange().forAll((function(o,n){if(e.getCellMeta(o,n).readOnly)return t=!0,!1})),t},t.hooks.run(e,"afterContextMenuDefaultOptions",this.defaultOptions)}function r(e,t){for(var o=0,n=e.length;o<n;o++)if(e[o].key===t)return e[o]}function s(){var e=this,o=e.getSettings().contextMenu,n=t.helper.isObject(o)?o:{};o?(e.contextMenu||(e.contextMenu=new i(e,n)),e.contextMenu.enable()):e.contextMenu&&(e.contextMenu.destroy(),delete e.contextMenu)}i.prototype.createMenu=function(o,n){var i;return o&&(o="htContextSubMenu_"+(o=o.replace(/ /g,"_"))),(i=o?e("body > .htContextMenu."+o)[0]:e("body > .htContextMenu")[0])||(i=document.createElement("DIV"),t.Dom.addClass(i,"htContextMenu"),o&&t.Dom.addClass(i,o),document.getElementsByTagName("body")[0].appendChild(i)),this.menus.indexOf(i)<0&&(this.menus.push(i),n=n||0,this.triggerRows.push(n)),i},i.prototype.bindMouseEvents=function(){this.instance.rootElement.on("contextmenu.htContextMenu",t.helper.proxy((function(o){var n=this.instance.getSettings();this.closeAll(),o.preventDefault(),o.stopPropagation();var r=this.instance.getSettings().rowHeaders,s=this.instance.getSettings().colHeaders;if(r||s||"TD"==o.target.nodeName||t.Dom.hasClass(o.target,"current")&&t.Dom.hasClass(o.target,"wtBorder")){var l=this.createMenu(),a=this.getItems(n.contextMenu);this.show(l,a),this.setMenuPosition(o,l),e(document).on("mousedown.htContextMenu",t.helper.proxy(i.prototype.closeAll,this))}}),this))},i.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},i.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},i.prototype.performAction=function(t,o){var n=e(o).handsontable("getInstance"),r=n.getSelected()[0],s=n.getData()[r];if(!0!==s.disabled&&("function"!=typeof s.disabled||!0!==s.disabled.call(this.instance))&&!s.hasOwnProperty("submenu")){if("function"!=typeof s.callback)return;var l=this.instance.getSelectedRange(),a=i.utils.normalizeSelection(l);s.callback.call(this.instance,s.key,a,t),this.closeAll()}},i.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu"),e(document).off("mousedown.htContextMenu")},i.prototype.show=function(o,n){o.removeAttribute("style"),o.style.display="block";var i=this;e(o).off("mousedown.htContextMenu").on("mousedown.htContextMenu",(function(e){i.performAction(e,o)})),e(o).handsontable({data:n,colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:t.helper.proxy(this.renderer,this)}],beforeKeyDown:function(e){i.onBeforeKeyDown(e,o)},afterOnCellMouseOver:function(e,t,n){i.onCellMouseOver(e,t,n,o)},renderAllRows:!0}),this.bindTableEvents(),e(o).handsontable("listen")},i.prototype.close=function(t){this.hide(t),e(document).off("mousedown.htContextMenu"),this.unbindTableEvents(),this.instance.listen()},i.prototype.closeAll=function(){for(;this.menus.length>0;){var e=this.menus.pop();e&&this.close(e)}this.triggerRows=[]},i.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();e&&this.hide(e)},i.prototype.hide=function(t){t.style.display="none",e(t).handsontable("destroy")},i.prototype.renderer=function(o,n,r,s,l,a){var c=this,h=o.getData()[r],u=document.createElement("DIV");"function"==typeof a&&(a=a.call(this.instance)),t.Dom.empty(n),n.appendChild(u),function(e){return new RegExp(i.SEPARATOR.name,"i").test(e.name)}(h)?t.Dom.addClass(n,"htSeparator"):t.Dom.fastInnerHTML(u,a),function(e){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(c.instance)}(h)?(t.Dom.addClass(n,"htDisabled"),e(u).on("mouseenter",(function(){o.deselectCell()}))):function(e){return e.hasOwnProperty("submenu")}(h)?(t.Dom.addClass(n,"htSubmenu"),e(u).on("mouseenter",(function(){o.selectCell(r,s)}))):(t.Dom.removeClass(n,"htSubmenu"),t.Dom.removeClass(n,"htDisabled"),e(u).on("mouseenter",(function(){o.selectCell(r,s)})))},i.prototype.onCellMouseOver=function(t,o,n,i){var r=e(i).handsontable("getInstance"),s=this.menus.length;if(s>0?this.menus[s-1].id!=i.id&&this.closeLastOpenedSubMenu():this.closeLastOpenedSubMenu(),-1!=n.className.indexOf("htSubmenu")){var l=r.getData()[o.row],a=this.getItems(l.submenu),c=this.createMenu(l.name,o.row),h=n.getBoundingClientRect();this.show(c,a),this.setSubMenuPosition(h,c)}},i.prototype.onBeforeKeyDown=function(o,n){var r=this,s=e(n).handsontable("getInstance"),l=s.getSelected();switch(o.keyCode){case t.helper.keyCode.ESCAPE:r.closeAll(),o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ENTER:l&&r.performAction(o,n);break;case t.helper.keyCode.ARROW_DOWN:l?d(l[0],l[1],s):function(e){var t=e.getCell(0,0);i.utils.isSeparator(t)||i.utils.isDisabled(t)?d(0,0,e):e.selectCell(0,0)}(s),o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_UP:l?f(l[0],l[1],s):function(e){var t=e.countRows()-1,o=e.getCell(t,0);i.utils.isSeparator(o)||i.utils.isDisabled(o)?f(t,0,e):e.selectCell(t,0)}(s),o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_RIGHT:if(l){var a=l[0],c=s.getCell(l[0],0);i.utils.hasSubMenu(c)&&function(t,o,n,i){var r=t.getData()[i],s=o.getItems(r.submenu),l=o.createMenu(r.name,i),a=n.getBoundingClientRect();o.show(l,s),o.setSubMenuPosition(a,l),e(l).handsontable("getInstance").selectCell(0,0)}(s,r,c,a)}o.preventDefault(),o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_LEFT:if(l){if(-1!=n.className.indexOf("htContextSubMenu_")){r.closeLastOpenedSubMenu();var h=r.menus.length;if(h>0){n=r.menus[h-1];var u=r.triggerRows.pop();(s=e(n).handsontable("getInstance")).selectCell(u,0)}}o.preventDefault(),o.stopImmediatePropagation()}}function d(e,t,o){var n=e+1,r=n<o.countRows()?o.getCell(n,t):null;r&&(i.utils.isSeparator(r)||i.utils.isDisabled(r)?d(n,t,o):o.selectCell(n,t))}function f(e,t,o){var n=e-1,r=n>=0?o.getCell(n,t):null;r&&(i.utils.isSeparator(r)||i.utils.isDisabled(r)?f(n,t,o):o.selectCell(n,t))}},i.prototype.getItems=function(e){var o,n;function i(e){"string"==typeof e?this.name=e:t.helper.extend(this,e)}for(var s in i.prototype=e,e&&e.items&&(e=e.items),!0===e&&(e=this.defaultOptions.items),o=[],e)e.hasOwnProperty(s)&&((n="string"==typeof e[s]?r(this.defaultOptions.items,e[s]):r(this.defaultOptions.items,s))||(n=e[s]),n=new i(n),"object"==typeof e[s]&&t.helper.extend(n,e[s]),n.key||(n.key=s),o.push(n));return o},i.prototype.setSubMenuPosition=function(e,o){var n=t.Dom.getWindowScrollTop(),i=t.Dom.getWindowScrollLeft(),r={top:n+e.top,topRelative:e.top,left:e.left,leftRelative:e.left-i,scrollTop:n,scrollLeft:i,cellHeight:e.height,cellWidth:e.width};this.menuFitsBelowCursor(r,o)?this.positionMenuBelowCursor(r,o,!0):this.menuFitsAboveCursor(r,o)?this.positionMenuAboveCursor(r,o,!0):this.positionMenuBelowCursor(r,o,!0),this.menuFitsOnRightOfCursor(r,o)?this.positionMenuOnRightOfCursor(r,o,!0):this.positionMenuOnLeftOfCursor(r,o,!0)},i.prototype.setMenuPosition=function(e,o){var n=e.pageY,i=e.pageX,r=t.Dom.getWindowScrollTop(),s=t.Dom.getWindowScrollLeft(),l={top:n,topRelative:n-r,left:i,leftRelative:i-s,scrollTop:r,scrollLeft:s,cellHeight:e.target.clientHeight,cellWidth:e.target.clientWidth};this.menuFitsBelowCursor(l,o)?this.positionMenuBelowCursor(l,o):this.menuFitsAboveCursor(l,o)?this.positionMenuAboveCursor(l,o):this.positionMenuBelowCursor(l,o),this.menuFitsOnRightOfCursor(l,o)?this.positionMenuOnRightOfCursor(l,o):this.positionMenuOnLeftOfCursor(l,o)},i.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight},i.prototype.menuFitsBelowCursor=function(e,t){return e.topRelative+t.offsetHeight<=e.scrollTop+document.body.clientHeight},i.prototype.menuFitsOnRightOfCursor=function(e,t){return e.leftRelative+t.offsetWidth<=e.scrollLeft+document.body.clientWidth},i.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"},i.prototype.positionMenuAboveCursor=function(e,t,o){t.style.top=o?e.top+e.cellHeight-t.offsetHeight+"px":e.top-t.offsetHeight+"px"},i.prototype.positionMenuOnRightOfCursor=function(e,t,o){t.style.left=o?1+e.left+e.cellWidth+"px":1+e.left+"px"},i.prototype.positionMenuOnLeftOfCursor=function(e,t,o){t.style.left=e.left-t.offsetWidth+"px"},i.utils={},i.utils.normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}},i.utils.isSeparator=function(e){return t.Dom.hasClass(e,"htSeparator")},i.utils.hasSubMenu=function(e){return t.Dom.hasClass(e,"htSubmenu")},i.utils.isDisabled=function(e){return t.Dom.hasClass(e,"htDisabled")},i.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},i.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())},i.prototype.destroy=function(){for(this.closeAll();this.menus.length>0;){var e=this.menus.pop();this.triggerRows.pop(),e&&(this.close(e),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(e))}this.unbindMouseEvents(),this.unbindTableEvents()},i.prototype.isMenuEnabledByOtherHotInstance=function(){for(var t=e(".handsontable"),o=!1,n=0,i=t.length;n<i;n++){var r=e(t[n]).handsontable("getInstance");if(r&&r.getSettings().contextMenu){o=!0;break}}return o},i.prototype.removeMenu=function(e){e.parentNode&&this.menu.parentNode.removeChild(e)},i.SEPARATOR={name:"---------"},t.hooks.add("afterInit",s),t.hooks.add("afterUpdateSettings",s),t.hooks.add("afterInit",(function(){if(!this.rootElement[0].className.indexOf("htContextMenu")){for(var e=0,t=0,o=this.getSettings().data.length,n=0;n<o;n++)this.getSettings().data[n].name==i.SEPARATOR.name?e+=2:t+=26;this.view.wt.wtScrollbars.vertical.fixedContainer.style.height=t+e+"px"}})),t.PluginHooks.register("afterContextMenuDefaultOptions"),t.ContextMenu=i}(o);var g,m,w,v,y=function(){this.getSettings().comments&&(o.Comments=new p(this),o.Comments.init())},C=function(e,t,n,i,r,s){s.comment&&o.Dom.addClass(e,s.commentedCellClassName)};function b(){this.boundaries=null,this.callback=null}if(o.hooks.add("beforeInit",y),o.hooks.add("afterContextMenuDefaultOptions",(function(e){this.getSettings().comments&&(e.items.push(o.ContextMenu.SEPARATOR),e.items.push({key:"commentsAddEdit",name:function(){return o.Comments.checkSelectionCommentsConsistency()?"Edit Comment":"Add Comment"},callback:function(e,t,n){o.Comments.showComment(this.getSelectedRange())},disabled:function(){return!1}}),e.items.push({key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(e,t,n){o.Comments.removeComment(t.start.row,t.start.col)},disabled:function(){return!o.Comments.checkSelectionCommentsConsistency()}}))})),o.hooks.add("afterRenderer",C),function(o){var n=new function(){var n,i,r,s,l,a,c,h=document.createElement("DIV"),u=document.createElement("DIV"),d=e(t);h.className="manualColumnMover",u.className="manualColumnMoverGuide";var f=function(){o.hooks.run(this,"persistentStateSave","manualColumnPositions",this.manualColumnPositions)},p=function(){var e={};return o.hooks.run(this,"persistentStateLoad","manualColumnPositions",e),e.value};function g(e){a=this,c=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){l=t;var o=c.getBoundingClientRect();s=o.left,h.style.top=o.top+"px",h.style.left=s+"px",a.rootElement[0].appendChild(h)}}function m(){o.Dom.addClass(h,"active"),o.Dom.addClass(u,"active");var e=c.getBoundingClientRect();u.style.width=e.width+"px",u.style.height=this.view.maximumVisibleElementHeight(0)+"px",u.style.top=h.style.top,u.style.left=s+"px",this.rootElement[0].appendChild(u)}var w=function(){var e,t=this;t.rootElement.on("mouseenter.manualColumnMove."+t.guid,"table thead tr > th",(function(o){var n;e?(i=t.view.wt.wtTable.getCoords(o.currentTarget).col,n=o.currentTarget.getBoundingClientRect(),h.style.left=n.left+"px"):g.call(t,o.currentTarget)})),t.rootElement.on("mousedown.manualColumnMove."+t.guid,".manualColumnMover",(function(o){r=o.pageX,m.call(t),e=t,n=l,i=l})),d.on("mousemove.manualColumnMove."+t.guid,(function(t){var o;e&&(o=t.pageX-r,u.style.left=s+o+"px")})),d.on("mouseup.manualColumnMove."+t.guid,(function(){e&&(o.Dom.removeClass(h,"active"),o.Dom.removeClass(u,"active"),e=!1,n<i&&i--,y(t.manualColumnPositions,t.countCols()),t.manualColumnPositions.splice(i,0,t.manualColumnPositions.splice(n,1)[0]),t.forceFullRender=!0,t.view.render(),f.call(t),o.hooks.run(t,"afterColumnMove",n,i),g.call(t,c))})),t.addHook("afterDestroy",v)},v=function(){var e=this;e.rootElement.off("mouseenter.manualColumnMove."+e.guid,"table thead tr > th"),e.rootElement.off("mousedown.manualColumnMove."+e.guid,".manualColumnMover"),d.off("mousemove.manualColumnMove."+e.guid),d.off("mouseup.manualColumnMove."+e.guid)},y=function(e,t){if(e.length<t)for(var o=e.length;o<t;o++)e[o]=o};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){if(this.getSettings().manualColumnMove){var t=this.getSettings().manualColumnMove,o=p.call(this);this.manualColumnPositions=void 0!==o?o:t instanceof Array?t:[],"afterInit"==e&&(w.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else v.call(this),this.manualColumnPositions=[]},this.modifyCol=function(e){return this.getSettings().manualColumnMove?(void 0===this.manualColumnPositions[e]&&y(this.manualColumnPositions,e+1),this.manualColumnPositions[e]):e}};o.hooks.add("beforeInit",n.beforeInit),o.hooks.add("afterInit",(function(){n.init.call(this,"afterInit")})),o.hooks.add("afterUpdateSettings",(function(){n.init.call(this,"afterUpdateSettings")})),o.hooks.add("modifyCol",n.modifyCol),o.hooks.register("afterColumnMove")}(o),function(o){var n=new function(){var n,i,r,s,l,a,c,h,u=document.createElement("DIV"),d=document.createElement("DIV"),f=e(t);u.className="manualColumnResizer",d.className="manualColumnResizerGuide";var p=function(){o.hooks.run(this,"persistentStateSave","manualColumnWidths",this.manualColumnWidths)},g=function(){var e={};return o.hooks.run(this,"persistentStateLoad","manualColumnWidths",e),e.value};function m(e){s=this,n=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){i=t;var o=n.getBoundingClientRect();h=o.left-6,c=parseInt(o.width,10),u.style.top=o.top+"px",u.style.left=h+c+"px",s.rootElement[0].appendChild(u)}}function w(){o.Dom.addClass(u,"active"),o.Dom.addClass(d,"active"),d.style.top=u.style.top,d.style.left=u.style.left,d.style.height=this.view.maximumVisibleElementHeight(0)+"px",this.rootElement[0].appendChild(d)}var v=function(){var e,t=this,s=0,g=null;t.rootElement.on("mouseenter.manualColumnResize."+t.guid,"table thead tr > th",(function(o){e||m.call(t,o.currentTarget)})),t.rootElement.on("mousedown.manualColumnResize."+t.guid,".manualColumnResizer",(function(n){w.call(t),e=t,null==g&&(g=setTimeout((function(){s>=2&&(l=t.determineColumnWidth.call(t,i),C(i,l),t.forceFullRender=!0,t.view.render(),o.hooks.run(t,"afterColumnResize",i,l)),s=0,g=null}),500),t._registerTimeout(g)),s++,a=n.pageX,l=c})),f.on("mousemove.manualColumnResize."+t.guid,(function(t){e&&(r=c+(t.pageX-a),l=C(i,r),u.style.left=h+r+"px",d.style.left=u.style.left)})),f.on("mouseup.manualColumnResize."+t.guid,(function(){e&&(o.Dom.removeClass(u,"active"),o.Dom.removeClass(d,"active"),e=!1,l!=c&&(t.forceFullRender=!0,t.view.render(),p.call(t),o.hooks.run(t,"afterColumnResize",i,l)),m.call(t,n))})),t.addHook("afterDestroy",y)},y=function(){var e=this;e.rootElement.off("mouseenter.manualColumnResize."+e.guid,"table thead tr > th"),e.rootElement.off("mousedown.manualColumnResize."+e.guid,".manualColumnResizer"),f.off("mousemove.manualColumnResize."+e.guid),f.off("mouseup.manualColumnResize."+e.guid)};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){if(this.getSettings().manualColumnResize){var t=this.getSettings().manualColumnResize,o=g.call(this);this.manualColumnWidths=void 0!==o?o:t instanceof Array?t:[],"afterInit"==e&&(v.call(this),this.manualColumnWidths.length>0&&(this.forceFullRender=!0,this.render()))}else y.call(this),this.manualColumnWidths=[]};var C=function(e,t){return t=Math.max(t,20),e=o.hooks.execute(s,"modifyCol",e),s.manualColumnWidths[e]=t,t};this.modifyColWidth=function(e,t){return t=this.runHooksAndReturn("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t]?this.manualColumnWidths[t]:e}};o.hooks.add("beforeInit",n.beforeInit),o.hooks.add("afterInit",(function(){n.init.call(this,"afterInit")})),o.hooks.add("afterUpdateSettings",(function(){n.init.call(this,"afterUpdateSettings")})),o.hooks.add("modifyColWidth",n.modifyColWidth),o.hooks.register("afterColumnResize")}(o),function(o){var n=new function(){var n,i,r,s,l,a,c,h,u=document.createElement("DIV"),d=document.createElement("DIV"),f=e(t);u.className="manualRowResizer",d.className="manualRowResizerGuide";var p=function(){o.hooks.run(this,"persistentStateSave","manualRowHeights",this.manualRowHeights)},g=function(){var e={};return o.hooks.run(this,"persistentStateLoad","manualRowHeights",e),e.value};function m(e){s=this,n=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){i=t;var o=n.getBoundingClientRect();h=o.top-6,c=parseInt(o.height,10),u.style.left=o.left+"px",u.style.top=h+c+"px",s.rootElement[0].appendChild(u)}}function w(){o.Dom.addClass(u,"active"),o.Dom.addClass(d,"active"),d.style.top=u.style.top,d.style.left=u.style.left,d.style.width=this.view.maximumVisibleElementWidth(0)+"px",this.rootElement[0].appendChild(d)}var v=function(){var e,t=this,s=0,g=null;t.rootElement.on("mouseenter.manualRowResize."+t.guid,"table tbody tr > th",(function(o){e||m.call(t,o.currentTarget)})),t.rootElement.on("mousedown.manualRowResize."+t.guid,".manualRowResizer",(function(n){w.call(t),e=t,null==g&&(g=setTimeout((function(){s>=2&&(C(i,null),t.forceFullRender=!0,t.view.render(),o.hooks.run(t,"afterRowResize",i,l)),s=0,g=null}),500),t._registerTimeout(g)),s++,a=n.pageY,l=c})),f.on("mousemove.manualRowResize."+t.guid,(function(t){e&&(r=c+(t.pageY-a),l=C(i,r),u.style.top=h+r+"px",d.style.top=u.style.top)})),f.on("mouseup.manualRowResize."+t.guid,(function(){e&&(o.Dom.removeClass(u,"active"),o.Dom.removeClass(d,"active"),e=!1,l!=c&&(t.forceFullRender=!0,t.view.render(),p.call(t),o.hooks.run(t,"afterRowResize",i,l)),m.call(t,n))})),t.addHook("afterDestroy",y)},y=function(){var e=this;e.rootElement.off("mouseenter.manualRowResize."+e.guid,"table tbody tr > th"),e.rootElement.off("mousedown.manualRowResize."+e.guid,".manualRowResizer"),f.off("mousemove.manualRowResize."+e.guid),f.off("mouseup.manualRowResize."+e.guid)};this.beforeInit=function(){this.manualRowHeights=[]},this.init=function(e){if(this.getSettings().manualRowResize){var t=this.getSettings().manualRowResize,o=g.call(this);this.manualRowHeights=void 0!==o?o:t instanceof Array?t:[],"afterInit"===e?(v.call(this),this.manualRowHeights.length>0&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())}else y.call(this),this.manualRowHeights=[]};var C=function(e,t){return e=o.hooks.execute(s,"modifyRow",e),s.manualRowHeights[e]=t,t};this.modifyRowHeight=function(e,t){return this.getSettings().manualRowResize&&(t=this.runHooksAndReturn("modifyRow",t),void 0!==this.manualRowHeights[t])?this.manualRowHeights[t]:e}};o.hooks.add("beforeInit",n.beforeInit),o.hooks.add("afterInit",(function(){n.init.call(this,"afterInit")})),o.hooks.add("afterUpdateSettings",(function(){n.init.call(this,"afterUpdateSettings")})),o.hooks.add("modifyRowHeight",n.modifyRowHeight),o.hooks.register("afterRowResize")}(o),function(){function e(){var e=this,o=e.getSettings().observeChanges;o?(e.observer&&i.call(e),t.call(e),s.call(e)):o||i.call(e)}function t(){var e=this;e.observeChangesActive=!0,e.pauseObservingChanges=function(){e.observeChangesActive=!1},e.resumeObservingChanges=function(){e.observeChangesActive=!0},e.observedData=e.getData(),e.observer=h.observe(e.observedData,(function(t){e.observeChangesActive&&(n.call(e,t),e.render()),e.runHooks("afterChangesObserved")}))}function n(e){for(var t=this,o=function(e){var t;return t=function(e){return e.filter((function(e){return!/[/]length/gi.test(e.path)}))}(e),t=function(e){var t=[];return e.filter((function(e){var o=l(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(o.col)){if(-1!=t.indexOf(o.col))return!1;t.push(o.col)}return!0}))}(t),t}(e),n=0,i=o.length;n<i;n++){var r=o[n],s=l(r.path);switch(r.op){case"add":isNaN(s.col)?t.runHooks("afterCreateRow",s.row):t.runHooks("afterCreateCol",s.col);break;case"remove":isNaN(s.col)?t.runHooks("afterRemoveRow",s.row,1):t.runHooks("afterRemoveCol",s.col,1);break;case"replace":t.runHooks("afterChange",[s.row,s.col,null,r.value],"external")}}function l(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}}function i(){var e=this;e.observer&&(r.call(e),l.call(e))}function r(){var e=this;h.unobserve(e.observedData,e.observer),delete e.observeChangesActive,delete e.pauseObservingChanges,delete e.resumeObservingChanges}function s(){var e=this;e.addHook("afterDestroy",i),e.addHook("afterCreateRow",a),e.addHook("afterRemoveRow",a),e.addHook("afterCreateCol",a),e.addHook("afterRemoveCol",a),e.addHook("afterChange",(function(e,t){"loadData"!=t&&a.call(this)}))}function l(){var e=this;e.removeHook("afterDestroy",i),e.removeHook("afterCreateRow",a),e.removeHook("afterRemoveRow",a),e.removeHook("afterCreateCol",a),e.removeHook("afterRemoveCol",a),e.removeHook("afterChange",a)}function a(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",(function(){e.resumeObservingChanges()}))}o.hooks.add("afterLoadData",e),o.hooks.add("afterUpdateSettings",e),o.hooks.register("afterChangesObserved")}(),g=function(e){var o,n,i,r=function(){t.localStorage[e+"__persistentStateKeys"]=JSON.stringify(o)};i="string"==typeof(n=t.localStorage[e+"__persistentStateKeys"])?JSON.parse(n):void 0,o=i||[],this.saveValue=function(n,i){t.localStorage[e+"_"+n]=JSON.stringify(i),-1==o.indexOf(n)&&(o.push(n),r())},this.loadValue=function(o,n){o=void 0!==o?o:n;var i=t.localStorage[e+"_"+o];return void 0===i?void 0:JSON.parse(i)},this.reset=function(o){t.localStorage.removeItem(e+"_"+o)},this.resetAll=function(){for(var n=0;n<o.length;n++)t.localStorage.removeItem(e+"_"+o[n]);o=[],r()}},m=new function(){var e=this;this.init=function(){var t=this,o=t.getSettings().persistentState;e.enabled=!!o,e.enabled?(t.storage||(t.storage=new g(t.rootElement[0].id)),t.resetState=e.resetValue,i.call(t)):r.call(t)},this.saveValue=function(e,t){this.storage.saveValue(e,t)},this.loadValue=function(e,t){t.value=this.storage.loadValue(e)},this.resetValue=function(e){void 0!==e?this.storage.reset(e):this.storage.resetAll()};var t={persistentStateSave:e.saveValue,persistentStateLoad:e.loadValue,persistentStateReset:e.resetValue};for(var n in t)t.hasOwnProperty(n)&&o.hooks.register(n);function i(){for(var e in t)t.hasOwnProperty(e)&&this.addHook(e,t[e])}function r(){for(var e in t)t.hasOwnProperty(e)&&this.removeHook(e,t[e])}},o.hooks.add("beforeInit",m.init),o.hooks.add("afterUpdateSettings",m.init),function(t){t.UndoRedo=function(e){var o=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,e.addHook("afterChange",(function(e,n){if(e){var i=new t.UndoRedo.ChangeAction(e);o.done(i)}})),e.addHook("afterCreateRow",(function(e,n,i){if(!i){var r=new t.UndoRedo.CreateRowAction(e,n);o.done(r)}})),e.addHook("beforeRemoveRow",(function(e,n){var i=o.instance.getData();e=(i.length+e)%i.length;var r=i.slice(e,e+n),s=new t.UndoRedo.RemoveRowAction(e,r);o.done(s)})),e.addHook("afterCreateCol",(function(e,n,i){if(!i){var r=new t.UndoRedo.CreateColumnAction(e,n);o.done(r)}})),e.addHook("beforeRemoveCol",(function(n,i){var r=o.instance.getData();n=(o.instance.countCols()+n)%o.instance.countCols();for(var s,l=[],a=0,c=r.length;a<c;a++)l[a]=r[a].slice(n,n+i);t.helper.isArray(e.getSettings().colHeaders)&&(s=e.getSettings().colHeaders.slice(n,n+l.length));var h=new t.UndoRedo.RemoveColumnAction(n,l,s);o.done(h)}))},t.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},t.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=!0;var t=this;e.undo(this.instance,(function(){t.ignoreNewActions=!1,t.undoneActions.push(e)}))}},t.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=!0;var t=this;e.redo(this.instance,(function(){t.ignoreNewActions=!1,t.doneActions.push(e)}))}},t.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},t.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},t.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},t.UndoRedo.Action=function(){},t.UndoRedo.Action.prototype.undo=function(){},t.UndoRedo.Action.prototype.redo=function(){},t.UndoRedo.ChangeAction=function(e){this.changes=e},t.helper.inherit(t.UndoRedo.ChangeAction,t.UndoRedo.Action),t.UndoRedo.ChangeAction.prototype.undo=function(t,o){for(var n=e.extend(!0,[],this.changes),i=t.countEmptyRows(!0),r=t.countEmptyCols(!0),s=0,l=n.length;s<l;s++)n[s].splice(3,1);for(t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"undo"),s=0,l=n.length;s<l;s++)t.getSettings().minSpareRows&&n[s][0]+1+t.getSettings().minSpareRows===t.countRows()&&i==t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(n[s][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&n[s][1]+1+t.getSettings().minSpareCols===t.countCols()&&r==t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(n[s][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},t.UndoRedo.ChangeAction.prototype.redo=function(t,o){for(var n=e.extend(!0,[],this.changes),i=0,r=n.length;i<r;i++)n[i].splice(2,1);t.addHookOnce("afterChange",o),t.setDataAtRowProp(n,null,null,"redo")},t.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},t.helper.inherit(t.UndoRedo.CreateRowAction,t.UndoRedo.Action),t.UndoRedo.CreateRowAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)},t.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},t.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},t.helper.inherit(t.UndoRedo.RemoveRowAction,t.UndoRedo.Action),t.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var o=[this.index,0];Array.prototype.push.apply(o,this.data),Array.prototype.splice.apply(e.getData(),o),e.addHookOnce("afterRender",t),e.render()},t.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},t.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},t.helper.inherit(t.UndoRedo.CreateColumnAction,t.UndoRedo.Action),t.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},t.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},t.UndoRedo.RemoveColumnAction=function(e,t,o){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=o},t.helper.inherit(t.UndoRedo.RemoveColumnAction,t.UndoRedo.Action),t.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var o,n,i=0,r=e.getData().length;i<r;i++)o=e.getSourceDataAtRow(i),n=[this.index,0],Array.prototype.push.apply(n,this.data[i]),Array.prototype.splice.apply(o,n);void 0!==this.headers&&(n=[this.index,0],Array.prototype.push.apply(n,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,n)),e.addHookOnce("afterRender",t),e.render()},t.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)}}(o),function(e){function t(){var t=this;void 0===t.getSettings().undo||t.getSettings().undo?t.undoRedo||(t.undoRedo=new e.UndoRedo(t),function(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}(t),t.addHook("beforeKeyDown",o),t.addHook("afterChange",n)):t.undoRedo&&(delete t.undoRedo,function(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}(t),t.removeHook("beforeKeyDown",o),t.removeHook("afterChange",n))}function o(e){(e.ctrlKey||e.metaKey)&&!e.altKey&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(this.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(this.undoRedo.undo(),e.stopImmediatePropagation()))}function n(e,t){if("loadData"==t)return this.undoRedo.clear()}e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(o),b.prototype.setBoundaries=function(e){this.boundaries=e},b.prototype.setCallback=function(e){this.callback=e},b.prototype.check=function(e,t){var o=0,n=0;t<this.boundaries.top?n=t-this.boundaries.top:t>this.boundaries.bottom&&(n=t-this.boundaries.bottom),e<this.boundaries.left?o=e-this.boundaries.left:e>this.boundaries.right&&(o=e-this.boundaries.right),this.callback(o,n)},void 0!==o){var S=function(e){e.dragToScrollListening=!1;var o=e.view.wt.wtScrollbars.vertical.scrollHandler;w=new b,o!==t&&(o?w.setBoundaries(o.getBoundingClientRect()):w.setBoundaries(e.$table[0].getBoundingClientRect()),w.setCallback((function(t,n){t<0?o?o.scrollLeft-=50:e.view.wt.scrollHorizontal(-1).draw():t>0&&(o?o.scrollLeft+=50:e.view.wt.scrollHorizontal(1).draw()),n<0?o?o.scrollTop-=20:e.view.wt.scrollVertical(-1).draw():n>0&&(o?o.scrollTop+=20:e.view.wt.scrollVertical(1).draw())})),e.dragToScrollListening=!0)};o.hooks.add("afterInit",(function(){var t=this;e(document).on("mouseup."+this.guid,(function(){t.dragToScrollListening=!1})),e(document).on("mousemove."+this.guid,(function(e){t.dragToScrollListening&&w.check(e.clientX,e.clientY)}))})),o.hooks.add("afterDestroy",(function(){e(document).off("."+this.guid)})),o.hooks.add("afterOnCellMouseDown",(function(){S(this)})),o.hooks.add("afterOnCellCornerMouseDown",(function(){S(this)})),o.plugins.DragToScroll=b}function R(){var e=[];return e.getInfo=function(e,t){for(var o=0,n=this.length;o<n;o++)if(this[o].row<=e&&this[o].row+this[o].rowspan-1>=e&&this[o].col<=t&&this[o].col+this[o].colspan-1>=t)return this[o]},e.setInfo=function(e){for(var t=0,o=this.length;t<o;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var o=0,n=this.length;o<n;o++)if(this[o].row===e&&this[o].col===t){this.splice(o,1);break}},e}function T(e){if(this.mergedCellInfoCollection=new R,o.helper.isArray(e))for(var t=0,n=e.length;t<n;t++)this.mergedCellInfoCollection.setInfo(e[t])}if(function(e,t,o){function n(n){this.copyPasteInstance=t.getInstance(),this.copyPasteInstance.onCut(r),this.copyPasteInstance.onPaste(s);var i=this;function r(){n.isListening()&&n.selection.empty()}function s(e){if(n.isListening()&&n.selection.isSelected()){var t=e.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),i=o.parse(t),r=n.getSelected(),s=new M(r[0],r[1]),l=new N(s,s,new M(r[2],r[3])),a=l.getTopLeftCorner(),c=l.getBottomRightCorner(),h=a,u=new M(Math.max(c.row,i.length-1+a.row),Math.max(c.col,i[0].length-1+a.col));n.addHookOnce("afterChange",(function(e,t){e&&e.length&&this.selectCell(h.row,h.col,u.row,u.col)})),n.populateFromArray(h.row,h.col,i,u.row,u.col,"paste",n.getSettings().pasteMode)}}function l(t){if(n.getSelected()){if(e.helper.isCtrlKey(t.keyCode))return i.setCopyableText(),void t.stopImmediatePropagation();var o=(t.ctrlKey||t.metaKey)&&!t.altKey;t.keyCode==e.helper.keyCode.A&&o&&n._registerTimeout(setTimeout(e.helper.proxy(i.setCopyableText,i),0))}}n.addHook("beforeKeyDown",l),this.destroy=function(){this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.removeCallback(s),this.copyPasteInstance.destroy(),n.removeHook("beforeKeyDown",l)},n.addHook("afterDestroy",e.helper.proxy(this.destroy,this)),this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=n.getSettings(),o=t.copyRowsLimit,i=t.copyColsLimit,r=n.getSelectedRange(),s=r.getTopLeftCorner(),l=r.getBottomRightCorner(),a=s.row,c=s.col,h=l.row,u=l.col,d=Math.min(h,a+o-1),f=Math.min(u,c+i-1);n.copyPaste.copyPasteInstance.copyable(n.getCopyableData(a,c,d,f)),h===d&&u===f||e.hooks.run(n,"afterCopyLimit",h-a+1,u-c+1,o,i)}}function i(){var e=this,t=!1!==e.getSettings().copyPaste;t&&!e.copyPaste?e.copyPaste=new n(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}e.hooks.add("afterInit",i),e.hooks.add("afterUpdateSettings",i),e.hooks.register("afterCopyLimit")}(o,u,SheetClip),function(e){var t,o,n;e.Search=function(t){this.query=function(o,n,i){var r=t.countRows(),s=t.countCols(),l=[];n||(n=e.Search.global.getDefaultCallback()),i||(i=e.Search.global.getDefaultQueryMethod());for(var a=0;a<r;a++)for(var c=0;c<s;c++){var h=t.getDataAtCell(a,c),u=t.getCellMeta(a,c),d=u.search.callback||n,f=(u.search.queryMethod||i)(o,h);if(f){var p={row:a,col:c,data:h};l.push(p)}d&&d(t,a,c,h,f)}return l}},e.Search.DEFAULT_CALLBACK=function(e,t,o,n,i){e.getCellMeta(t,o).isSearchResult=i},e.Search.DEFAULT_QUERY_METHOD=function(e,t){return!(void 0===e||null==e||!e.toLowerCase||0==e.length)&&void 0!==t&&null!=t&&-1!=t.toString().toLowerCase().indexOf(e.toLowerCase())},e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",e.Search.global=(t=e.Search.DEFAULT_CALLBACK,o=e.Search.DEFAULT_QUERY_METHOD,n=e.Search.DEFAULT_SEARCH_RESULT_CLASS,{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return o},setDefaultQueryMethod:function(e){o=e},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(e){n=e}}),e.SearchCellDecorator=function(t,o,n,i,r,s,l){var a="object"==typeof l.search&&l.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();l.isSearchResult?e.Dom.addClass(o,a):e.Dom.removeClass(o,a)};var i=e.renderers.cellDecorator;function r(){var t=this;t.getSettings().search?t.search=new e.Search(t):delete t.search}e.renderers.cellDecorator=function(t,o,n,r,s,l,a){i.apply(this,arguments),e.SearchCellDecorator.apply(this,arguments)},e.hooks.add("afterInit",r),e.hooks.add("afterUpdateSettings",r)}(o),T.prototype.canMergeRange=function(e){return!e.isSingle()},T.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),o=e.getBottomRightCorner(),n={};n.row=t.row,n.col=t.col,n.rowspan=o.row-t.row+1,n.colspan=o.col-t.col+1,this.mergedCellInfoCollection.setInfo(n)}},T.prototype.mergeOrUnmergeSelection=function(e){this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col)?this.unmergeSelection(e.from):this.mergeSelection(e)},T.prototype.mergeSelection=function(e){this.mergeRange(e)},T.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},T.prototype.applySpanProperties=function(e,t,o){var n=this.mergedCellInfoCollection.getInfo(t,o);n?n.row===t&&n.col===o?(e.setAttribute("rowspan",n.rowspan),e.setAttribute("colspan",n.colspan)):e.style.display="none":(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},T.prototype.modifyTransform=function(e,t,o){var n,i,r=function(e,t){return t.col>=e.col&&t.col<=e.col+e.colspan-1},s=function(e){return new M(t.to.row+e.row,t.to.col+e.col)},l={row:o.row,col:o.col};if("modifyTransformStart"==e){this.lastDesiredCoords||(this.lastDesiredCoords=new M(null,null));for(var a=new M(t.highlight.row,t.highlight.col),c=this.mergedCellInfoCollection.getInfo(a.row,a.col),h=0,u=this.mergedCellInfoCollection.length;h<u;h++){var d=this.mergedCellInfoCollection[h];if(d=new M(d.row+d.rowspan-1,d.col+d.colspan-1),t.includes(d))break}c&&(new N(g=new M(c.row,c.col),g,new M(c.row+c.rowspan-1,c.col+c.colspan-1)).includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new M(null,null)),l.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-a.row:l.row,l.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-a.col:l.col,o.row>0?l.row=c.row+c.rowspan-1-a.row+o.row:o.row<0&&(l.row=a.row-c.row+o.row),o.col>0?l.col=c.col+c.colspan-1-a.col+o.col:o.col<0&&(l.col=a.col-c.col+o.col));var f=new M(t.highlight.row+l.row,t.highlight.col+l.col),p=this.mergedCellInfoCollection.getInfo(f.row,f.col);p&&(this.lastDesiredCoords=f,l={row:p.row-a.row,col:p.col-a.col})}else if("modifyTransformEnd"==e)for(h=0,u=this.mergedCellInfoCollection.length;h<u;h++){var g,m=this.mergedCellInfoCollection[h],w=new N(g=new M(m.row,m.col),g,new M(m.row+m.rowspan-1,m.col+m.colspan-1)),v=t.getBordersSharedWith(w);if(w.isEqual(t))t.setDirection("NW-SE");else if(v.length>0){var y=t.highlight.isEqual(w.from);v.indexOf("top")>-1?t.to.isSouthEastOf(w.from)&&y?t.setDirection("NW-SE"):t.to.isSouthWestOf(w.from)&&y&&t.setDirection("NE-SW"):v.indexOf("bottom")>-1&&(t.to.isNorthEastOf(w.from)&&y?t.setDirection("SW-NE"):t.to.isNorthWestOf(w.from)&&y&&t.setDirection("SE-NW"))}var C=(n=m,(i=f=s(l)).row>=n.row&&i.row<=n.row+n.rowspan-1),b=r(m,f);t.includesRange(w)&&(w.includes(f)||C||b)&&(C&&(l.row<0?l.row-=m.rowspan-1:l.row>0&&(l.row+=m.rowspan-1)),b&&(l.col<0?l.col-=m.colspan-1:l.col>0&&(l.col+=m.colspan-1)))}0!=l.row&&(o.row=l.row),0!=l.col&&(o.col=l.col)},void 0===o)throw new Error("Handsontable is not defined");C=function(e,t,o,n,i,r){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,o)};var E=function(e){return function(t){if(this.getSettings().mergeCells){var o=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,o,t),"modifyTransformEnd"===e){var n=this.countRows(),i=this.countCols();o.from.row<0?o.from.row=0:o.from.row>0&&o.from.row>=n&&(o.from.row=o.from-1),o.from.col<0?o.from.col=0:o.from.col>0&&o.from.col>=i&&(o.from.col=i-1)}}}};o.hooks.add("beforeInit",(function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new T(t)))})),o.hooks.add("afterInit",(function(){var e=this;e.mergeCells&&(e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var o=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);o&&(t=o)}return Q.prototype.getCell.call(this,t)})})),o.hooks.add("beforeKeyDown",(function(e){this.mergeCells&&(e.ctrlKey||e.metaKey)&&!e.altKey&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),e.stopImmediatePropagation())})),o.hooks.add("modifyTransformStart",E("modifyTransformStart")),o.hooks.add("modifyTransformEnd",E("modifyTransformEnd")),o.hooks.add("beforeSetRangeEnd",(function(e){if(this.lastDesiredCoords=null,this.getSettings().mergeCells){var t=this.getSelectedRange();t.highlight=new M(t.highlight.row,t.highlight.col),t.to=e;var o=!1;do{o=!1;for(var n=0,i=this.mergeCells.mergedCellInfoCollection.length;n<i;n++){var r=this.mergeCells.mergedCellInfoCollection[n],s=new M(r.row,r.col),l=new N(s,s,new M(r.row+r.rowspan-1,r.col+r.colspan-1));t.expandByRange(l)&&(e.row=t.to.row,e.col=t.to.col,o=!0)}}while(o)}})),o.hooks.add("beforeDrawBorders",(function(e,t){if(t&&"area"==t&&this.getSettings().mergeCells)for(var o=this.getSelectedRange(),n=new N(o.from,o.from,o.from),i=new N(o.to,o.to,o.to),r=0,s=this.mergeCells.mergedCellInfoCollection.length;r<s;r++){var l=this.mergeCells.mergedCellInfoCollection[r],a=new M(l.row,l.col),c=new N(a,a,new M(l.row+l.rowspan-1,l.col+l.colspan-1));n.expandByRange(c)&&(e[0]=n.from.row,e[1]=n.from.col),i.expandByRange(c)&&(e[2]=i.from.row,e[3]=i.from.col)}})),o.hooks.add("afterIsMultipleSelection",(function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,o=this.getSelectedRange();for(var n in t)if(o.highlight.row==t[n].row&&o.highlight.col==t[n].col&&o.to.row==t[n].row+t[n].rowspan-1&&o.to.col==t[n].col+t[n].colspan-1)return!1}return e})),o.hooks.add("afterRenderer",C),o.hooks.add("afterContextMenuDefaultOptions",(function(e){this.getSettings().mergeCells&&(e.items.push(o.ContextMenu.SEPARATOR),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected();return this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1])?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return!1}}))})),o.hooks.add("afterGetCellMeta",(function(e,t,o){if(this.getSettings().mergeCells){var n=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!n||n.row==e&&n.col==t||(o.copyable=!1)}})),o.MergeCells=T,function(){function e(){}var t,n=function(e){var o={row:e.row,col:e.col},n=new q(e,new N(o,o,o)),i=function(e){for(var o=0;o<t.view.wt.selections.length;o++)if(t.view.wt.selections[o].settings.className==e)return o;return-1}(e.className);i>=0?t.view.wt.selections[i]=n:t.view.wt.selections.push(n)},i=function(e,t,o){var i=l(e,t);i=a(i,o),this.setCellMeta(e,t,"borders",i),n(i)},r=function(e){for(var t=e.range,o=t.from.row;o<=t.to.row;o++)for(var i=t.from.col;i<=t.to.col;i++){var r=l(o,i),s=0;o==t.from.row&&(s++,e.hasOwnProperty("top")&&(r.top=e.top)),o==t.to.row&&(s++,e.hasOwnProperty("bottom")&&(r.bottom=e.bottom)),i==t.from.col&&(s++,e.hasOwnProperty("left")&&(r.left=e.left)),i==t.to.col&&(s++,e.hasOwnProperty("right")&&(r.right=e.right)),s>0&&(this.setCellMeta(o,i,"borders",r),n(r))}},s=function(e,t){return"border_row"+e+"col"+t},l=function(e,t){return{className:s(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}},a=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e},c=function(e){for(var t=document.getElementsByClassName(e),o=0;o<t.length;o++)if(t[o]&&"TD"!=t[o].nodeName){var n=t[o].parentNode;n.parentNode.removeChild(n)}},h=function(e,t){var o=s(e,t);c(o),this.removeCellMeta(e,t,"borders")},u=function(e,t,o,i){var r=this.getCellMeta(e,t).borders;r&&null!=r.border||(r=l(e,t)),r[o]=i?{hide:!0}:{width:1,color:"#000"},this.setCellMeta(e,t,"borders",r);var a=s(e,t);c(a),n(r),this.render()},d=function(e,t,o){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?h.call(this,e.from.row,e.from.col):u.call(this,e.from.row,e.from.col,t,o);else switch(t){case"noBorders":for(var n=e.from.col;n<=e.to.col;n++)for(var i=e.from.row;i<=e.to.row;i++)h.call(this,i,n);break;case"top":for(var r=e.from.col;r<=e.to.col;r++)u.call(this,e.from.row,r,t,o);break;case"right":for(var s=e.from.row;s<=e.to.row;s++)u.call(this,s,e.to.col,t);break;case"bottom":for(var l=e.from.col;l<=e.to.col;l++)u.call(this,e.to.row,l,t);break;case"left":for(var a=e.from.row;a<=e.to.row;a++)u.call(this,a,e.from.col,t)}},f=function(e,t){var o=!1;return e.getSelectedRange().forAll((function(n,i){var r=e.getCellMeta(n,i).borders;if(r){if(!t)return o=!0,!1;if(!r[t].hasOwnProperty("hide"))return o=!0,!1}})),o},p=function(e){return"<span class='selected'>✓</span>"+e};o.hooks.add("beforeInit",(function(){var o;("boolean"==typeof(o=this.getSettings().customBorders)&&1==o||"object"==typeof o&&o.length>0)&&(this.customBorders||(t=this,this.customBorders=new e))})),o.hooks.add("afterContextMenuDefaultOptions",(function(e){this.getSettings().customBorders&&(e.items.push(o.ContextMenu.SEPARATOR),e.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var e="Top";return f(this,"top")&&(e=p(e)),e},callback:function(){var e=f(this,"top");d.call(this,this.getSelectedRange(),"top",e)},disabled:!1},right:{name:function(){var e="Right";return f(this,"right")&&(e=p(e)),e},callback:function(){var e=f(this,"right");d.call(this,this.getSelectedRange(),"right",e)},disabled:!1},bottom:{name:function(){var e="Bottom";return f(this,"bottom")&&(e=p(e)),e},callback:function(){var e=f(this,"bottom");d.call(this,this.getSelectedRange(),"bottom",e)},disabled:!1},left:{name:function(){var e="Left";return f(this,"left")&&(e=p(e)),e},callback:function(){var e=f(this,"left");d.call(this,this.getSelectedRange(),"left",e)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){d.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!f(this)}}}}}))})),o.hooks.add("afterInit",(function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?r.call(this,e[t]):i.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}})),o.CustomBorders=e}(),function(o){var n=new function(){var n,i,r,s,l,a,c=document.createElement("DIV"),h=document.createElement("DIV"),u=e(t);c.className="manualRowMover",h.className="manualRowMoverGuide";var d=function(){o.hooks.run(this,"persistentStateSave","manualRowPositions",this.manualRowPositions)},f=function(){var e={};return o.hooks.run(this,"persistentStateLoad","manualRowPositions",e),e.value};function p(e){v=this,a=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){l=t;var o=a.getBoundingClientRect();s=o.top,c.style.top=s+"px",c.style.left=o.left+"px",v.rootElement[0].appendChild(c)}}function g(){o.Dom.addClass(c,"active"),o.Dom.addClass(h,"active");var e=a.getBoundingClientRect();h.style.width=this.view.maximumVisibleElementWidth(0)+"px",h.style.height=e.height+"px",h.style.top=s+"px",h.style.left=c.style.left,this.rootElement[0].appendChild(h)}var m=function(){var e,t=this;t.rootElement.on("mouseenter.manualRowMove."+t.guid,"table tbody tr > th",(function(o){var n;e?(i=t.view.wt.wtTable.getCoords(o.currentTarget).row,n=o.currentTarget.getBoundingClientRect(),c.style.top=n.top+"px"):p.call(t,o.currentTarget)})),t.rootElement.on("mousedown.manualRowMove."+t.guid,".manualRowMover",(function(o){r=o.pageY,g.call(t),e=t,n=l,i=l})),u.on("mousemove.manualRowMove."+t.guid,(function(t){var o;e&&(o=t.pageY-r,h.style.top=s+o+"px")})),u.on("mouseup.manualRowMove."+t.guid,(function(){e&&(o.Dom.removeClass(c,"active"),o.Dom.removeClass(h,"active"),e=!1,n<i&&i--,y(t.manualRowPositions,t.countRows()),t.manualRowPositions.splice(i,0,t.manualRowPositions.splice(n,1)[0]),t.forceFullRender=!0,t.view.render(),d.call(t),o.hooks.run(t,"afterRowMove",n,i),p.call(t,a))})),t.addHook("afterDestroy",w)},w=function(){var e=this;e.rootElement.off("mouseenter.manualRowMove."+e.guid,"table tbody tr > th"),e.rootElement.off("mousedown.manualRowMove."+e.guid,".manualRowMover"),u.off("mousemove.manualRowMove."+e.guid),u.off("mouseup.manualRowMove."+e.guid)},y=function(e,t){if(e.length<t)for(var o=e.length;o<t;o++)e[o]=o};this.beforeInit=function(){this.manualRowPositions=[]},this.init=function(e){var t=this;if(t.getSettings().manualRowMove){var o=t.getSettings().manualRowMove,n=f.call(t);this.manualRowPositions=void 0!==n?n:o instanceof Array?o:[],"afterInit"===e&&(m.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))}else w.call(this),t.manualRowPositions=[]},this.modifyRow=function(e){var t=this;return t.getSettings().manualRowMove?(void 0===t.manualRowPositions[e]&&y(this.manualRowPositions,e+1),t.manualRowPositions[e]):e}};o.hooks.add("beforeInit",n.beforeInit),o.hooks.add("afterInit",(function(){n.init.call(this,"afterInit")})),o.hooks.add("afterUpdateSettings",(function(){n.init.call(this,"afterUpdateSettings")})),o.hooks.add("modifyRow",n.modifyRow),o.hooks.register("afterRowMove")}(o),function(o){function n(n){this.instance=n,this.addingStarted=!1,e(document);var i,r,s=!1,l=this;e(document).off("mouseup.autofill."+n.guid,this.instance.rootElement).on("mouseup.autofill."+n.guid,this.instance.rootElement,(function(e){!function(e){if(!n.autofill)return!0;n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged>1&&n.autofill.apply(),n.autofill.handle.isDragged=0,s=!1)}()})),e(document).off("mousemove.moveOutside_"+n.guid).on("mousemove.moveOutside_"+n.guid,(function(e){if(!l.instance.autofill)return 0;var n=o.Dom.offset(l.instance.$table[0]).top-(t.pageYOffset||document.documentElement.scrollTop)+o.Dom.outerHeight(l.instance.$table[0]),i=o.Dom.offset(l.instance.$table[0]).left-(t.pageXOffset||document.documentElement.scrollLeft)+o.Dom.outerWidth(l.instance.$table[0]);!1===l.addingStarted&&l.instance.autofill.handle.isDragged>0&&e.clientY>n&&e.clientX<=i?(this.mouseDragOutside=!0,l.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&setTimeout((function(){l.addingStarted=!1,l.instance.alter("insert_row")}),200)})),i=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){n.autofill.handle.isDragged=1,s=!0,i(e)},r=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(e,t,o,i){n.autofill&&s&&!n.view.isMouseDown()&&n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged++,n.autofill.showBorder(t),n.autofill.checkIfNewRowNeeded()),r(e,t,o,i)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){n.autofill.selectAdjacent()}}n.prototype.init=function(){this.handle={}},n.prototype.disable=function(){this.handle.disabled=!0},n.prototype.selectAdjacent=function(){var e,t,o,n,i;e=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),t=this.instance.getData();e:for(o=e[2]+1;o<this.instance.countRows();o++){for(i=e[1];i<=e[3];i++)if(t[o][i])break e;(t[o][e[1]-1]||t[o][e[3]+1])&&(n=o)}n&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new M(e[0],e[1])),this.instance.view.wt.selections.fill.add(new M(n,e[3])),this.apply())},n.prototype.apply=function(){var e,t,n,i,r;if(this.handle.isDragged=0,e=this.instance.view.wt.selections.fill.getCorners())if(this.instance.view.wt.selections.fill.clear(),t=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),e[0]===t[0]&&e[1]<t[1]?(n=new M(e[0],e[1]),i=new M(e[2],t[1]-1)):e[0]===t[0]&&e[3]>t[3]?(n=new M(e[0],t[3]+1),i=new M(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(n=new M(e[0],e[1]),i=new M(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(n=new M(t[2]+1,e[1]),i=new M(e[2],e[3])),n&&n.row>-1&&n.col>-1){var s={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to};r=this.instance.getData(s.from.row,s.from.col,s.to.row,s.to.col),o.hooks.run(this.instance,"beforeAutofill",n,i,r),this.instance.populateFromArray(n.row,n.col,r,i.row,i.col,"autofill"),this.instance.selection.setRangeStart(new M(e[0],e[1])),this.instance.selection.setRangeEnd(new M(e[2],e[3]))}else this.instance.selection.refreshBorders()},n.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),o=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==this.instance.getSettings().fillHandle&&(o.row<e.row||t.row>e.row))e=new M(e.row,o.col);else{if("vertical"===this.instance.getSettings().fillHandle)return;e=new M(o.row,e.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},n.prototype.checkIfNewRowNeeded=function(){var e,t,o=this.instance.countRows(),n=this;this.instance.view.wt.selections.fill.cellRange&&!1===this.addingStarted&&(t=this.instance.getSelected(),e=this.instance.view.wt.selections.fill.getCorners(),t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout((function(){n.instance.alter("insert_row"),n.addingStarted=!1}),200))))},o.hooks.add("afterInit",(function(){var e=new n(this);void 0!==this.getSettings().fillHandle&&(e.handle&&!1===this.getSettings().fillHandle?e.disable():e.handle||!1===this.getSettings().fillHandle||(this.autofill=e,this.autofill.init()))})),o.Autofill=n}(o);var k,D,A=function(e){var t=[],n={rows:0,cols:0},i={rows:0,cols:0},r=[],s=[],l={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(e){return"ht"+e+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(e){return"htCollapse-"+e},collapseFromLevel:function(e,t){return"htCollapse"+e+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},a=function(e,t){return function(o,n){return void 0===t||"asc"===t?o[e]-n[e]:n[e]-o[e]}},c=function(e,t){for(var o=[];e<=t;)o.push(e++);return o},h=function(e,t,o){var n=[],i={row:null,col:null};if("cols"==e)for(;t<=o;)i={row:-1,col:t++},n.push(i);else for(;t<=o;)i={row:t++,col:-1},n.push(i);for(var r=u(n),s=0,l=0,a=0;a<r.length;a++)s+=r[a].filter((function(e){return e.rows})).length,l+=r[a].filter((function(e){return e.cols})).length;return{total:{rows:s,cols:l},groups:r}},u=function(e){for(var t=[],o=0;o<e.length;o++)t.push(d(e[o]));return t},d=function(e,o,n){for(var i=e.row,r=e.col,s=-1===i?0:i,l=-1===r?0:r,a=[],c=0;c<t.length;c++){var h=t[c],u=h.id,d=(h.level,h.rows||[]),f=h.cols||[];-1===a.indexOf(u)&&(-1===d.indexOf(s)&&-1===f.indexOf(l)||a.push(h))}-1===r?a=a.concat(m()):-1===i&&(a=a.concat(v())),o&&(a=a.filter((function(e){return e.level===o}))),n&&("cols"===n?a=a.filter((function(e){return e.cols})):"rows"===n&&(a=a.filter((function(e){return e.rows}))));var p=[];return a.filter((function(e){if(-1===p.indexOf(e.id))return p.push(e.id),e}))},f=function(e){for(var o=0,n=t.length;o<n;o++)if(t[o].id==e)return t[o];return!1},p=function(e,o){for(var n=0,i=t.length;n<i;n++)if(t[n].level==o&&t[n].rows&&t[n].rows.indexOf(e)>-1)return t[n];return!1},g=function(e,o){for(var n=0,i=t.length;n<i;n++)if(t[n].level==o&&t[n].cols&&t[n].cols.indexOf(e)>-1)return t[n];return!1},m=function(){for(var e=[],o=0,n=t.length;o<n;o++)t[o].cols instanceof Array&&e.push(t[o]);return e},w=function(e){for(var o=[],n=0,i=t.length;n<i;n++)t[n].cols&&t[n].level===e&&o.push(t[n]);return o},v=function(){for(var e=[],o=0,n=t.length;o<n;o++)t[o].rows instanceof Array&&e.push(t[o]);return e},y=function(e){for(var o=[],n=0,i=t.length;n<i;n++)t[n].rows&&t[n].level===e&&o.push(t[n]);return o},C=function(e,t){for(var o,n=0,i=t.length;n<i;n++)if(t[n].hidden=e,o=t[n].level,r[o]||(r[o]=[]),s[o]||(s[o]=[]),t[n].rows)for(var l=0,a=t[n].rows.length;l<a;l++)r[o][t[n].rows[l]]=e>0||void 0;else if(t[n].cols){l=0;for(var c=t[n].cols.length;l<c;l++)s[o][t[n].cols[l]]=e>0||void 0}},b=function(e,t,n,i){var r,s;switch(e){case"rows":r=p(t+1,n).id,s=o.Grouping.getGroupLevelsByRows();break;case"cols":r=g(t+1,n).id,s=o.Grouping.getGroupLevelsByCols()}return!!(s[t+1]&&s[t+1].indexOf(n)>-1&&i==r)},S=function(e,t,n,i){var r,s;switch(e){case"rows":r=p(t-1,n).id,s=o.Grouping.getGroupLevelsByRows();break;case"cols":r=g(t-1,n).id,s=o.Grouping.getGroupLevelsByCols()}return!!(s[t-1]&&s[t-1].indexOf(n)>-1&&i==r)},R=function(e){for(var t=v(),o=m(),n=0,i=t.length;n<i;n++)if(t[n].rows.indexOf(e.row)>-1&&t[n].hidden)return!0;if(null===e.col)return!1;n=0;for(var r=o.length;n<r;n++)if(o[n].cols.indexOf(e.col)>-1&&o[n].hidden)return!0;return!1};return{getGroups:function(){return t},getLevels:function(){return i},instance:e,baseSpareRows:e.getSettings().minSpareRows,baseSpareCols:e.getSettings().minSpareCols,getRowGroups:v,getColGroups:m,init:function(){var t=e.getSettings().groups;t&&t instanceof Array&&o.Grouping.initGroups(t)},initGroups:function(e){t=[],e.forEach((function(e){var o=[],r=!1,s=!1;e.rows instanceof Array?(o=e.rows,r=!0):e.cols instanceof Array&&(o=e.cols,s=!0);var l=o[0],u=o[o.length-1];r?function(e,o){var r,s,l=(r=h("rows",e,o).groups,s=0,r.length&&r.forEach((function(e){if((e=e.filter((function(e){return e.rows}))).length){var t=e.sort(a("level","desc"))[0].level;s<t&&(s=t)}})),s);i.rows=Math.max(i.rows,l+1),n.rows||(n.rows=v().length),n.rows++,t.push({id:"r"+n.rows,level:l+1,rows:c(e,o),hidden:0})}(l,u):s&&function(e,o){var r,s,l=(r=h("cols",e,o).groups,s=0,r.length&&r.forEach((function(e){if((e=e.filter((function(e){return e.cols}))).length){var t=e.sort(a("level","desc"))[0].level;s<t&&(s=t)}})),s);l===i.cols?i.cols++:l>i.cols&&(i.cols=l+1),n.cols||(n.cols=m().length),n.cols++,t.push({id:"c"+n.cols,level:l+1,cols:c(e,o),hidden:0})}(l,u)}))},resetGroups:function(){var e;for(var r in t=[],n={rows:0,cols:0},i={rows:0,cols:0},l)if("function"!=typeof l[r])for(var s=0,a=(e=document.querySelectorAll("."+l[r])).length;s<a;s++)o.Dom.removeClass(e[s],l[r]);for(var c=["htGroupColClosest","htGroupCol"],h=(r=0,c.length);r<h;r++)for(s=0,a=(e=document.querySelectorAll("."+c[r])).length;s<a;s++)o.Dom.removeClass(e[s],c[r])},updateGroups:function(){var e=this.getSettings().groups;o.Grouping.resetGroups(),o.Grouping.initGroups(e)},afterGetRowHeader:function(e,t){for(var n=!1,i=0,s=r.length;i<s;i++)r[i]&&!0===r[i][e]&&(n=!0);n?o.Dom.addClass(t.parentNode,"hidden"):!n&&o.Dom.hasClass(t.parentNode,"hidden")&&o.Dom.removeClass(t.parentNode,"hidden")},afterGetColHeader:function(t,n){var i=this.view.wt.wtSettings.getSetting("rowHeaders").length,r=e.rootElement[0].querySelectorAll("colgroup col:nth-child("+parseInt(t+i+1,10)+")");if(0!==r.length){for(var l=!1,a=0,c=s.length;a<c;a++)s[a]&&!0===s[a][t]&&(l=!0);if(l){a=0;for(var h=r.length;a<h;a++)o.Dom.addClass(r[a],"hidden")}else if(!l&&o.Dom.hasClass(r[0],"hidden"))for(a=0,h=r.length;a<h;a++)o.Dom.removeClass(r[a],"hidden")}},groupIndicatorsFactory:function(t,a){var c,h,u,d,m,w;switch(a){case"horizontal":c=o.Grouping.getGroupLevelsByCols(),h=function(e,t){return g(e,t).id},u="cols",d=function(e,t){return g(e-1,t)},m=function(e){if(1===e.length){var t=e[0];e[0]=function(e,n,i){e<-1?y()(e,n,i):(o.Dom.removeClass(n,l.groupIndicatorContainer),t(e,n,i))}}return function(){return e}},w=!0;break;case"vertical":c=o.Grouping.getGroupLevelsByRows(),h=function(e,t){return p(e,t).id},u="rows",d=function(e,t){return p(e-1,t)},m=function(e){return e}}var v=function(e){var t=document.createElement("div");return e.appendChild(t),{button:t,addClass:function(e){o.Dom.addClass(t,e)}}},y=function(){var t=a.charAt(0).toUpperCase()+a.slice(1);return function(n,a,m){var y,C;for(m++;y=a.lastChild;)a.removeChild(y);o.Dom.addClass(a,l.groupIndicatorContainer);var R=h(n,m);if(n>-1&&c[n]&&c[n].indexOf(m)>-1&&((C=v(a)).addClass(l.groupIndicator(t)),function(t,n,l,a){var c,h,u,d=f(a),p=!1,g=function(e){for(var t=!1,o="rows"==e?r:s,l=0;l<=i[e];l++){for(u=n;d[e].indexOf(u)>-1;)t=!(!o[l]||!o[l][u]),u--;if(t)break}return t},m=S(t,n,l,a),w=b(t,n,l,a);switch(t){case"rows":c=o.Grouping.getGroupLevelsByRows(),h=e.countRows(),p=g(t);break;case"cols":c=o.Grouping.getGroupLevelsByCols(),h=e.countCols(),p=g(t)}if(n==h-1)return!1;if(0==n){if(w)return!0}else if(!m||m&&p){if(w)return!0}else if(!c[n-1]&&w)return!0;return!1}(u,n,m,R)&&C.addClass(l.groupStart),function(t,n,l,a){if(0===n)return!1;var c,h,u=S(t,n,l,a),d=b(t,n,l,a),f=!1;switch(t){case"rows":c=o.Grouping.getGroupLevelsByRows(),h=e.countRows();for(var p=0;p<=i.rows;p++)if(r[p]&&r[p][n+1]){f=!0;break}break;case"cols":for(c=o.Grouping.getGroupLevelsByCols(),h=e.countCols(),p=0;p<=i.cols;p++)if(s[p]&&s[p][n+1]){f=!0;break}}if(u){if(n==h-1)return!0;if(!d||d&&f)return!0;if(!c[n+1])return!0}return!1}(u,n,m,R)&&(C.button.appendChild(document.createTextNode("-")),C.addClass(l.collapseButton),C.button.id=l.collapseGroupId(R),C.button.setAttribute("data-level",m),C.button.setAttribute("data-type",u))),w){var T=o.Dom.index(a.parentNode);if(-1===n||n<-1&&T===o.Grouping.getLevels().cols+1||0==T&&0==o.Grouping.getLevels().cols)if((C=v(a)).addClass(l.levelTrigger),-1===n)C.button.id=l.collapseFromLevel("Cols",m),C.button.appendChild(document.createTextNode(m));else if(n<-1&&T===o.Grouping.getLevels().cols+1||0==T&&0==o.Grouping.getLevels().cols){var E=o.Dom.index(a)+1;C.button.id=l.collapseFromLevel("Rows",E),C.button.appendChild(document.createTextNode(E))}}var k=function(e,t,n,i,r){var s;switch(e){case"rows":s=p(t-1,n).id;break;case"cols":s=g(t-1,n).id}if(!s)return null;if(t>0&&S(e,t-1,n,s)&&s!=i){var a=document.createElement("DIV");return o.Dom.addClass(a,l.expandButton),a.id="htExpand-"+s,a.appendChild(document.createTextNode("+")),a.setAttribute("data-level",n),a.setAttribute("data-type",e),a.setAttribute("data-hidden","1"),r.appendChild(a),a}return null}(u,n,m,R,a);if(n>0){var D=d(n-1,m);k&&D.hidden&&o.Dom.addClass(k,l.clickable)}x()}};if(t=m(t),n[u]>0)for(var C=0;C<i[u]+1;C++)t instanceof Array||(t="function"==typeof t?t():new Array(t)),t.unshift(y())},getGroupLevelsByRows:function(){for(var e=v(),t=[],o=0,n=e.length;o<n;o++)if(e[o].rows)for(var i=0,r=e[o].rows.length;i<r;i++)t[e[o].rows[i]]||(t[e[o].rows[i]]=[]),t[e[o].rows[i]].push(e[o].level);return t},getGroupLevelsByCols:function(){for(var e=m(),t=[],o=0,n=e.length;o<n;o++)if(e[o].cols)for(var i=0,r=e[o].cols.length;i<r;i++)t[e[o].cols[i]]||(t[e[o].cols[i]]=[]),t[e[o].cols[i]].push(e[o].level);return t},toggleGroupVisibility:function(t,n,a){if(o.Dom.hasClass(t.target,l.expandButton)||o.Dom.hasClass(t.target,l.collapseButton)||o.Dom.hasClass(t.target,l.levelTrigger)){var c,h,u,d=t.target,p=d.id.split("-"),g=[];if(d.className.indexOf(l.levelTrigger)>-1){for(var m,v=[],b=[],S=d.id.indexOf("Rows")>-1?"rows":"cols",R=1,T=i[S];R<=T;R++)if(m="rows"==S?y(R):w(R),R>=parseInt(p[1],10))for(var E=0,k=m.length;E<k;E++)b.push(m[E]);else for(E=0,k=m.length;E<k;E++)v.push(m[E]);C(!0,b),C(!1,v)}else c=(p=d.id.split("-"))[1],parseInt(d.getAttribute("data-level"),10),h=d.getAttribute("data-type"),u=parseInt(d.getAttribute("data-hidden")),u=isNaN(u)?1:u?0:1,d.setAttribute("data-hidden",u.toString()),g.push(f(c)),C(u,g);var D=function(t){var o;switch(t){case"rows":o=i.rows;for(var n=0;n<=o;n++)if(r[n]&&r[n][e.countRows()-1])return!0;break;case"cols":for(o=i.cols,n=0;n<=o;n++)if(s[n]&&s[n][e.countCols()-1])return!0}return!1}(h=h||S),A=h.charAt(0).toUpperCase()+h.slice(1),x=o.Grouping["baseSpare"+A];D?0==x&&(e.alter("insert_"+h.slice(0,-1),e["count"+A]()),o.Grouping["dummy"+h.slice(0,-1)]=!0):0==x&&o.Grouping["dummy"+h.slice(0,-1)]&&(e.alter("remove_"+h.slice(0,-1),e["count"+A]()-1),o.Grouping["dummy"+h.slice(0,-1)]=!1),e.render(),t.stopImmediatePropagation()}},modifySelectionFactory:function(e){var t,o=this.instance,n=new M(0,0),i=function(e,t){var o=0;switch(e){case"down":for(;R(t);)o++,t.row+=1;break;case"up":for(;R(t);)o--,t.row-=1;break;case"right":for(;R(t);)o++,t.col+=1;break;case"left":for(;R(t);)o--,t.col-=1}return o},r=function(e,t){e.row>0?R(t)&&(e.row+=i("down",t)):e.row<0&&R(t)&&(e.row+=i("up",t)),e.col>0?R(t)&&(e.col+=i("right",t)):e.col<0&&R(t)&&(e.col+=i("left",t))};switch(e){case"start":return function(e){t=o.getSelected(),n.row=t[0]+e.row,n.col=t[1]+e.col,r(e,n)};case"end":return function(e){t=o.getSelected(),n.row=t[2]+e.row,n.col=t[3]+e.col,r(e,n)}}},modifyRowHeight:function(t,o){if(e.view.wt.wtTable.rowFilter&&R({row:o,col:null}))return 0},validateGroups:function(){for(var t=function(e,t){if(e[0]<t[0]&&e[1]<t[1]&&t[0]<=e[1]||e[0]>t[0]&&t[1]<e[1]&&e[0]<=t[1])return!0},o=e.getSettings().groups,n=[],i=[],r=0,s=o.length;r<s;r++)if(o[r].rows){if(1===o[r].rows.length)throw new Error("Grouping error:  Group {"+o[r].rows[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[r].rows.length)throw new Error("Grouping error:  Cannot define empty groups.");i.push(o[r].rows);for(var l=0,a=i.length;l<a;l++)if(t(o[r].rows,i[l]))throw new Error("Grouping error:  ranges {"+o[r].rows[0]+", "+o[r].rows[1]+"} and {"+i[l][0]+", "+i[l][1]+"} are overlapping.")}else if(o[r].cols){if(1===o[r].cols.length)throw new Error("Grouping error:  Group {"+o[r].cols[0]+"} is invalid. Cannot define single-entry groups.");if(0===o[r].cols.length)throw new Error("Grouping error:  Cannot define empty groups.");n.push(o[r].cols),l=0;for(var c=n.length;l<c;l++)if(t(o[r].cols,n[l]))throw new Error("Grouping error:  ranges {"+o[r].cols[0]+", "+o[r].cols[1]+"} and {"+n[l][0]+", "+n[l][1]+"} are overlapping.")}return!0},afterGetRowHeaderRenderers:function(e){o.Grouping.groupIndicatorsFactory(e,"vertical")},afterGetColumnHeaderRenderers:function(e){o.Grouping.groupIndicatorsFactory(e,"horizontal")},hookProxy:function(t,n){return function(){return e.getSettings().groups?n?o.Grouping[t](n).apply(this,arguments):o.Grouping[t].apply(this,arguments):void 0}}}},x=(y=function(){var e=this;if(e.getSettings().groups){var t={};if(o.Grouping=new A(e),e.getSettings().rowHeaders||(t.rowHeaders=!0),e.getSettings().colHeaders||(t.colHeaders=!0),(t.colHeaders||t.rowHeaders)&&e.updateSettings(t),!o.Grouping.validateGroups())return;e.addHook("beforeInit",o.Grouping.hookProxy("init")),e.addHook("afterUpdateSettings",o.Grouping.hookProxy("updateGroups")),e.addHook("afterGetColumnHeaderRenderers",o.Grouping.hookProxy("afterGetColumnHeaderRenderers")),e.addHook("afterGetRowHeaderRenderers",o.Grouping.hookProxy("afterGetRowHeaderRenderers")),e.addHook("afterGetRowHeader",o.Grouping.hookProxy("afterGetRowHeader")),e.addHook("afterGetColHeader",o.Grouping.hookProxy("afterGetColHeader")),e.addHook("beforeOnCellMouseDown",o.Grouping.hookProxy("toggleGroupVisibility")),e.addHook("modifyTransformStart",o.Grouping.hookProxy("modifySelectionFactory","start")),e.addHook("modifyTransformEnd",o.Grouping.hookProxy("modifySelectionFactory","end")),e.addHook("modifyRowHeight",o.Grouping.hookProxy("modifyRowHeight"))}},function(){for(var e=document.querySelectorAll("colgroup"),t=0,n=e.length;t<n;t++){var i=e[t].querySelectorAll("col.rowHeader");if(0==i.length)return;for(var r=0,s=i.length+1;r<s;r++){if(2==s)return;r<o.Grouping.getLevels().rows+1&&(r==o.Grouping.getLevels().rows?o.Dom.addClass(i[r],"htGroupColClosest"):o.Dom.addClass(i[r],"htGroupCol"))}}});function H(){}function O(e){this.instance=e}function P(t,o){var n;if(o){this.instance=t,this.settings=o,this.main=document.createElement("div"),(n=this.main.style).position="absolute",n.top=0,n.left=0;for(var i=["top","left","bottom","right","corner"],r=0;r<5;r++){var s=i[r],l=document.createElement("DIV");l.className="wtBorder "+(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),(n=l.style).backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:o.border.color,n.height=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":o.border.width+"px",n.width=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":o.border.width+"px",this.main.appendChild(l)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="5px",this.cornerStyle.height="5px",this.cornerStyle.border="2px solid #FFF",this.disappear(),t.wtTable.bordersHolder||(t.wtTable.bordersHolder=document.createElement("div"),t.wtTable.bordersHolder.className="htBorders",t.wtTable.hider.appendChild(t.wtTable.bordersHolder)),t.wtTable.bordersHolder.insertBefore(this.main,t.wtTable.bordersHolder.firstChild);var a=!1,c=e(document.body);c.on("mousedown.walkontable."+t.guid,(function(){a=!0})),c.on("mouseup.walkontable."+t.guid,(function(){a=!1})),e(this.main.childNodes).on("mouseenter",(function(o){if(a&&t.getSetting("hideBorderOnMouseDownOver")){o.preventDefault(),o.stopImmediatePropagation();var n=this.getBoundingClientRect(),i=e(this);i.hide(),c.on("mousemove.border."+t.guid,(function(e){(function(e){return e.clientY<Math.floor(n.top)||e.clientY>Math.ceil(n.top+n.height)||e.clientX<Math.floor(n.left)||e.clientX>Math.ceil(n.left+n.width)||void 0})(e)&&(c.off("mousemove.border."+t.guid),i.show())}))}}))}}function M(e,t){void 0!==e&&void 0!==t?(this.row=e,this.col=t):(this.row=null,this.col=null)}function N(e,t,o){this.highlight=e,this.from=t,this.to=o}function I(e,t){this.total=e,this.countTH=t}function L(e,t,o,n){var i,r=0;for(O.apply(this,arguments),this.containerSizeFn=t,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.visibleCellCount=0,this.remainingSize=0,this.strategy=n;void 0!==(i=o(r));)this.cellSizesSum<this.getContainerSize(this.cellSizesSum+i)&&this.visibleCellCount++,this.cellSizes.push(i),this.cellSizesSum+=i,this.cellCount++,r++;var s=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-s}function B(e){var t=[];if(this.guid="wt_"+_(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new Q(this,e.table),this.wtScroll=new j(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new V(this),this.selections=this.cloneSource.selections):(this.wtSettings=new Y(this,e),this.wtTable=new Q(this,e.table),this.wtScroll=new j(this),this.wtViewport=new Z(this),this.wtEvent=new V(this),this.selections=this.getSetting("selections"),this.wtScrollbars=new $(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,n){o.Dom.fastInnerText(n,t[e])}])}this.drawn=!1,this.drawInterrupted=!1}function W(t){this.instance=t,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",this.lastTimeout=null;var n=this,i=0,r=0,s=n.clone.wtTable.holder.parentNode;e(document.body).on("mousemove."+this.instance.guid,(function(e){n.instance.wtTable.holder.parentNode&&(e.clientX-i>-5&&e.clientX-i<5&&e.clientY-r>-5&&e.clientY-r<5||(i=e.clientX,r=e.clientY,o.Dom.addClass(s,"wtDebugHidden"),o.Dom.removeClass(s,"wtDebugVisible"),clearTimeout(this.lastTimeout),this.lastTimeout=setTimeout((function(){o.Dom.removeClass(s,"wtDebugHidden"),o.Dom.addClass(s,"wtDebugVisible")}),1e3)))}))}function V(n){var i=this;this.instance=n;var r,s=[null,null];this.dblClickTimeout=[null,null],e(this.instance.wtTable.holder).on("mousedown",(function(e){var t=i.parentCell(e.target);o.Dom.hasClass(e.target,"corner")?i.instance.getSetting("onCellCornerMouseDown",e,e.target):t.TD&&i.instance.hasSetting("onCellMouseDown")&&i.instance.getSetting("onCellMouseDown",e,t.coords,t.TD,i.instance),2!==e.button&&t.TD&&(s[0]=t.TD,clearTimeout(i.dblClickTimeout[0]),i.dblClickTimeout[0]=setTimeout((function(){s[0]=null}),1e3))})),e(this.instance.wtTable.TABLE).on("mouseover",(function(e){if(i.instance.hasSetting("onCellMouseOver")){var t=i.instance.wtTable.TABLE,n=o.Dom.closest(e.target,["TD","TH"],t);n&&n!==r&&o.Dom.isChildOf(n,t)&&(r=n,i.instance.getSetting("onCellMouseOver",e,i.instance.wtTable.getCoords(n),n,i.instance))}})),e(this.instance.wtTable.holder).on("mouseup",(function(e){if(2!==e.button){var t=i.parentCell(e.target);t.TD===s[0]&&t.TD===s[1]?(o.Dom.hasClass(e.target,"corner")?i.instance.getSetting("onCellCornerDblClick",e,t.coords,t.TD,i.instance):i.instance.getSetting("onCellDblClick",e,t.coords,t.TD,i.instance),s[0]=null,s[1]=null):t.TD===s[0]&&(s[1]=t.TD,clearTimeout(i.dblClickTimeout[1]),i.dblClickTimeout[1]=setTimeout((function(){s[1]=null}),500))}})),e(t).on("resize."+this.instance.guid,(function(){i.instance.draw()}))}function _(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}if(o.hooks.add("beforeInit",y),o.hooks.add("afterUpdateSettings",(function(){this.getSettings().groups&&!o.Grouping?y.call(this,arguments):!this.getSettings().groups&&o.Grouping&&(o.Grouping.resetGroups(),o.Grouping=void 0)})),o.plugins.Grouping=A,function(t){function o(){this.zeroClipboardInstance=null,this.instance=null}o.prototype.prepareZeroClipboard=function(){this.swfPath&&ZeroClipboard.config({swfPath:this.swfPath})},o.prototype.copy=function(){return this.instance.copyPaste.setCopyableText(),this.instance.copyPaste.copyPasteInstance.elTextarea.value},o.prototype.addToContextMenu=function(e){this.getSettings().contextMenuCopyPaste&&e.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},t.ContextMenu.SEPARATOR)},o.prototype.setupZeroClipboard=function(e){var o=this;if(this.cmInstance=e,t.Dom.hasClass(this.cmInstance.rootElement[0],"htContextMenu"))for(var i=e.getData(),r=0,s=i.length;r<s;r++)if("copy"===i[r].key){this.zeroClipboardInstance=new ZeroClipboard(e.getCell(r,0)),this.zeroClipboardInstance.off(),this.zeroClipboardInstance.on("copy",(function(e){e.clipboardData.setData("text/plain",o.copy()),o.instance.getSettings().outsideClickDeselects=o.outsideClickDeselectsCache})),n.bindEvents();break}},o.prototype.bindEvents=function(){var o=this;o.cmInstance&&(e(document).off("mouseenter."+o.cmInstance.guid).on("mouseenter."+o.cmInstance.guid,"#global-zeroclipboard-flash-bridge",(function(e){var n=o.cmInstance.rootElement[0].querySelector("td.current");n&&t.Dom.removeClass(n,"current"),o.outsideClickDeselectsCache=o.instance.getSettings().outsideClickDeselects,o.instance.getSettings().outsideClickDeselects=!1})),e(document).off("mouseleave."+o.cmInstance.guid).on("mouseleave."+o.cmInstance.guid,"#global-zeroclipboard-flash-bridge",(function(e){var n=o.cmInstance.rootElement[0].querySelector("td.zeroclipboard-is-hover");n&&t.Dom.removeClass(n,"zeroclipboard-is-hover"),o.instance.getSettings().outsideClickDeselects=o.outsideClickDeselectsCache})))},o.prototype.init=function(){if(this.getSettings().contextMenuCopyPaste){if("object"==typeof this.getSettings().contextMenuCopyPaste&&(n.swfPath=this.getSettings().contextMenuCopyPaste.swfPath),"undefined"==typeof ZeroClipboard)throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){if(void 0===navigator.mimeTypes["application/x-shockwave-flash"])throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}n.instance=this,n.prepareZeroClipboard()}};var n=new o;t.hooks.add("afterRender",(function(){n.setupZeroClipboard(this)})),t.hooks.add("afterInit",n.init),t.hooks.add("afterContextMenuDefaultOptions",n.addToContextMenu),t.ContextMenuCopyPaste=o}(o),H.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.scrollHandler=this.getScrollableElement(this.TABLE),this.$scrollHandler=e(this.scrollHandler)},H.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.overflow="hidden";var o=document.createElement("TABLE");return o.className=this.instance.wtTable.TABLE.className,t.appendChild(o),this.instance.wtTable.holder.parentNode.appendChild(t),new B({cloneSource:this.instance,cloneOverlay:this,table:o})},H.prototype.getScrollableElement=function(e){for(var o=e.parentNode;o&&o.style;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;if(this instanceof K&&"visible"!==o.style.overflowX&&""!==o.style.overflowX)return o;o=o.parentNode}return t},H.prototype.refresh=function(e){this.clone&&this.clone.draw(e)},H.prototype.destroy=function(){this.$scrollHandler.off("."+this.clone.guid),e(t).off("."+this.clone.guid),e(document).off("."+this.clone.guid),e(document.body).off("."+this.clone.guid)},O.prototype.getSize=function(e){return this.cellSizes[e]},O.prototype.getContainerSize=function(e){return"function"==typeof this.containerSizeFn?this.containerSizeFn(e):this.containerSizeFn},O.prototype.countVisible=function(){return this.cellCount},O.prototype.isLastIncomplete=function(){return this.remainingSize>0},P.prototype.appear=function(e){var t,n,i,r,s,l,a,c,h,u,d,f;if(!this.disabled){var p,g,m,w,v,y,C,b=this.instance;for(y=b.cloneOverlay instanceof X||b.cloneOverlay instanceof U?b.getSetting("fixedRowsTop"):b.wtTable.getRowStrategy().countVisible(),v=0;v<y;v++)if((C=b.wtTable.rowFilter.visibleToSource(v))>=e[0]&&C<=e[2]){p=C;break}for(v=y-1;v>=0;v--)if((C=b.wtTable.rowFilter.visibleToSource(v))>=e[0]&&C<=e[2]){m=C;break}for(y=b.cloneOverlay instanceof K||b.cloneOverlay instanceof U?b.getSetting("fixedColumnsLeft"):b.wtTable.getColumnStrategy().cellCount,v=0;v<y;v++)if((C=b.wtTable.columnFilter.visibleToSource(v))>=e[1]&&C<=e[3]){g=C;break}for(v=y-1;v>=0;v--)if((C=b.wtTable.columnFilter.visibleToSource(v))>=e[1]&&C<=e[3]){w=C;break}if(void 0!==p&&void 0!==g){t=p!==m||g!==w,n=b.wtTable.getCell(new M(p,g)),i=t?b.wtTable.getCell(new M(m,w)):n,r=o.Dom.offset(n),s=t?o.Dom.offset(i):r,l=o.Dom.offset(b.wtTable.TABLE),c=r.top,d=s.top+o.Dom.outerHeight(i)-c,u=r.left,f=s.left+o.Dom.outerWidth(i)-u,a=c-l.top-1,h=u-l.left-1;var S=o.Dom.getComputedStyle(n);parseInt(S.borderTopWidth,10)>0&&(a+=1,d=d>0?d-1:0),parseInt(S.borderLeftWidth,10)>0&&(h+=1,f=f>0?f-1:0),this.topStyle.top=a+"px",this.topStyle.left=h+"px",this.topStyle.width=f+"px",this.topStyle.display="block",this.leftStyle.top=a+"px",this.leftStyle.left=h+"px",this.leftStyle.height=d+"px",this.leftStyle.display="block";var R=Math.floor(this.settings.border.width/2);this.bottomStyle.top=a+d-R+"px",this.bottomStyle.left=h+"px",this.bottomStyle.width=f+"px",this.bottomStyle.display="block",this.rightStyle.top=a+"px",this.rightStyle.left=h+f-R+"px",this.rightStyle.height=d+1+"px",this.rightStyle.display="block",this.hasSetting(this.settings.border.cornerVisible)?(this.cornerStyle.top=a+d-4+"px",this.cornerStyle.left=h+f-4+"px",this.cornerStyle.display="block"):this.cornerStyle.display="none"}else this.disappear()}},P.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none"},P.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},M.prototype.isValid=function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))},M.prototype.isEqual=function(e){return e===this||this.row===e.row&&this.col===e.col},M.prototype.isSouthEastOf=function(e){return this.row>=e.row&&this.col>=e.col},M.prototype.isNorthWestOf=function(e){return this.row<=e.row&&this.col<=e.col},M.prototype.isSouthWestOf=function(e){return this.row>=e.row&&this.col<=e.col},M.prototype.isNorthEastOf=function(e){return this.row<=e.row&&this.col>=e.col},t.WalkontableCellCoords=M,N.prototype.isValid=function(e){return this.from.isValid(e)&&this.to.isValid(e)},N.prototype.isSingle=function(){return this.from.row===this.to.row&&this.from.col===this.to.col},N.prototype.includes=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return e.row<0&&(e.row=0),e.col<0&&(e.col=0),t.row<=e.row&&o.row>=e.row&&t.col<=e.col&&o.col>=e.col},N.prototype.includesRange=function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},N.prototype.isEqual=function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},N.prototype.overlaps=function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},N.prototype.isSouthEastOf=function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},N.prototype.isNorthWestOf=function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},N.prototype.expand=function(e){var t=this.getTopLeftCorner(),o=this.getBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>o.row||e.col>o.col)&&(this.from=new M(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new M(Math.max(o.row,e.row),Math.max(o.col,e.col)),!0)},N.prototype.expandByRange=function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),i=e.getBottomRightCorner(),r=Math.min(t.row,n.row),s=Math.min(t.col,n.col),l=Math.max(o.row,i.row),a=Math.max(o.col,i.col),c=new M(r,s),h=new M(l,a),u=new N(c,c,h).isCorner(this.from,e),d=e.isEqual(new N(c,c,h));return u&&!d&&(this.from.col>c.col&&(c.col=a,h.col=s),this.from.row>c.row&&(c.row=l,h.row=r)),this.from=c,this.to=h,!0},N.prototype.getDirection=function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},N.prototype.setDirection=function(e){switch(e){case"NW-SE":this.from=this.getTopLeftCorner(),this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner(),this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner(),this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},N.prototype.getTopLeftCorner=function(){return new M(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},N.prototype.getBottomRightCorner=function(){return new M(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},N.prototype.getTopRightCorner=function(){return new M(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},N.prototype.getBottomLeftCorner=function(){return new M(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},N.prototype.isCorner=function(e,t){return!!(t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new M(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new M(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new M(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new M(t.to.row,t.to.col))))||e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())},N.prototype.getOppositeCorner=function(e,t){if(!(e instanceof M))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new M(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new M(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new M(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new M(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},N.prototype.getBordersSharedWith=function(e){if(!this.includesRange(e))return[];var t=Math.min(this.from.row,this.to.row),o=Math.max(this.from.row,this.to.row),n=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),r=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),l=Math.min(e.from.col,e.to.col),a=Math.max(e.from.col,e.to.col),c=[];return t==r&&c.push("top"),i==a&&c.push("right"),o==s&&c.push("bottom"),n==l&&c.push("left"),c},N.prototype.getInner=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||o.push(new M(n,i));return o},N.prototype.getAll=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),o=[],n=e.row;n<=t.row;n++)for(var i=e.col;i<=t.col;i++)e.row===n&&e.col===i?o.push(e):t.row===n&&t.col===i?o.push(t):o.push(new M(n,i));return o},N.prototype.forAll=function(e){for(var t=this.getTopLeftCorner(),o=this.getBottomRightCorner(),n=t.row;n<=o.row;n++)for(var i=t.col;i<=o.col;i++)if(!1===e(n,i))return},t.WalkontableCellRange=N,I.prototype.visibleToSource=function(e){return e},I.prototype.sourceToVisible=function(e){return e},I.prototype.offsettedTH=function(e){return e-this.countTH},I.prototype.unOffsettedTH=function(e){return e+this.countTH},I.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.visibleToSource(this.offsettedTH(e))},I.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToVisible(e))},L.prototype=new O,L.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)},L.prototype.stretch=function(){var e,t=0;if(e=this.instance.wtTable.allRowsInViewport()?this.getContainerSize():this.getContainerSize(1/0),this.remainingSize=this.cellSizesSum-e,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var o,n=e/this.cellSizesSum;t<this.cellCount-1;)o=Math.floor(n*this.cellSizes[t]),this.remainingSize+=o-this.cellSizes[t],this.cellStretch[t]=o-this.cellSizes[t],t++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&e!==1/0&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},L.prototype.countVisible=function(){return this.visibleCellCount},L.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getFirstVisibleRow(),t=this.instance.wtTable.getLastVisibleColumn(),n=this.instance.wtTable.getCell(new M(e,t)),i=o.Dom.offset(n),r=o.Dom.outerWidth(n),s=i.left+r;return this.instance.wtScrollbars.vertical.getScrollPosition()+this.instance.wtViewport.getViewportWidth()>=s},B.prototype.draw=function(e){if(this.drawInterrupted=!1,e||o.Dom.isVisible(this.wtTable.TABLE)){e=e&&this.getSetting("offsetRow")===this.lastOffsetRow,this.lastOffsetRow=this.getSetting("offsetRow");var t=this.getSetting("totalRows");return this.lastOffsetRow>t&&t>0&&(this.scrollVertical(-1/0),this.scrollViewport(new M(t-1,0))),this.wtTable.draw(e),this}this.drawInterrupted=!0},B.prototype.update=function(e,t){return this.wtSettings.update(e,t)},B.prototype.scrollVertical=function(e){var t=this.wtScroll.scrollVertical(e);return this.getSetting("onScrollVertically"),t},B.prototype.scrollHorizontal=function(e){var t=this.wtScroll.scrollHorizontal(e);return this.getSetting("onScrollHorizontally"),t},B.prototype.scrollViewport=function(e){return this.wtScroll.scrollViewport(e),this},B.prototype.getViewport=function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},B.prototype.getSetting=function(e,t,o,n,i){return this.wtSettings.getSetting(e,t,o,n,i)},B.prototype.hasSetting=function(e){return this.wtSettings.has(e)},B.prototype.destroy=function(){e(t).off("."+this.guid),e(document.body).off("."+this.guid),this.wtScrollbars.destroy(),this.wtEvent&&this.wtEvent.destroy()},W.prototype=new H,W.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=this.instance.wtTable.holder.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px",e.style.left=Math.ceil(t.left,10)+"px"}},W.prototype.destroy=function(){H.prototype.destroy.call(this),clearTimeout(this.lastTimeout)},V.prototype.parentCell=function(e){var t={},n=this.instance.wtTable.TABLE,i=o.Dom.closest(e,["TD","TH"],n);return i&&o.Dom.isChildOf(i,n)?(t.coords=this.instance.wtTable.getCoords(i),t.TD=i):o.Dom.hasClass(e,"wtBorder")&&o.Dom.hasClass(e,"current")?(t.coords=this.instance.selections[0].cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):o.Dom.hasClass(e,"wtBorder")&&o.Dom.hasClass(e,"area")&&(t.coords=this.instance.selections[1].cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t},V.prototype.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1])},t.requestAnimFrame=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e,o){return t.setTimeout(e,1e3/60)},t.cancelRequestAnimFrame=t.cancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||clearTimeout,t.getComputedStyle||(D={getPropertyValue:function(e){return"float"==e&&(e="styleFloat"),k.currentStyle[e.toUpperCase()]||null}},t.getComputedStyle=function(e){return k=e,D}),!String.prototype.trim){var F=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(F,"")}}function z(e,t,o){this.offset=e,this.total=t,this.countTH=o}function G(e,t,o){O.apply(this,arguments),this.containerSizeFn=t,this.sizeAtIndex=o,this.cellSizesSum=0,this.cellSizes=[],this.cellCount=0,this.visiblCellCount=0,this.remainingSize=-1/0,this.maxOuts=10,this.curOuts=this.maxOuts}function j(e){this.instance=e}function U(e){this.instance=e,this.type="corner",this.init(),this.clone=this.makeClone("corner")}function K(e){this.instance=e,this.type="horizontal",this.cellSize=50,this.offset=0,this.init(),this.clone=this.makeClone("left")}function X(e){this.instance=e,this.type="vertical",this.cellSize=this.instance.wtSettings.settings.defaultRowHeight,this.offset,this.total,this.init(),this.clone=this.makeClone("top")}function $(e){this.instance=e,e.update("scrollbarWidth",o.Dom.getScrollbarWidth()),e.update("scrollbarHeight",o.Dom.getScrollbarWidth()),this.vertical=new X(e),this.horizontal=new K(e),this.corner=new U(e),e.getSetting("debug")&&(this.debug=new W(e)),this.registerListeners()}function q(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={}}function Y(e,t){var n=this;for(var i in this.instance=e,this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(e,t,i){var r=n.getSetting("data",e,t);o.Dom.fastInnerText(i,null==r?"":r)},columnWidth:50,rowHeight:function(e){return 23},defaultRowHeight:23,selections:null,hideBorderOnMouseDownOver:!1,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1},this.settings={},this.defaults)if(this.defaults.hasOwnProperty(i))if(void 0!==t[i])this.settings[i]=t[i];else{if(void 0===this.defaults[i])throw new Error('A required setting "'+i+'" was not provided');this.settings[i]=this.defaults[i]}}function Q(e,t){this.instance=e,this.TABLE=t,o.Dom.removeTextNodes(this.TABLE);var n=this.TABLE.parentNode;if(!n||1!==n.nodeType||!o.Dom.hasClass(n,"wtHolder")){var i=document.createElement("DIV");i.className="wtSpreader",n&&n.insertBefore(i,this.TABLE),i.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,!(n=this.spreader.parentNode)||1!==n.nodeType||!o.Dom.hasClass(n,"wtHolder")){var r=document.createElement("DIV");r.className="wtHider",n&&n.insertBefore(r,this.spreader),r.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",!(n=this.hider.parentNode)||1!==n.nodeType||!o.Dom.hasClass(n,"wtHolder")){var s=document.createElement("DIV");s.style.position="relative",s.className="wtHolder",e.cloneSource||(s.className+=" ht_master"),n&&n.insertBefore(s,this.hider),s.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var l=document.createElement("TR");this.THEAD.appendChild(l)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.columnWidthCache=[]}function J(e){this.wtTable=e,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.utils=J.utils}function Z(o){this.instance=o,this.resetSettings();var n=this;e(t).on("resize.walkontable."+this.instance.guid,(function(){n.clientHeight=n.getWorkspaceHeight()}))}z.prototype.offsetted=function(e){return e+this.offset},z.prototype.unOffsetted=function(e){return e-this.offset},z.prototype.visibleToSource=function(e){return this.offsetted(e)},z.prototype.sourceToVisible=function(e){return this.unOffsetted(e)},z.prototype.offsettedTH=function(e){return e-this.countTH},z.prototype.visibleColHeadedRowToSourceRow=function(e){return this.visibleToSource(this.offsettedTH(e))},z.prototype.sourceRowToVisibleColHeadedRow=function(e){return this.unOffsettedTH(this.sourceToVisible(e))},G.prototype=new O,G.prototype.add=function(e,t){if(!this.canRenderMoreRows())return!1;var o=this.sizeAtIndex(e,t);if(void 0===o)return!1;var n=this.getContainerSize(this.cellSizesSum+o);return this.cellSizes.push(o),this.cellSizesSum+=o,this.cellCount++,this.remainingSize=this.cellSizesSum-n,this.remainingSize<=o&&this.visiblCellCount++,!0},G.prototype.canRenderMoreRows=function(){return this.remainingSize<=0||this.cellCount-this.visiblCellCount<this.curOuts},G.prototype.remove=function(){var e=this.cellSizes.pop();this.cellSizesSum-=e,this.cellCount--,this.remainingSize-=e},G.prototype.removeOutstanding=function(){for(;this.cellCount-this.visiblCellCount>this.curOuts;)this.remove()},G.prototype.countRendered=function(){return this.cellCount},G.prototype.countVisible=function(){return this.visiblCellCount},G.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getLastVisibleRow(),t=this.instance.wtTable.getFirstVisibleColumn(),n=this.instance.wtTable.getCell(new M(e,t)),i=o.Dom.offset(n).top+o.Dom.outerHeight(n);return this.instance.wtScrollbars.horizontal.scrollHandler.offsetTop+this.instance.wtScrollbars.vertical.getScrollPosition()+this.instance.wtViewport.getViewportHeight()<i},j.prototype.scrollVertical=function(e){if(!this.instance.drawn)throw new Error("scrollVertical can only be called after table was drawn to DOM");var t,o=this.instance,n=o.getSetting("offsetRow"),i=o.getSetting("fixedRowsTop"),r=o.getSetting("totalRows"),s=o.wtViewport.getViewportHeight();return(t=r>0&&!this.instance.wtTable.isLastRowFullyVisible()?this.scrollLogicVertical(e,n,r,i,s,(function(e){return e-n<i&&e-n>=0?o.getSetting("rowHeight",e-n):o.getSetting("rowHeight",e)})):0)!==n&&this.instance.wtScrollbars.vertical.scrollTo(t),o},j.prototype.scrollHorizontal=function(e){return this.instance.wtScrollbars.horizontal.scrollTo(e),this.instance},j.prototype.scrollLogicVertical=function(e,t,o,n,i,r){var s=t+e;return s>=o-n&&(s=o-n-1),s<0&&(s=0),s},j.prototype.scrollViewport=function(e){if(this.instance.drawn){this.instance.getSetting("offsetRow");var t=this.instance.getSetting("totalRows"),o=this.instance.getSetting("totalColumns");if(e.row<0||e.row>t-1)throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>o-1)throw new Error("column "+e.col+" does not exist");var n=this.instance.wtTable.getCell(e);"object"==typeof n?e.col>=this.instance.getSetting("fixedColumnsLeft")&&this.scrollToRenderedCell(n):e.row>=this.instance.wtTable.getLastVisibleRow()?(this.scrollVertical(e.row-this.instance.wtTable.getLastVisibleRow()),e.row==this.instance.wtTable.getLastVisibleRow()&&this.instance.wtTable.getRowStrategy().isLastIncomplete()&&this.scrollViewport(e)):e.row>=this.instance.getSetting("fixedRowsTop")&&this.scrollVertical(e.row-this.instance.wtTable.getFirstVisibleRow())}},j.prototype.scrollToRenderedCell=function(e){var n=o.Dom.offset(e),i=o.Dom.outerWidth(e),r=o.Dom.outerHeight(e),s=o.Dom.offset(this.instance.wtTable.TABLE),l=this.instance.wtScrollbars.horizontal.getScrollPosition(),a=this.instance.wtScrollbars.vertical.getScrollPosition(),c=this.instance.wtViewport.getWorkspaceWidth(),h=this.instance.wtViewport.getWorkspaceHeight(),u=o.Dom.outerWidth(this.instance.wtScrollbars.horizontal.clone.wtTable.TABLE),d=o.Dom.outerHeight(this.instance.wtScrollbars.vertical.clone.wtTable.TABLE);if(this.instance.wtScrollbars.horizontal.scrollHandler!==t&&(s.left=0,n.left-=o.Dom.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left),this.instance.wtScrollbars.vertical.scrollHandler!==t&&(s.top=0,n.top=n.top-o.Dom.offset(this.instance.wtScrollbars.vertical.scrollHandler).top),i<c)if(n.left<l+u)this.instance.wtScrollbars.horizontal.setScrollPosition(n.left-u);else if(n.left+i>s.left+l+c){var f=n.left+i-(s.left+l+c);this.instance.wtScrollbars.horizontal.setScrollPosition(l+f)}r<h&&(n.top<a+d?(this.instance.wtScrollbars.vertical.setScrollPosition(n.top-d),this.instance.wtScrollbars.vertical.onScroll()):n.top+r>a+h&&(this.instance.wtScrollbars.vertical.setScrollPosition(n.top-h+r),this.instance.wtScrollbars.vertical.onScroll()))},U.prototype=new H,U.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===t){var n=this.instance.wtTable.holder.getBoundingClientRect(),i=Math.ceil(n.top),r=Math.ceil(n.left);e.style.left=r<0?-r+"px":"0",e.style.top=i<0?-i+"px":"0"}else e.style.top=this.instance.wtScrollbars.vertical.getScrollPosition()+"px",e.style.left=this.instance.wtScrollbars.horizontal.getScrollPosition()+"px";e.style.width=o.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px",e.style.height=o.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},K.prototype=new H,K.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===t){var n=this.instance.wtTable.holder.getBoundingClientRect(),i=Math.ceil(n.left);e.style.left=i<0?-i+"px":"0",e.style.top=this.instance.wtTable.hider.style.top}else e.style.top=this.instance.wtTable.hider.style.top,e.style.left=this.getScrollPosition()+"px";e.style.height=o.Dom.outerHeight(this.clone.wtTable.TABLE)+"px",e.style.width=o.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},K.prototype.refresh=function(e){H.prototype.refresh.call(this,e)},K.prototype.getScrollPosition=function(){return o.Dom.getScrollLeft(this.scrollHandler)},K.prototype.setScrollPosition=function(e){this.scrollHandler===t?t.scrollTo(e,o.Dom.getWindowScrollTop()):this.scrollHandler.scrollLeft=e},K.prototype.onScroll=function(){this.readSettings(),this.instance.getSetting("onScrollHorizontally")},K.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()},K.prototype.applyToDOM=function(){},K.prototype.scrollTo=function(e){this.setScrollPosition(this.getTableParentOffset()+e*this.cellSize)},K.prototype.getTableParentOffset=function(){return this.scrollHandler===t?this.instance.wtTable.holderOffset.left:0},K.prototype.readSettings=function(){this.total=this.instance.getSetting("totalColumns")},X.prototype=new H,X.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===t){var n=this.instance.wtTable.holder.getBoundingClientRect(),i=Math.ceil(n.top);e.style.left="0",e.style.top=i<0?-i+"px":"0"}else e.style.top=this.getScrollPosition()+"px",e.style.left="0";this.instance.wtScrollbars.horizontal.scrollHandler===t?e.style.width=this.instance.wtViewport.getWorkspaceActualWidth()+"px":e.style.width=o.Dom.outerWidth(this.clone.wtTable.TABLE)+"px",e.style.height=o.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},X.prototype.getScrollPosition=function(){return o.Dom.getScrollTop(this.scrollHandler)},X.prototype.setScrollPosition=function(e){this.scrollHandler===t?t.scrollTo(o.Dom.getWindowScrollLeft(),e):this.scrollHandler.scrollTop=e},X.prototype.onScroll=function(){this.readSettings(),this.instance.draw(!0),this.instance.getSetting("onScrollVertically")},X.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1},X.prototype.sumCellSizes=function(e,t){for(var o,n=0;e<t;)n+=void 0!==(o=this.instance.wtSettings.settings.rowHeight(e))?o:this.instance.wtSettings.settings.defaultRowHeight,e++;return n},X.prototype.refresh=function(e){this.applyToDOM(),H.prototype.refresh.call(this,e)},X.prototype.applyToDOM=function(){var e=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset),this.measureAfter=-1===e?0:this.sumCellSizes(e,this.total-e);var t=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=t+this.sumCellSizes(0,this.total)+4+"px",this.fixed.style.top=this.measureBefore+"px",this.fixed.style.bottom=""},X.prototype.scrollTo=function(e){var t=this.getTableParentOffset()+e*this.cellSize;this.setScrollPosition(t),this.onScroll()},X.prototype.getTableParentOffset=function(){return this.scrollHandler===t?this.instance.wtTable.holderOffset.top:0},X.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows");for(var e,t=this.getScrollPosition()-this.getTableParentOffset(),o=0,n=0;n<this.total&&!((o+=void 0!==(e=this.instance.getSetting("rowHeight",n))?e:this.instance.wtSettings.settings.defaultRowHeight)-1>t);n++);this.offset=Math.min(n,this.total),this.instance.update("offsetRow",this.offset)},$.prototype.registerListeners=function(){var o,n,i,r,s=this;function l(){s.instance.drawn&&(s.instance.wtTable.holder.parentNode?(s.vertical.windowScrollPosition=s.vertical.getScrollPosition(),s.horizontal.windowScrollPosition=s.horizontal.getScrollPosition(),s.box=s.instance.wtTable.hider.getBoundingClientRect(),s.vertical.windowScrollPosition===o&&s.horizontal.windowScrollPosition===n&&s.box.top===i&&s.box.left===r||(s.vertical.onScroll(),s.horizontal.onScroll(),o=s.vertical.windowScrollPosition,n=s.horizontal.windowScrollPosition,i=s.box.top,r=s.box.left)):s.destroy())}var a=e(t);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,l),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,l),this.vertical.scrollHandler!==t&&this.horizontal.scrollHandler!==t&&a.on("scroll."+this.instance.guid,l)},$.prototype.destroy=function(){this.vertical&&(this.vertical.destroy(),this.vertical.$scrollHandler.off("scroll."+this.instance.guid)),this.horizontal&&(this.horizontal.destroy(),this.vertical.$scrollHandler.off("scroll."+this.instance.guid)),e(t).off("scroll."+this.instance.guid),this.corner&&this.corner.destroy(),this.debug&&this.debug.destroy()},$.prototype.refresh=function(e){this.horizontal&&this.horizontal.readSettings(),this.vertical&&this.vertical.readSettings(),this.horizontal&&this.horizontal.refresh(e),this.vertical&&this.vertical.refresh(e),this.corner&&this.corner.refresh(e),this.debug&&this.debug.refresh(e)},$.prototype.applyToDOM=function(){this.horizontal&&this.horizontal.applyToDOM(),this.vertical&&this.vertical.applyToDOM()},q.prototype.getBorder=function(e){if(this.instanceBorders[e.guid])return this.instanceBorders[e.guid];this.instanceBorders[e.guid]=new P(e,this.settings)},q.prototype.isEmpty=function(){return null===this.cellRange},q.prototype.add=function(e){this.isEmpty()?this.cellRange=new N(e,e,e):this.cellRange.expand(e)},q.prototype.replace=function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},q.prototype.clear=function(){this.cellRange=null},q.prototype.getCorners=function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},q.prototype.addClassAtCoords=function(e,t,n,i){var r=e.wtTable.getCell(new M(t,n));"object"==typeof r&&o.Dom.addClass(r,i)},q.prototype.draw=function(e){var t,n,i,r,s,l=e.wtTable.getRowStrategy().countVisible(),a=e.wtTable.getColumnStrategy().cellCount;if(this.isEmpty())this.settings.border&&(h=this.getBorder(e))&&h.disappear();else{for(t=this.getCorners(),n=0;n<l;n++)for(r=e.wtTable.rowFilter.visibleToSource(n),i=0;i<a;i++)if(s=e.wtTable.columnFilter.visibleToSource(i),r>=t[0]&&r<=t[2]&&s>=t[1]&&s<=t[3]){var c;this.settings.className&&this.addClassAtCoords(e,r,s,this.settings.className),s===t[1]&&(c=e.wtTable.getRowHeader(r))&&o.Dom.addClass(c,this.settings.highlightRowClassName),(r===t[0]||r>t[0]&&0==n)&&(c=e.wtTable.getColumnHeader(s))&&o.Dom.addClass(c,this.settings.highlightColumnClassName)}else r>=t[0]&&r<=t[2]?this.addClassAtCoords(e,r,s,this.settings.highlightRowClassName):s>=t[1]&&s<=t[3]&&this.addClassAtCoords(e,r,s,this.settings.highlightColumnClassName);var h;e.getSetting("onBeforeDrawBorders",t,this.settings.className),this.settings.border&&(h=this.getBorder(e))&&h.appear(t)}},Y.prototype.update=function(e,t){if(void 0===t)for(var o in e)e.hasOwnProperty(o)&&(this.settings[o]=e[o]);else this.settings[e]=t;return this.instance},Y.prototype.getSetting=function(e,t,o,n,i){return"function"==typeof this.settings[e]?this.settings[e](t,o,n,i):void 0!==t&&"[object Array]"===Object.prototype.toString.call(this.settings[e])?this.settings[e][t]:this.settings[e]},Y.prototype.has=function(e){return!!this.settings[e]},Q.prototype.getRowStrategy=function(){return this.isWorkingOnClone()?this.instance.cloneSource.wtTable.rowStrategy:this.rowStrategy},Q.prototype.getColumnStrategy=function(){return this.isWorkingOnClone()?this.instance.cloneSource.wtTable.columnStrategy:this.columnStrategy},Q.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource},Q.prototype.refreshHiderDimensions=function(){var e=this.spreader.style;e.position="relative",e.width="auto",e.height="auto"},Q.prototype.draw=function(e){var t;return e?this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0):(this.isWorkingOnClone()?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:(this.holderOffset=o.Dom.offset(this.holder),this.tableOffset=o.Dom.offset(this.TABLE),this.instance.wtScrollbars.vertical.readSettings(),this.instance.wtScrollbars.horizontal.readSettings(),this.instance.wtViewport.resetSettings()),t=this.instance.cloneOverlay instanceof W||this.instance.cloneOverlay instanceof X||this.instance.cloneOverlay instanceof U?0:this.instance.wtSettings.settings.offsetRow,this.rowFilter=new z(t,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new I(this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw()),this.refreshPositions(e),this.isWorkingOnClone()||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition(),this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition()),this.instance.drawn=!0,this},Q.prototype._doDraw=function(){new J(this).render()},Q.prototype.refreshPositions=function(e){this.refreshHiderDimensions(),this.refreshSelections(e)},Q.prototype.removeClassFromCells=function(e){for(var t=this.TABLE.querySelectorAll("."+e),n=0,i=t.length;n<i;n++)o.Dom.removeClass(t[n],e)},Q.prototype.refreshSelections=function(e){if(this.instance.selections){if(e)for(var t=0,o=this.instance.selections.length;t<o;t++)this.instance.selections[t].settings.className&&this.removeClassFromCells(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName);for(t=0,o=this.instance.selections.length;t<o;t++)this.instance.selections[t].draw(this.instance,e)}},Q.prototype.getCell=function(e){if(this.isRowBeforeViewport(e.row))return-1;if(this.isRowAfterViewport(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToVisible(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},Q.prototype.getColumnHeader=function(e){var t=this.THEAD.childNodes[0];if(t)return t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]},Q.prototype.getRowHeader=function(e){if(0==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToVisible(e)];return t?t.childNodes[0]:void 0},Q.prototype.getCoords=function(e){var t=e.parentNode,n=o.Dom.index(t);return new M(n=t.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.visibleToSource(n),this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))},Q.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToVisible(e)]},Q.prototype.getFirstVisibleRow=function(){return this.rowFilter.visibleToSource(0)},Q.prototype.getFirstVisibleColumn=function(){if(this.isWorkingOnClone())return this.instance.cloneOverlay instanceof K||this.instance.cloneOverlay instanceof U?0:this.instance.cloneSource.wtTable.getFirstVisibleColumn();var e=this.instance.wtScrollbars.horizontal.getScrollPosition(),t=this.getColumnStrategy().cellCount,o=this.TBODY.firstChild;if(!o)return 0;for(var n=0;n<t;n++)if((e-=o.childNodes[n].offsetWidth)<0)return n;return-1},Q.prototype.getLastVisibleRow=function(){var e=this.rowFilter.visibleToSource(this.getRowStrategy().countVisible()-1),t=this.instance;if(t.cloneOverlay instanceof X||t.cloneOverlay instanceof U){var o=this.instance.getSetting("fixedRowsTop");return Math.min(o-1,e)}return e},Q.prototype.getLastVisibleColumn=function(){var e=this.instance;if(this.isWorkingOnClone()){if(e.cloneOverlay instanceof K||e.cloneOverlay instanceof U){var t=this.getColumnStrategy().countVisible()-1,o=e.getSetting("fixedColumnsLeft");return Math.min(o-1,t)}return this.instance.cloneSource.wtTable.getLastVisibleColumn()}var n=this.instance.wtScrollbars.horizontal.getScrollPosition()+this.instance.wtViewport.getWorkspaceWidth(1/0),i=this.getColumnStrategy().cellCount,r=this.instance.getSetting("rowHeaders").length||0,s=this.TBODY.firstChild;if(!i)return-1;for(var l=0;l<i+r;l++)if((n-=s.childNodes[l].offsetWidth)<=0)return l-r;return l-r-1},Q.prototype.isRowBeforeViewport=function(e){return this.rowFilter.sourceToVisible(e)<0&&e>=0},Q.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},Q.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToVisible(e)<0&&e>=0},Q.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},Q.prototype.isRowInViewport=function(e){return!this.isRowBeforeViewport(e)&&!this.isRowAfterViewport(e)},Q.prototype.isColumnInViewport=function(e){return!this.isColumnBeforeViewport(e)&&!this.isColumnAfterViewport(e)},Q.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.getRowStrategy().isLastIncomplete()},Q.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.getColumnStrategy().isLastIncomplete()},Q.prototype.getVisibleRowsCount=function(){return this.getRowStrategy().countVisible()},Q.prototype.allRowsInViewport=function(){return this.getRowStrategy().cellCount==this.getVisibleRowsCount()},J.prototype.render=function(){this.wtTable.isWorkingOnClone()||this.instance.getSetting("beforeDraw",!0),this.rowHeaders=this.instance.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.instance.getSetting("fixedRowsTop"),this.columnHeaders=this.instance.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e,t,o,n,i=this.instance.getSetting("totalRows"),r=!1;if(this.instance.getSetting("totalColumns")>0&&(this.wtTable.isWorkingOnClone()&&(this.instance.cloneOverlay instanceof X||this.instance.cloneOverlay instanceof U?n=this.fixedRowsTop:this.instance.cloneOverlay instanceof K&&(n=this.wtTable.getRowStrategy().cellCount)),this.adjustAvailableNodes(),r=!0,this.renderColGroups(),this.renderColumnHeaders(),t=this.getColumnCount(),this.renderRows(i,n,t),this.wtTable.isWorkingOnClone()||(o=this.instance.wtViewport.getWorkspaceWidth(),this.instance.wtViewport.containerWidth=null,this.wtTable.getColumnStrategy().stretch()),this.adjustColumnWidths(t)),r||this.adjustAvailableNodes(),this.instance.cloneOverlay instanceof W||this.removeRedundantRows(),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.instance.wtScrollbars.applyToDOM(),o!==this.instance.wtViewport.getWorkspaceWidth()){this.instance.wtViewport.containerWidth=null,this.wtTable.getColumnStrategy().stretch();var s=this.instance.wtTable.columnWidthCache;for(e=0;e<this.wtTable.getColumnStrategy().cellCount;e++){var l=this.wtTable.getColumnStrategy().getSize(e);this.COLGROUP.childNodes[e+this.rowHeaderCount].style.width=l+"px",s[e]=l}}this.instance.wtScrollbars.refresh(!1),this.instance.getSetting("onDraw",!0)}},J.prototype.removeRedundantRows=function(){for(var e=this.wtTable.getRowStrategy().countRendered();this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},J.prototype.renderRows=function(e,t,o){this.instance.getSetting("offsetRow");for(var n,i,r=0,s=this.rowFilter.visibleToSource(r),l=this.wtTable.isWorkingOnClone();s<e&&s>=0;){if(r>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==t&&r===t)break;if(i=this.getOrCreateTrForRow(r,i),this.renderRowHeaders(s,i),this.adjustColumns(i,o+this.rowHeaderCount),n=this.renderCells(s,i,o),this.instance.getSetting("offsetRow"),!l){if(!1===this.wtTable.getRowStrategy().add(r,n))break;this.resetOversizedRow(s)}if(i.firstChild){var a=this.instance.getSetting("rowHeight",s);i.firstChild.style.height=a?a+"px":""}r++,s=this.rowFilter.visibleToSource(r)}},J.prototype.resetOversizedRow=function(e){this.instance.wtTable.oversizedRows&&this.instance.wtTable.oversizedRows[e]&&(this.instance.wtTable.oversizedRows[e]=void 0)},J.prototype.markOversizedRows=function(){for(var e,t,n,i,r=this.instance.wtTable.TBODY.childNodes.length;r;)r--,n=this.instance.wtTable.rowFilter.visibleToSource(r),e=this.instance.wtSettings.settings.rowHeight(n),i=this.instance.wtTable.getTrForRow(n),t=o.Dom.innerHeight(i)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<t||e<t)&&(this.instance.wtTable.oversizedRows||(this.instance.wtTable.oversizedRows={}),this.instance.wtTable.oversizedRows[n]=t)},J.prototype.renderCells=function(e,t,n){for(var i,r,s=0;s<n;s++)r=this.columnFilter.visibleToSource(s),"TH"==(i=0===s?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]:i.nextSibling).nodeName&&(i=this.utils.replaceThWithTd(i,t)),o.Dom.hasClass(i,"hide")||(i.className=""),i.removeAttribute("style"),this.instance.getSetting("cellRenderer",e,r,i);return i},J.prototype.adjustColumnWidths=function(e){for(var t,o=this.instance.wtTable.columnWidthCache,n=0;n<e;n++)(t=this.wtTable.isWorkingOnClone()?this.instance.cloneSource.wtTable.columnWidthCache[n]:this.wtTable.getColumnStrategy().getSize(n))!==o[n]&&(this.COLGROUP.childNodes[n+this.rowHeaderCount].style.width=t+"px",o[n]=t)},J.prototype.appendToTbody=function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},J.prototype.getOrCreateTrForRow=function(e,t){var o;return e>=this.wtTable.tbodyChildrenLength?(o=this.createRow(),this.appendToTbody(o)):o=0===e?this.TBODY.firstChild:t.nextSibling,o},J.prototype.createRow=function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},J.prototype.renderRowHeader=function(e,t,o){o.className="",o.removeAttribute("style"),this.rowHeaders[t](e,o,t)},J.prototype.renderRowHeaders=function(e,t){for(var o=t.firstChild,n=0;n<this.rowHeaderCount;n++)o?"TD"==o.nodeName&&(o=this.utils.replaceTdWithTh(o,t)):(o=document.createElement("TH"),t.appendChild(o)),this.renderRowHeader(e,n,o),o=o.nextSibling},J.prototype.adjustAvailableNodes=function(){this.refreshStretching(),this.adjustColGroups(),this.adjustThead()},J.prototype.renderColumnHeaders=function(){if(this.columnHeaderCount)for(var e,t=this.getColumnCount(),o=0;o<this.columnHeaderCount;o++){e=this.getTrForColumnHeaders(o);for(var n=-1*this.rowHeaderCount;n<t;n++)this.renderColumnHeader(o,n,e.childNodes[n+this.rowHeaderCount])}},J.prototype.adjustColGroups=function(){for(var e=this.getColumnCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--,this.wtTable.columnWidthCache&&this.wtTable.columnWidthCache.splice(-1,1)},J.prototype.adjustThead=function(){var e=this.getColumnCount(),t=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,i=this.columnHeaders.length;n<i;n++){for((t=this.THEAD.childNodes[n])||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)t.removeChild(t.lastChild),this.theadChildrenLength--}var r=this.THEAD.childNodes.length;if(r>this.columnHeaders.length)for(n=this.columnHeaders.length;n<r;n++)this.THEAD.removeChild(this.THEAD.lastChild)}else t&&o.Dom.empty(t)},J.prototype.getTrForColumnHeaders=function(e){return this.THEAD.childNodes[e]},J.prototype.renderColumnHeader=function(e,t,o){return o.className="",o.removeAttribute("style"),this.columnHeaders[e](t,o,e)},J.prototype.getColumnCount=function(){return this.wtTable.isWorkingOnClone()&&(this.instance.cloneOverlay instanceof K||this.instance.cloneOverlay instanceof U)?this.instance.getSetting("fixedColumnsLeft"):this.wtTable.getColumnStrategy().cellCount},J.prototype.renderColGroups=function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++)e<this.rowHeaderCount?o.Dom.addClass(this.COLGROUP.childNodes[e],"rowHeader"):o.Dom.removeClass(this.COLGROUP.childNodes[e],"rowHeader")},J.prototype.adjustColumns=function(e,t){for(var o=e.childNodes.length;o<t;){var n=document.createElement("TD");e.appendChild(n),o++}for(;o>t;)e.removeChild(e.lastChild),o--},J.prototype.refreshStretching=function(){if(!this.wtTable.isWorkingOnClone()){var e=this.instance,t=e.getSetting("stretchH"),o=(e.getSetting("totalRows"),e.getSetting("totalColumns")),n=this;this.wtTable.columnStrategy=new L(e,(function(e){return n.instance.wtViewport.getViewportWidth(e)}),(function(t){var i=n.columnFilter.visibleToSource(t);if(i<o)return e.getSetting("columnWidth",i)}),t),this.wtTable.rowStrategy=new G(e,(function(t){return n.instance.cloneOverlay instanceof W||e.wtSettings.settings.renderAllRows?1/0:n.instance.wtViewport.getViewportHeight(t)}),(function(t,o){return e.wtSettings.settings.defaultRowHeight}))}},J.utils={},J.utils.replaceTdWithTh=function(e,t){var o;return o=document.createElement("TH"),t.insertBefore(o,e),t.removeChild(e),o},J.utils.replaceThWithTd=function(e,t){var o=document.createElement("TD");return t.insertBefore(o,e),t.removeChild(e),o},Z.prototype.getWorkspaceHeight=function(){var e=this.instance.wtScrollbars.vertical.scrollHandler;return e===t?document.documentElement.clientHeight:o.Dom.outerHeight(e)>0&&e.clientHeight>0?e.clientHeight:1/0},Z.prototype.getWorkspaceWidth=function(){var e=Math.min(this.getContainerFillWidth(),document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth),n=this.instance.wtScrollbars.horizontal.scrollHandler;if(n!=t){var i=this.instance.wtScrollbars.horizontal.scrollHandler.style.overflow;if("scroll"==i||"hidden"==i||"auto"==i)return Math.max(e,n.clientWidth)}return Math.max(e,o.Dom.outerWidth(this.instance.wtTable.TABLE))},Z.prototype.getContainerFillWidth=function(){if(this.containerWidth)return this.containerWidth;for(var e,t,o=this.instance.wtTable.holder;o.parentNode!=document.body&&null!=o.parentNode&&-1===o.className.indexOf("handsontable");)o=o.parentNode;return(t=document.createElement("DIV")).style.width="100%",t.style.height="1px",o.appendChild(t),e=t.offsetWidth,this.containerWidth=e,o.removeChild(t),e},Z.prototype.getWorkspaceOffset=function(){return o.Dom.offset(this.instance.wtTable.TABLE)},Z.prototype.getWorkspaceActualHeight=function(){return o.Dom.outerHeight(this.instance.wtTable.TABLE)},Z.prototype.getWorkspaceActualWidth=function(){return o.Dom.outerWidth(this.instance.wtTable.TABLE)||o.Dom.outerWidth(this.instance.wtTable.TBODY)||o.Dom.outerWidth(this.instance.wtTable.THEAD)},Z.prototype.getColumnHeaderHeight=function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=o.Dom.outerHeight(this.instance.wtTable.THEAD)),this.columnHeaderHeight},Z.prototype.getViewportHeight=function(e){var t=this.getWorkspaceHeight(e);if(t===1/0)return t;var o=this.getColumnHeaderHeight();return o>0&&(t-=o),t},Z.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var t=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var n=0,i=e.length;n<i;n++)t?(this.rowHeaderWidth+=o.Dom.outerWidth(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},Z.prototype.getViewportWidth=function(e){var t=this.getWorkspaceWidth(e);if(t===1/0)return t;var o=this.getRowHeaderWidth();return o>0?t-o:t},Z.prototype.resetSettings=function(){this.rowHeaderWidth=NaN,this.columnHeaderHeight=NaN}}(jQuery,window,Handsontable),function(){var e,t={},o="en",n=null,i="0,0",r="undefined"!=typeof module&&module.exports;function s(e){this._value=e}function l(e,t,o,n){var i,r,s=Math.pow(10,t);return r=(o(e*s)/s).toFixed(t),n&&(i=new RegExp("0{1,"+n+"}$"),r=r.replace(i,"")),r}function a(e,i,r){var s,a,c,h,u,d,f=!1,p=!1,g=!1,m="",w=!1,v=!1,y=!1,C=!1,b=!1,S="",R="",T=Math.abs(e),E=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],k="",D=!1;if(0===e&&null!==n)return n;if(i.indexOf("(")>-1?(f=!0,i=i.slice(1,-1)):i.indexOf("+")>-1&&(p=!0,i=i.replace(/\+/g,"")),i.indexOf("a")>-1&&(w=i.indexOf("aK")>=0,v=i.indexOf("aM")>=0,y=i.indexOf("aB")>=0,C=i.indexOf("aT")>=0,b=w||v||y||C,i.indexOf(" a")>-1?(m=" ",i=i.replace(" a","")):i=i.replace("a",""),T>=Math.pow(10,12)&&!b||C?(m+=t[o].abbreviations.trillion,e/=Math.pow(10,12)):T<Math.pow(10,12)&&T>=Math.pow(10,9)&&!b||y?(m+=t[o].abbreviations.billion,e/=Math.pow(10,9)):T<Math.pow(10,9)&&T>=Math.pow(10,6)&&!b||v?(m+=t[o].abbreviations.million,e/=Math.pow(10,6)):(T<Math.pow(10,6)&&T>=Math.pow(10,3)&&!b||w)&&(m+=t[o].abbreviations.thousand,e/=Math.pow(10,3))),i.indexOf("b")>-1)for(i.indexOf(" b")>-1?(S=" ",i=i.replace(" b","")):i=i.replace("b",""),c=0;c<=E.length;c++)if(s=Math.pow(1024,c),a=Math.pow(1024,c+1),e>=s&&e<a){S+=E[c],s>0&&(e/=s);break}return i.indexOf("o")>-1&&(i.indexOf(" o")>-1?(R=" ",i=i.replace(" o","")):i=i.replace("o",""),R+=t[o].ordinal(e)),i.indexOf("[.]")>-1&&(g=!0,i=i.replace("[.]",".")),h=e.toString().split(".")[0],u=i.split(".")[1],d=i.indexOf(","),u?(h=(k=u.indexOf("[")>-1?l(e,(u=(u=u.replace("]","")).split("["))[0].length+u[1].length,r,u[1].length):l(e,u.length,r)).split(".")[0],k=k.split(".")[1].length?t[o].delimiters.decimal+k.split(".")[1]:"",g&&0===Number(k.slice(1))&&(k="")):h=l(e,null,r),h.indexOf("-")>-1&&(h=h.slice(1),D=!0),d>-1&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+t[o].delimiters.thousands)),0===i.indexOf(".")&&(h=""),(f&&D?"(":"")+(!f&&D?"-":"")+(!D&&p?"+":"")+h+k+(R||"")+(m||"")+(S||"")+(f&&D?")":"")}function c(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function h(){return Array.prototype.slice.call(arguments).reduce((function(e,t){var o=c(e),n=c(t);return o>n?o:n}),-1/0)}(e=function(t){return e.isNumeral(t)?t=t.value():0===t||void 0===t?t=0:Number(t)||(t=e.fn.unformat(t)),new s(Number(t))}).version="1.5.3",e.isNumeral=function(e){return e instanceof s},e.language=function(n,i){if(!n)return o;if(n&&!i){if(!t[n])throw new Error("Unknown language : "+n);o=n}return!i&&t[n]||function(e,o){t[e]=o}(n,i),e},e.languageData=function(e){if(!e)return t[o];if(!t[e])throw new Error("Unknown language : "+e);return t[e]},e.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),e.zeroFormat=function(e){n="string"==typeof e?e:null},e.defaultFormat=function(e){i="string"==typeof e?e:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){"use strict";if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var o,n,i=this.length>>>0,r=!1;for(1<arguments.length&&(n=t,r=!0),o=0;i>o;++o)this.hasOwnProperty(o)&&(r?n=e(n,this[o],o,this):(n=this[o],r=!0));if(!r)throw new TypeError("Reduce of empty array with no initial value");return n}),e.fn=s.prototype={clone:function(){return e(this)},format:function(e,n){return function(e,n,i){return n.indexOf("$")>-1?function(e,n,i){var r,s,l=n.indexOf("$"),c=n.indexOf("("),h=n.indexOf("-"),u="";return n.indexOf(" $")>-1?(u=" ",n=n.replace(" $","")):n.indexOf("$ ")>-1?(u=" ",n=n.replace("$ ","")):n=n.replace("$",""),s=a(e._value,n,i),l<=1?s.indexOf("(")>-1||s.indexOf("-")>-1?(r=1,(l<c||l<h)&&(r=0),(s=s.split("")).splice(r,0,t[o].currency.symbol+u),s=s.join("")):s=t[o].currency.symbol+u+s:s.indexOf(")")>-1?((s=s.split("")).splice(-1,0,u+t[o].currency.symbol),s=s.join("")):s=s+u+t[o].currency.symbol,s}(e,n,i):n.indexOf("%")>-1?function(e,t,o){var n,i="",r=100*e._value;return t.indexOf(" %")>-1?(i=" ",t=t.replace(" %","")):t=t.replace("%",""),(n=a(r,t,o)).indexOf(")")>-1?((n=n.split("")).splice(-1,0,i+"%"),n=n.join("")):n=n+i+"%",n}(e,n,i):n.indexOf(":")>-1?function(e){var t=Math.floor(e._value/60/60),o=Math.floor((e._value-60*t*60)/60),n=Math.round(e._value-60*t*60-60*o);return t+":"+(o<10?"0"+o:o)+":"+(n<10?"0"+n:n)}(e):a(e._value,n,i)}(this,e||i,void 0!==n?n:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:function(e,i){var r,s,l,a,c,h=i,u=["KB","MB","GB","TB","PB","EB","ZB","YB"],d=!1;if(i.indexOf(":")>-1)e._value=function(e){var t=e.split(":"),o=0;return 3===t.length?(o+=60*Number(t[0])*60,o+=60*Number(t[1]),o+=Number(t[2])):2===t.length&&(o+=60*Number(t[0]),o+=Number(t[1])),Number(o)}(i);else if(i===n)e._value=0;else{for("."!==t[o].delimiters.decimal&&(i=i.replace(/\./g,"").replace(t[o].delimiters.decimal,".")),r=new RegExp("[^a-zA-Z]"+t[o].abbreviations.thousand+"(?:\\)|(\\"+t[o].currency.symbol+")?(?:\\))?)?$"),s=new RegExp("[^a-zA-Z]"+t[o].abbreviations.million+"(?:\\)|(\\"+t[o].currency.symbol+")?(?:\\))?)?$"),l=new RegExp("[^a-zA-Z]"+t[o].abbreviations.billion+"(?:\\)|(\\"+t[o].currency.symbol+")?(?:\\))?)?$"),a=new RegExp("[^a-zA-Z]"+t[o].abbreviations.trillion+"(?:\\)|(\\"+t[o].currency.symbol+")?(?:\\))?)?$"),c=0;c<=u.length&&!(d=i.indexOf(u[c])>-1&&Math.pow(1024,c+1));c++);e._value=(d||1)*(h.match(r)?Math.pow(10,3):1)*(h.match(s)?Math.pow(10,6):1)*(h.match(l)?Math.pow(10,9):1)*(h.match(a)?Math.pow(10,12):1)*(i.indexOf("%")>-1?.01:1)*((i.split("-").length+Math.min(i.split("(").length-1,i.split(")").length-1))%2?1:-1)*Number(i.replace(/[^0-9\.]+/g,"")),e._value=d?Math.ceil(e._value):e._value}return e._value}(this,e||i)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){var t=h.call(null,this._value,e);return this._value=[this._value,e].reduce((function(e,o,n,i){return e+t*o}),0)/t,this},subtract:function(e){var t=h.call(null,this._value,e);return this._value=[e].reduce((function(e,o,n,i){return e-t*o}),this._value*t)/t,this},multiply:function(e){return this._value=[this._value,e].reduce((function(e,t,o,n){var i=h(e,t);return e*i*(t*i)/(i*i)}),1),this},divide:function(e){return this._value=[this._value,e].reduce((function(e,t,o,n){var i=h(e,t);return e*i/(t*i)})),this},difference:function(t){return Math.abs(e(this._value).subtract(t).value())}},r&&(module.exports=e),"undefined"==typeof ender&&(this.numeral=e),"function"==typeof define&&define.amd&&define([],(function(){return e}))}.call(this);